func	2:0	64:0	0	static int	ProcessAACCookie
params	2:27	0:0	1	
param	2:29	2:45	2	demux_t *	p_demux
param	2:47	2:63	2	const uint8_t *	p
param	2:65	2:81	2	uint64_t	i_size
stmnts	0:0	63:22	1	
decl	4:4	4:39	2	const uint8_t	kAAC_ES_DESCR_TAG
op	4:36	0:0	2	=
water	4:38	0:0	2	3
decl	5:4	5:47	2	const uint8_t	kAAC_DEC_CONFIG_DESCR_TAG
op	5:44	0:0	2	=
water	5:46	0:0	2	4
decl	6:4	6:44	2	const uint8_t	kAAC_DEC_SPEC_INFO_TAG
op	6:41	0:0	2	=
water	6:43	0:0	2	5
decl	7:4	7:39	2	demux_sys_t	*p_sys
op	7:23	0:0	2	=
water	7:25	0:0	2	p_demux
op	7:32	0:0	2	->
water	7:34	0:0	2	p_sys
decl	8:4	8:25	2	uint64_t	i_offset
op	8:22	0:0	2	=
water	8:24	0:0	2	0
decl	9:4	9:28	2	uint64_t	i_kuki_size
op	9:25	0:0	2	=
water	9:27	0:0	2	0
decl	10:4	10:22	2	uint64_t	i_tag_len
decl	11:4	11:17	2	uint8_t	i_tag
if	12:4	12:78	2	(!AACCookieGetTag (& i_tag ,p ,& i_offset ,i_size ))
cond	12:8	12:55	3	!AACCookieGetTag (& i_tag ,p ,& i_offset ,i_size )
op	12:8	0:0	4	!
call	12:9	12:55	4	AACCookieGetTag
arg	12:26	12:32	5	&i_tag
op	12:26	0:0	6	&
water	12:27	0:0	6	i_tag
arg	12:34	12:35	5	p
water	12:34	0:0	6	p
arg	12:37	12:46	5	&i_offset
op	12:37	0:0	6	&
water	12:38	0:0	6	i_offset
arg	12:48	12:55	5	i_size
water	12:48	0:0	6	i_size
stmts	12:58	12:78	3	
goto	12:58	12:78	4	aac_kuki_finish
water	12:63	0:0	5	aac_kuki_finish
if	13:4	36:4	2	(i_tag == kAAC_ES_DESCR_TAG)
cond	13:8	13:17	3	i_tag == kAAC_ES_DESCR_TAG
water	13:8	0:0	4	i_tag
op	13:14	0:0	4	==
water	13:17	0:0	4	kAAC_ES_DESCR_TAG
stmts	14:4	36:4	3	
water	14:4	0:0	4	{
if	15:8	15:86	4	(!AACCookieTagLen (& i_tag_len ,p ,& i_offset ,i_size ))
cond	15:12	15:63	5	!AACCookieTagLen (& i_tag_len ,p ,& i_offset ,i_size )
op	15:12	0:0	6	!
call	15:13	15:63	6	AACCookieTagLen
arg	15:30	15:40	7	&i_tag_len
op	15:30	0:0	8	&
water	15:31	0:0	8	i_tag_len
arg	15:42	15:43	7	p
water	15:42	0:0	8	p
arg	15:45	15:54	7	&i_offset
op	15:45	0:0	8	&
water	15:46	0:0	8	i_offset
arg	15:56	15:63	7	i_size
water	15:56	0:0	8	i_size
stmts	15:66	15:86	5	
goto	15:66	15:86	6	aac_kuki_finish
water	15:71	0:0	7	aac_kuki_finish
if	16:8	16:73	4	(!AACCookieChkLen (3 ,i_size ,i_offset ))
cond	16:12	16:50	5	!AACCookieChkLen (3 ,i_size ,i_offset )
op	16:12	0:0	6	!
call	16:13	16:50	6	AACCookieChkLen
arg	16:30	16:31	7	3
water	16:30	0:0	8	3
arg	16:33	16:39	7	i_size
water	16:33	0:0	8	i_size
arg	16:41	16:50	7	i_offset
water	16:41	0:0	8	i_offset
stmts	16:53	16:73	5	
goto	16:53	16:73	6	aac_kuki_finish
water	16:58	0:0	7	aac_kuki_finish
water	17:8	0:0	4	i_offset
op	17:17	0:0	4	+=
water	17:20	0:0	4	2
water	17:21	0:0	4	;
decl	18:8	18:45	4	uint8_t	i_flags
op	18:24	0:0	4	=
op	18:26	0:0	4	*
water	18:27	0:0	4	(
water	18:29	0:0	4	p
op	18:31	0:0	4	+
water	18:33	0:0	4	i_offset
op	18:41	0:0	4	++
water	18:44	0:0	4	)
if	19:8	23:8	4	(i_flags & 0 x80)
cond	19:12	19:21	5	i_flags & 0 x80
water	19:12	0:0	6	i_flags
op	19:19	0:0	6	&
water	19:20	0:0	6	0
water	19:21	0:0	6	x80
stmts	20:8	23:8	5	
water	20:8	0:0	6	{
if	21:12	21:77	6	(!AACCookieChkLen (2 ,i_size ,i_offset ))
cond	21:16	21:54	7	!AACCookieChkLen (2 ,i_size ,i_offset )
op	21:16	0:0	8	!
call	21:17	21:54	8	AACCookieChkLen
arg	21:34	21:35	9	2
water	21:34	0:0	10	2
arg	21:37	21:43	9	i_size
water	21:37	0:0	10	i_size
arg	21:45	21:54	9	i_offset
water	21:45	0:0	10	i_offset
stmts	21:57	21:77	7	
goto	21:57	21:77	8	aac_kuki_finish
water	21:62	0:0	9	aac_kuki_finish
water	22:12	0:0	6	i_offset
op	22:21	0:0	6	+=
water	22:24	0:0	6	2
water	22:25	0:0	6	;
water	23:8	0:0	6	}
if	24:8	29:8	4	(i_flags & 0 x40)
cond	24:12	24:21	5	i_flags & 0 x40
water	24:12	0:0	6	i_flags
op	24:19	0:0	6	&
water	24:20	0:0	6	0
water	24:21	0:0	6	x40
stmts	25:8	29:8	5	
water	25:8	0:0	6	{
if	26:12	26:77	6	(!AACCookieChkLen (1 ,i_size ,i_offset ))
cond	26:16	26:54	7	!AACCookieChkLen (1 ,i_size ,i_offset )
op	26:16	0:0	8	!
call	26:17	26:54	8	AACCookieChkLen
arg	26:34	26:35	9	1
water	26:34	0:0	10	1
arg	26:37	26:43	9	i_size
water	26:37	0:0	10	i_size
arg	26:45	26:54	9	i_offset
water	26:45	0:0	10	i_offset
stmts	26:57	26:77	7	
goto	26:57	26:77	8	aac_kuki_finish
water	26:62	0:0	9	aac_kuki_finish
decl	27:12	27:51	6	uint8_t	i_url_len
op	27:30	0:0	6	=
op	27:32	0:0	6	*
water	27:33	0:0	6	(
water	27:35	0:0	6	p
op	27:37	0:0	6	+
water	27:39	0:0	6	i_offset
op	27:47	0:0	6	++
water	27:50	0:0	6	)
water	28:12	0:0	6	i_offset
op	28:21	0:0	6	+=
water	28:24	0:0	6	i_url_len
water	28:33	0:0	6	;
water	29:8	0:0	6	}
if	30:8	34:8	4	(i_flags & 0 x20)
cond	30:12	30:21	5	i_flags & 0 x20
water	30:12	0:0	6	i_flags
op	30:19	0:0	6	&
water	30:20	0:0	6	0
water	30:21	0:0	6	x20
stmts	31:8	34:8	5	
water	31:8	0:0	6	{
if	32:12	32:77	6	(!AACCookieChkLen (2 ,i_size ,i_offset ))
cond	32:16	32:54	7	!AACCookieChkLen (2 ,i_size ,i_offset )
op	32:16	0:0	8	!
call	32:17	32:54	8	AACCookieChkLen
arg	32:34	32:35	9	2
water	32:34	0:0	10	2
arg	32:37	32:43	9	i_size
water	32:37	0:0	10	i_size
arg	32:45	32:54	9	i_offset
water	32:45	0:0	10	i_offset
stmts	32:57	32:77	7	
goto	32:57	32:77	8	aac_kuki_finish
water	32:62	0:0	9	aac_kuki_finish
water	33:12	0:0	6	i_offset
op	33:21	0:0	6	+=
water	33:24	0:0	6	2
water	33:25	0:0	6	;
water	34:8	0:0	6	}
if	35:8	35:82	4	(!AACCookieGetTag (& i_tag ,p ,& i_offset ,i_size ))
cond	35:12	35:59	5	!AACCookieGetTag (& i_tag ,p ,& i_offset ,i_size )
op	35:12	0:0	6	!
call	35:13	35:59	6	AACCookieGetTag
arg	35:30	35:36	7	&i_tag
op	35:30	0:0	8	&
water	35:31	0:0	8	i_tag
arg	35:38	35:39	7	p
water	35:38	0:0	8	p
arg	35:41	35:50	7	&i_offset
op	35:41	0:0	8	&
water	35:42	0:0	8	i_offset
arg	35:52	35:59	7	i_size
water	35:52	0:0	8	i_size
stmts	35:62	35:82	5	
goto	35:62	35:82	6	aac_kuki_finish
water	35:67	0:0	7	aac_kuki_finish
water	36:4	0:0	4	}
if	37:4	38:28	2	(i_tag != kAAC_DEC_CONFIG_DESCR_TAG)
cond	37:8	37:17	3	i_tag != kAAC_DEC_CONFIG_DESCR_TAG
water	37:8	0:0	4	i_tag
op	37:14	0:0	4	!=
water	37:17	0:0	4	kAAC_DEC_CONFIG_DESCR_TAG
stmts	38:8	38:28	3	
goto	38:8	38:28	4	aac_kuki_finish
water	38:13	0:0	5	aac_kuki_finish
if	39:4	39:82	2	(!AACCookieTagLen (& i_tag_len ,p ,& i_offset ,i_size ))
cond	39:8	39:59	3	!AACCookieTagLen (& i_tag_len ,p ,& i_offset ,i_size )
op	39:8	0:0	4	!
call	39:9	39:59	4	AACCookieTagLen
arg	39:26	39:36	5	&i_tag_len
op	39:26	0:0	6	&
water	39:27	0:0	6	i_tag_len
arg	39:38	39:39	5	p
water	39:38	0:0	6	p
arg	39:41	39:50	5	&i_offset
op	39:41	0:0	6	&
water	39:42	0:0	6	i_offset
arg	39:52	39:59	5	i_size
water	39:52	0:0	6	i_size
stmts	39:62	39:82	3	
goto	39:62	39:82	4	aac_kuki_finish
water	39:67	0:0	5	aac_kuki_finish
if	40:4	40:85	2	(!AACCookieChkLen (1 + 1 + 3 + 4 + 4 ,i_size ,i_offset ))
cond	40:8	40:62	3	!AACCookieChkLen (1 + 1 + 3 + 4 + 4 ,i_size ,i_offset )
op	40:8	0:0	4	!
call	40:9	40:62	4	AACCookieChkLen
arg	40:26	40:43	5	1+1+3+4+4
water	40:26	0:0	6	1
op	40:28	0:0	6	+
water	40:30	0:0	6	1
op	40:32	0:0	6	+
water	40:34	0:0	6	3
op	40:36	0:0	6	+
water	40:38	0:0	6	4
op	40:40	0:0	6	+
water	40:42	0:0	6	4
arg	40:45	40:51	5	i_size
water	40:45	0:0	6	i_size
arg	40:53	40:62	5	i_offset
water	40:53	0:0	6	i_offset
stmts	40:65	40:85	3	
goto	40:65	40:85	4	aac_kuki_finish
water	40:70	0:0	5	aac_kuki_finish
water	41:4	0:0	2	i_offset
op	41:13	0:0	2	+=
water	41:16	0:0	2	(
water	41:18	0:0	2	1
op	41:20	0:0	2	+
water	41:22	0:0	2	1
op	41:24	0:0	2	+
water	41:26	0:0	2	3
op	41:28	0:0	2	+
water	41:30	0:0	2	4
op	41:32	0:0	2	+
water	41:34	0:0	2	4
water	41:36	0:0	2	)
water	41:37	0:0	2	;
if	42:4	42:78	2	(!AACCookieGetTag (& i_tag ,p ,& i_offset ,i_size ))
cond	42:8	42:55	3	!AACCookieGetTag (& i_tag ,p ,& i_offset ,i_size )
op	42:8	0:0	4	!
call	42:9	42:55	4	AACCookieGetTag
arg	42:26	42:32	5	&i_tag
op	42:26	0:0	6	&
water	42:27	0:0	6	i_tag
arg	42:34	42:35	5	p
water	42:34	0:0	6	p
arg	42:37	42:46	5	&i_offset
op	42:37	0:0	6	&
water	42:38	0:0	6	i_offset
arg	42:48	42:55	5	i_size
water	42:48	0:0	6	i_size
stmts	42:58	42:78	3	
goto	42:58	42:78	4	aac_kuki_finish
water	42:63	0:0	5	aac_kuki_finish
if	43:4	44:28	2	(i_tag != kAAC_DEC_SPEC_INFO_TAG)
cond	43:8	43:17	3	i_tag != kAAC_DEC_SPEC_INFO_TAG
water	43:8	0:0	4	i_tag
op	43:14	0:0	4	!=
water	43:17	0:0	4	kAAC_DEC_SPEC_INFO_TAG
stmts	44:8	44:28	3	
goto	44:8	44:28	4	aac_kuki_finish
water	44:13	0:0	5	aac_kuki_finish
if	45:4	45:82	2	(!AACCookieTagLen (& i_tag_len ,p ,& i_offset ,i_size ))
cond	45:8	45:59	3	!AACCookieTagLen (& i_tag_len ,p ,& i_offset ,i_size )
op	45:8	0:0	4	!
call	45:9	45:59	4	AACCookieTagLen
arg	45:26	45:36	5	&i_tag_len
op	45:26	0:0	6	&
water	45:27	0:0	6	i_tag_len
arg	45:38	45:39	5	p
water	45:38	0:0	6	p
arg	45:41	45:50	5	&i_offset
op	45:41	0:0	6	&
water	45:42	0:0	6	i_offset
arg	45:52	45:59	5	i_size
water	45:52	0:0	6	i_size
stmts	45:62	45:82	3	
goto	45:62	45:82	4	aac_kuki_finish
water	45:67	0:0	5	aac_kuki_finish
if	46:4	47:28	2	(i_offset + i_tag_len > i_size)
cond	46:8	46:31	3	i_offset + i_tag_len > i_size
water	46:8	0:0	4	i_offset
op	46:17	0:0	4	+
water	46:19	0:0	4	i_tag_len
op	46:29	0:0	4	>
water	46:31	0:0	4	i_size
stmts	47:8	47:28	3	
goto	47:8	47:28	4	aac_kuki_finish
water	47:13	0:0	5	aac_kuki_finish
water	48:4	0:0	2	i_kuki_size
op	48:16	0:0	2	=
water	48:18	0:0	2	i_tag_len
water	48:27	0:0	2	;
label	49:0	49:15	2	aac_kuki_finish :
if	50:4	55:4	2	(! i_kuki_size)
cond	50:8	50:9	3	! i_kuki_size
op	50:8	0:0	4	!
water	50:9	0:0	4	i_kuki_size
stmts	51:4	55:4	3	
water	51:4	0:0	4	{
call	52:8	52:115	4	msg_Warn
arg	52:18	52:25	5	p_demux
water	52:18	0:0	6	p_demux
arg	52:27	52:115	5	"Error parsing aac cookie. Passing it on to the decoder as is and hoping for the best."
water	52:27	0:0	6	"Error parsing aac cookie. Passing it on to the decoder as is and hoping for the best."
water	52:116	0:0	4	;
water	53:8	0:0	4	i_kuki_size
op	53:20	0:0	4	=
water	53:22	0:0	4	i_size
water	53:28	0:0	4	;
water	54:8	0:0	4	i_offset
op	54:17	0:0	4	=
water	54:19	0:0	4	0
water	54:20	0:0	4	;
water	55:4	0:0	4	}
water	56:4	0:0	2	p_sys
op	56:9	0:0	2	->
water	56:11	0:0	2	fmt
op	56:14	0:0	2	.
water	56:15	0:0	2	i_extra
op	56:23	0:0	2	=
water	56:25	0:0	2	(
water	56:26	0:0	2	int
water	56:29	0:0	2	)
water	56:30	0:0	2	i_kuki_size
water	56:41	0:0	2	;
water	57:4	0:0	2	p_sys
op	57:9	0:0	2	->
water	57:11	0:0	2	fmt
op	57:14	0:0	2	.
water	57:15	0:0	2	p_extra
op	57:23	0:0	2	=
call	57:25	57:45	2	malloc
arg	57:33	57:45	3	i_kuki_size
water	57:33	0:0	4	i_kuki_size
water	57:46	0:0	2	;
if	58:4	61:4	2	(! p_sys -> fmt . p_extra)
cond	58:8	58:20	3	! p_sys -> fmt . p_extra
op	58:8	0:0	4	!
water	58:9	0:0	4	p_sys
op	58:14	0:0	4	->
water	58:16	0:0	4	fmt
op	58:19	0:0	4	.
water	58:20	0:0	4	p_extra
stmts	59:4	61:4	3	
water	59:4	0:0	4	{
return	60:8	60:25	4	VLC_ENOMEM
water	60:15	0:0	5	VLC_ENOMEM
water	61:4	0:0	4	}
call	62:4	62:58	2	memcpy
arg	62:12	62:30	3	p_sys->fmt.p_extra
water	62:12	0:0	4	p_sys
op	62:17	0:0	4	->
water	62:19	0:0	4	fmt
op	62:22	0:0	4	.
water	62:23	0:0	4	p_extra
arg	62:32	62:44	3	p+i_offset
water	62:32	0:0	4	p
op	62:34	0:0	4	+
water	62:36	0:0	4	i_offset
arg	62:46	62:58	3	i_kuki_size
water	62:46	0:0	4	i_kuki_size
water	62:59	0:0	2	;
return	63:4	63:22	2	VLC_SUCCESS
water	63:11	0:0	3	VLC_SUCCESS
