func	2:0	60:0	0	static int	NTServiceInstall
params	2:27	0:0	1	
param	2:29	2:51	2	intf_thread_t *	p_intf
stmnts	0:0	59:22	1	
decl	4:4	4:38	2	intf_sys_t	*p_sys
op	4:23	0:0	2	=
water	4:25	0:0	2	p_intf
op	4:31	0:0	2	->
water	4:33	0:0	2	p_sys
decl	5:4	5:42	2	char	psz_path[10*MAX_PATH]
water	5:30	0:0	2	,
decl	5:4	5:42	2	char	*psz_extra
decl	6:4	6:31	2	TCHAR	psz_pathtmp[MAX_PATH]
decl	7:4	7:73	2	SC_HANDLE	handle
op	7:21	0:0	2	=
call	7:23	7:72	3	OpenSCManager
arg	7:38	7:42	4	NULL
water	7:38	0:0	5	NULL
arg	7:44	7:48	4	NULL
water	7:44	0:0	5	NULL
arg	7:50	7:72	4	SC_MANAGER_ALL_ACCESS
water	7:50	0:0	5	SC_MANAGER_ALL_ACCESS
if	8:4	13:4	2	(handle == NULL)
cond	8:8	8:18	3	handle == NULL
water	8:8	0:0	4	handle
op	8:15	0:0	4	==
water	8:18	0:0	4	NULL
stmts	9:4	13:4	3	
water	9:4	0:0	4	{
call	10:8	11:74	4	msg_Err
arg	10:17	10:23	5	p_intf
water	10:17	0:0	6	p_intf
arg	11:17	11:74	5	"could not connect to Services Control Manager database"
water	11:17	0:0	6	"could not connect to Services Control Manager database"
water	11:75	0:0	4	;
return	12:8	12:27	4	VLC_EGENERIC
water	12:15	0:0	5	VLC_EGENERIC
water	13:4	0:0	4	}
call	16:4	16:51	2	GetModuleFileName
arg	16:23	16:27	3	NULL
water	16:23	0:0	4	NULL
arg	16:29	16:40	3	psz_pathtmp
water	16:29	0:0	4	psz_pathtmp
arg	16:42	16:51	3	MAX_PATH
water	16:42	0:0	4	MAX_PATH
water	16:52	0:0	2	;
call	17:4	17:69	2	sprintf
arg	17:13	17:21	3	psz_path
water	17:13	0:0	4	psz_path
arg	17:23	17:48	3	"\"%s\" -I "MODULE_STRING
water	17:23	0:0	4	"\"%s\" -I "
water	17:35	0:0	4	MODULE_STRING
arg	17:50	17:69	3	FromT(psz_pathtmp)
call	17:50	17:67	4	FromT
arg	17:56	17:67	5	psz_pathtmp
water	17:56	0:0	6	psz_pathtmp
water	17:70	0:0	2	;
water	18:4	0:0	2	psz_extra
op	18:14	0:0	2	=
call	18:16	18:65	2	var_InheritString
arg	18:35	18:41	3	p_intf
water	18:35	0:0	4	p_intf
arg	18:43	18:65	3	"ntservice-extraintf"
water	18:43	0:0	4	"ntservice-extraintf"
water	18:66	0:0	2	;
if	19:4	24:4	2	(psz_extra)
cond	19:8	19:8	3	psz_extra
water	19:8	0:0	4	psz_extra
stmts	20:4	24:4	3	
water	20:4	0:0	4	{
call	21:8	21:52	4	strcat
arg	21:16	21:24	5	psz_path
water	21:16	0:0	6	psz_path
arg	21:26	21:52	5	" --ntservice-extraintf "
water	21:26	0:0	6	" --ntservice-extraintf "
water	21:53	0:0	4	;
call	22:8	22:36	4	strcat
arg	22:16	22:24	5	psz_path
water	22:16	0:0	6	psz_path
arg	22:26	22:36	5	psz_extra
water	22:26	0:0	6	psz_extra
water	22:37	0:0	4	;
call	23:8	23:24	4	free
arg	23:14	23:24	5	psz_extra
water	23:14	0:0	6	psz_extra
water	23:25	0:0	4	;
water	24:4	0:0	4	}
water	25:4	0:0	2	psz_extra
op	25:14	0:0	2	=
call	25:16	25:63	2	var_InheritString
arg	25:35	25:41	3	p_intf
water	25:35	0:0	4	p_intf
arg	25:43	25:63	3	"ntservice-options"
water	25:43	0:0	4	"ntservice-options"
water	25:64	0:0	2	;
if	26:4	31:4	2	(psz_extra && * psz_extra)
cond	26:8	26:22	3	psz_extra && * psz_extra
water	26:8	0:0	4	psz_extra
op	26:18	0:0	4	&&
op	26:21	0:0	4	*
water	26:22	0:0	4	psz_extra
stmts	27:4	31:4	3	
water	27:4	0:0	4	{
call	28:8	28:30	4	strcat
arg	28:16	28:24	5	psz_path
water	28:16	0:0	6	psz_path
arg	28:26	28:30	5	" "
water	28:26	0:0	6	" "
water	28:31	0:0	4	;
call	29:8	29:36	4	strcat
arg	29:16	29:24	5	psz_path
water	29:16	0:0	6	psz_path
arg	29:26	29:36	5	psz_extra
water	29:26	0:0	6	psz_extra
water	29:37	0:0	4	;
call	30:8	30:24	4	free
arg	30:14	30:24	5	psz_extra
water	30:14	0:0	6	psz_extra
water	30:25	0:0	4	;
water	31:4	0:0	4	}
decl	32:4	37:63	2	SC_HANDLE	service
op	32:22	0:0	2	=
call	33:8	37:62	3	CreateServiceA
arg	33:24	33:30	4	handle
water	33:24	0:0	5	handle
arg	33:32	33:50	4	p_sys->psz_service
water	33:32	0:0	5	p_sys
op	33:37	0:0	5	->
water	33:39	0:0	5	psz_service
arg	33:52	33:70	4	p_sys->psz_service
water	33:52	0:0	5	p_sys
op	33:57	0:0	5	->
water	33:59	0:0	5	psz_service
arg	34:23	34:53	4	GENERIC_READ|GENERIC_EXECUTE
water	34:23	0:0	5	GENERIC_READ
op	34:36	0:0	5	|
water	34:38	0:0	5	GENERIC_EXECUTE
arg	35:23	35:48	4	SERVICE_WIN32_OWN_PROCESS
water	35:23	0:0	5	SERVICE_WIN32_OWN_PROCESS
arg	36:23	36:41	4	SERVICE_AUTO_START
water	36:23	0:0	5	SERVICE_AUTO_START
arg	36:43	36:63	4	SERVICE_ERROR_IGNORE
water	36:43	0:0	5	SERVICE_ERROR_IGNORE
arg	37:23	37:31	4	psz_path
water	37:23	0:0	5	psz_path
arg	37:33	37:37	4	NULL
water	37:33	0:0	5	NULL
arg	37:39	37:43	4	NULL
water	37:39	0:0	5	NULL
arg	37:45	37:49	4	NULL
water	37:45	0:0	5	NULL
arg	37:51	37:55	4	NULL
water	37:51	0:0	5	NULL
arg	37:57	37:62	4	NULL
water	37:57	0:0	5	NULL
if	38:4	52:4	2	(service == NULL)
cond	38:8	38:19	3	service == NULL
water	38:8	0:0	4	service
op	38:16	0:0	4	==
water	38:19	0:0	4	NULL
stmts	39:4	52:4	3	
water	39:4	0:0	4	{
if	40:8	46:8	4	(GetLastError ( ) != ERROR_SERVICE_EXISTS)
cond	40:12	40:30	5	GetLastError ( ) != ERROR_SERVICE_EXISTS
call	40:12	40:25	6	GetLastError
op	40:27	0:0	6	!=
water	40:30	0:0	6	ERROR_SERVICE_EXISTS
stmts	41:8	46:8	5	
water	41:8	0:0	6	{
call	42:12	43:50	6	msg_Err
arg	42:21	42:27	7	p_intf
water	42:21	0:0	8	p_intf
arg	42:29	42:72	7	"could not create new service: \"%s\" (%s)"
water	42:29	0:0	8	"could not create new service: \"%s\" (%s)"
arg	43:21	43:40	7	p_sys->psz_service
water	43:21	0:0	8	p_sys
op	43:26	0:0	8	->
water	43:28	0:0	8	psz_service
arg	43:41	43:50	7	psz_path
water	43:41	0:0	8	psz_path
water	43:51	0:0	6	;
call	44:12	44:39	6	CloseServiceHandle
arg	44:32	44:39	7	handle
water	44:32	0:0	8	handle
water	44:40	0:0	6	;
return	45:12	45:31	6	VLC_EGENERIC
water	45:19	0:0	7	VLC_EGENERIC
water	46:8	0:0	6	}
else	47:8	51:8	4
stmts	48:8	51:8	5	
water	48:8	0:0	6	{
call	49:12	50:41	6	msg_Warn
arg	49:22	49:28	7	p_intf
water	49:22	0:0	8	p_intf
arg	49:30	49:61	7	"service \"%s\" already exists"
water	49:30	0:0	8	"service \"%s\" already exists"
arg	50:22	50:41	7	p_sys->psz_service
water	50:22	0:0	8	p_sys
op	50:27	0:0	8	->
water	50:29	0:0	8	psz_service
water	50:42	0:0	6	;
water	51:8	0:0	6	}
water	52:4	0:0	4	}
else	53:4	56:4	2
stmts	54:4	56:4	3	
water	54:4	0:0	4	{
call	55:8	55:56	4	msg_Warn
arg	55:18	55:24	5	p_intf
water	55:18	0:0	6	p_intf
arg	55:26	55:56	5	"service successfuly created"
water	55:26	0:0	6	"service successfuly created"
water	55:57	0:0	4	;
water	56:4	0:0	4	}
if	57:4	57:47	2	(service)
cond	57:8	57:8	3	service
water	57:8	0:0	4	service
stmts	57:18	57:47	3	
call	57:18	57:46	4	CloseServiceHandle
arg	57:38	57:46	5	service
water	57:38	0:0	6	service
water	57:47	0:0	4	;
call	58:4	58:31	2	CloseServiceHandle
arg	58:24	58:31	3	handle
water	58:24	0:0	4	handle
water	58:32	0:0	2	;
return	59:4	59:22	2	VLC_SUCCESS
water	59:11	0:0	3	VLC_SUCCESS
