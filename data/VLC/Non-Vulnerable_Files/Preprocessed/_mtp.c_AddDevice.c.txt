func	2:0	51:0	0	static int	AddDevice
params	2:20	0:0	1	
param	2:22	2:48	2	services_discovery_t *	p_sd
param	3:22	3:56	2	LIBMTP_raw_device_t *	p_raw_device
stmnts	0:0	50:4	1	
decl	5:4	5:25	2	char	*psz_name
op	5:19	0:0	2	=
water	5:21	0:0	2	NULL
decl	6:4	6:32	2	LIBMTP_mtpdevice_t	*p_device
decl	7:4	7:35	2	LIBMTP_track_t	*p_track
water	7:27	0:0	2	,
decl	7:4	7:35	2	LIBMTP_track_t	*p_tmp
if	8:4	45:4	2	(( p_device =LIBMTP_Open_Raw_Device (p_raw_device ) ) != NULL)
cond	8:8	8:65	3	( p_device =LIBMTP_Open_Raw_Device (p_raw_device ) ) != NULL
water	8:8	0:0	4	(
water	8:10	0:0	4	p_device
op	8:19	0:0	4	=
call	8:21	8:58	4	LIBMTP_Open_Raw_Device
arg	8:45	8:58	5	p_raw_device
water	8:45	0:0	6	p_raw_device
water	8:60	0:0	4	)
op	8:62	0:0	4	!=
water	8:65	0:0	4	NULL
stmts	9:4	45:4	3	
water	9:4	0:0	4	{
if	10:8	13:37	4	(! ( psz_name =LIBMTP_Get_Friendlyname (p_device ) ))
cond	10:12	10:62	5	! ( psz_name =LIBMTP_Get_Friendlyname (p_device ) )
op	10:12	0:0	6	!
water	10:13	0:0	6	(
water	10:15	0:0	6	psz_name
op	10:24	0:0	6	=
call	10:26	10:60	6	LIBMTP_Get_Friendlyname
arg	10:51	10:60	7	p_device
water	10:51	0:0	8	p_device
water	10:62	0:0	6	)
stmts	11:12	13:37	5	
if	11:12	13:37	6	(! ( psz_name =LIBMTP_Get_Modelname (p_device ) ))
cond	11:16	11:63	7	! ( psz_name =LIBMTP_Get_Modelname (p_device ) )
op	11:16	0:0	8	!
water	11:17	0:0	8	(
water	11:19	0:0	8	psz_name
op	11:28	0:0	8	=
call	11:30	11:61	8	LIBMTP_Get_Modelname
arg	11:52	11:61	9	p_device
water	11:52	0:0	10	p_device
water	11:63	0:0	8	)
stmts	12:16	13:37	7	
if	12:16	13:37	8	(! ( psz_name =strdup (N_ ("MTP Device" ) ) ))
cond	12:20	12:63	9	! ( psz_name =strdup (N_ ("MTP Device" ) ) )
op	12:20	0:0	10	!
water	12:21	0:0	10	(
water	12:23	0:0	10	psz_name
op	12:32	0:0	10	=
call	12:34	12:61	10	strdup
arg	12:42	12:61	11	N_("MTP Device")
call	12:42	12:59	12	N_
arg	12:46	12:59	13	"MTP Device"
water	12:46	0:0	14	"MTP Device"
water	12:63	0:0	10	)
stmts	13:20	13:37	9	
return	13:20	13:37	10	VLC_ENOMEM
water	13:27	0:0	11	VLC_ENOMEM
call	14:8	14:53	4	msg_Info
arg	14:18	14:22	5	p_sd
water	14:18	0:0	6	p_sd
arg	14:24	14:42	5	"Found device: %s"
water	14:24	0:0	6	"Found device: %s"
arg	14:44	14:53	5	psz_name
water	14:44	0:0	6	psz_name
water	14:54	0:0	4	;
water	15:8	0:0	4	p_sd
op	15:12	0:0	4	->
water	15:14	0:0	4	p_sys
op	15:19	0:0	4	->
water	15:21	0:0	4	i_bus
op	15:27	0:0	4	=
water	15:29	0:0	4	p_raw_device
op	15:41	0:0	4	->
water	15:43	0:0	4	bus_location
water	15:55	0:0	4	;
water	16:8	0:0	4	p_sd
op	16:12	0:0	4	->
water	16:14	0:0	4	p_sys
op	16:19	0:0	4	->
water	16:21	0:0	4	i_dev
op	16:27	0:0	4	=
water	16:29	0:0	4	p_raw_device
op	16:41	0:0	4	->
water	16:43	0:0	4	devnum
water	16:49	0:0	4	;
water	17:8	0:0	4	p_sd
op	17:12	0:0	4	->
water	17:14	0:0	4	p_sys
op	17:19	0:0	4	->
water	17:21	0:0	4	i_product_id
op	17:34	0:0	4	=
water	17:36	0:0	4	p_raw_device
op	17:48	0:0	4	->
water	17:50	0:0	4	device_entry
op	17:62	0:0	4	.
water	17:63	0:0	4	product_id
water	17:73	0:0	4	;
if	18:8	22:8	4	(( p_track =LIBMTP_Get_Tracklisting_With_Callback (p_device ,CountTracks ,p_sd ) ) == NULL)
cond	18:12	19:53	5	( p_track =LIBMTP_Get_Tracklisting_With_Callback (p_device ,CountTracks ,p_sd ) ) == NULL
water	18:12	0:0	6	(
water	18:14	0:0	6	p_track
op	18:22	0:0	6	=
call	18:24	19:46	6	LIBMTP_Get_Tracklisting_With_Callback
arg	18:63	18:71	7	p_device
water	18:63	0:0	8	p_device
arg	19:28	19:39	7	CountTracks
water	19:28	0:0	8	CountTracks
arg	19:41	19:46	7	p_sd
water	19:41	0:0	8	p_sd
water	19:48	0:0	6	)
op	19:50	0:0	6	==
water	19:53	0:0	6	NULL
stmts	20:8	22:8	5	
water	20:8	0:0	6	{
call	21:12	21:54	6	msg_Warn
arg	21:22	21:26	7	p_sd
water	21:22	0:0	8	p_sd
arg	21:28	21:54	7	"No tracks on the device"
water	21:28	0:0	8	"No tracks on the device"
water	21:55	0:0	6	;
water	22:8	0:0	6	}
else	23:8	41:8	4
stmts	24:8	41:8	5	
water	24:8	0:0	6	{
if	25:12	30:12	6	(! ( p_sd -> p_sys -> pp_items =calloc (p_sd -> p_sys -> i_tracks_num ,sizeof ( input_item_t * ) ) ))
cond	25:16	26:78	7	! ( p_sd -> p_sys -> pp_items =calloc (p_sd -> p_sys -> i_tracks_num ,sizeof ( input_item_t * ) ) )
op	25:16	0:0	8	!
water	25:17	0:0	8	(
water	25:19	0:0	8	p_sd
op	25:23	0:0	8	->
water	25:25	0:0	8	p_sys
op	25:30	0:0	8	->
water	25:32	0:0	8	pp_items
op	25:41	0:0	8	=
call	25:43	26:76	8	calloc
arg	25:51	25:76	9	p_sd->p_sys->i_tracks_num
water	25:51	0:0	10	p_sd
op	25:55	0:0	10	->
water	25:57	0:0	10	p_sys
op	25:62	0:0	10	->
water	25:64	0:0	10	i_tracks_num
arg	26:51	26:76	9	sizeof(input_item_t*)
op	26:51	0:0	10	sizeof
water	26:57	0:0	10	(
water	26:59	0:0	10	input_item_t
op	26:72	0:0	10	*
water	26:74	0:0	10	)
water	26:78	0:0	8	)
stmts	27:12	30:12	7	
water	27:12	0:0	8	{
call	28:16	28:31	8	free
arg	28:22	28:31	9	psz_name
water	28:22	0:0	10	psz_name
water	28:32	0:0	8	;
return	29:16	29:33	8	VLC_ENOMEM
water	29:23	0:0	9	VLC_ENOMEM
water	30:12	0:0	8	}
water	31:12	0:0	6	p_sd
op	31:16	0:0	6	->
water	31:18	0:0	6	p_sys
op	31:23	0:0	6	->
water	31:25	0:0	6	i_count
op	31:33	0:0	6	=
water	31:35	0:0	6	0
water	31:36	0:0	6	;
while	32:12	40:12	6	(p_track != NULL)
cond	32:19	32:30	7	p_track != NULL
water	32:19	0:0	8	p_track
op	32:27	0:0	8	!=
water	32:30	0:0	8	NULL
stmts	33:12	40:12	7	
water	33:12	0:0	8	{
call	34:16	35:40	8	msg_Dbg
arg	34:25	34:29	9	p_sd
water	34:25	0:0	10	p_sd
arg	34:31	34:53	9	"Track found: %s - %s"
water	34:31	0:0	10	"Track found: %s - %s"
arg	34:55	34:70	9	p_track->artist
water	34:55	0:0	10	p_track
op	34:62	0:0	10	->
water	34:64	0:0	10	artist
arg	35:25	35:40	9	p_track->title
water	35:25	0:0	10	p_track
op	35:32	0:0	10	->
water	35:34	0:0	10	title
water	35:41	0:0	8	;
call	36:16	36:40	8	AddTrack
arg	36:26	36:30	9	p_sd
water	36:26	0:0	10	p_sd
arg	36:32	36:40	9	p_track
water	36:32	0:0	10	p_track
water	36:41	0:0	8	;
water	37:16	0:0	8	p_tmp
op	37:22	0:0	8	=
water	37:24	0:0	8	p_track
water	37:31	0:0	8	;
water	38:16	0:0	8	p_track
op	38:24	0:0	8	=
water	38:26	0:0	8	p_track
op	38:33	0:0	8	->
water	38:35	0:0	8	next
water	38:39	0:0	8	;
call	39:16	39:46	8	LIBMTP_destroy_track_t
arg	39:40	39:46	9	p_tmp
water	39:40	0:0	10	p_tmp
water	39:47	0:0	8	;
water	40:12	0:0	8	}
water	41:8	0:0	6	}
water	42:8	0:0	4	p_sd
op	42:12	0:0	4	->
water	42:14	0:0	4	p_sys
op	42:19	0:0	4	->
water	42:21	0:0	4	psz_name
op	42:30	0:0	4	=
water	42:32	0:0	4	psz_name
water	42:40	0:0	4	;
call	43:8	43:40	4	LIBMTP_Release_Device
arg	43:31	43:40	5	p_device
water	43:31	0:0	6	p_device
water	43:41	0:0	4	;
return	44:8	44:26	4	VLC_SUCCESS
water	44:15	0:0	5	VLC_SUCCESS
water	45:4	0:0	4	}
else	46:4	50:4	2
stmts	47:4	50:4	3	
water	47:4	0:0	4	{
call	48:8	48:75	4	msg_Info
arg	48:18	48:22	5	p_sd
water	48:18	0:0	6	p_sd
arg	48:24	48:75	5	"The device seems to be mounted, unmount it first"
water	48:24	0:0	6	"The device seems to be mounted, unmount it first"
water	48:76	0:0	4	;
return	49:8	49:27	4	VLC_EGENERIC
water	49:15	0:0	5	VLC_EGENERIC
water	50:4	0:0	4	}
