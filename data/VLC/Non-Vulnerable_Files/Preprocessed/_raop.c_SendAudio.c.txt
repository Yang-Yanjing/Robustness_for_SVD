func	2:0	75:0	0	static void	SendAudio
params	2:21	0:0	1	
param	2:23	2:46	2	sout_stream_t *	p_stream
param	2:48	2:66	2	block_t *	p_buffer
stmnts	0:0	74:10	1	
decl	4:4	4:46	2	sout_stream_sys_t	*p_sys
op	4:29	0:0	2	=
water	4:31	0:0	2	p_stream
op	4:39	0:0	2	->
water	4:41	0:0	2	p_sys
decl	5:4	5:29	2	gcry_error_t	i_gcrypt_err
decl	6:4	6:19	2	block_t	*p_next
decl	7:4	7:16	2	size_t	i_len
decl	8:4	8:24	2	size_t	i_payload_len
decl	9:4	9:24	2	size_t	i_realloc_len
decl	10:4	10:10	2	int	rc
decl	11:4	16:5	2	const uint8_t	header[16]
op	11:29	0:0	2	=
water	11:31	0:0	2	{
water	12:8	0:0	2	0
water	12:9	0:0	2	x24
water	12:12	0:0	2	,
water	12:14	0:0	2	0
water	12:15	0:0	2	x00
water	12:18	0:0	2	,
water	12:20	0:0	2	0
water	12:21	0:0	2	x00
water	12:24	0:0	2	,
water	12:26	0:0	2	0
water	12:27	0:0	2	x00
water	12:30	0:0	2	,
water	13:8	0:0	2	0
water	13:9	0:0	2	xf0
water	13:12	0:0	2	,
water	13:14	0:0	2	0
water	13:15	0:0	2	xff
water	13:18	0:0	2	,
water	13:20	0:0	2	0
water	13:21	0:0	2	x00
water	13:24	0:0	2	,
water	13:26	0:0	2	0
water	13:27	0:0	2	x00
water	13:30	0:0	2	,
water	14:8	0:0	2	0
water	14:9	0:0	2	x00
water	14:12	0:0	2	,
water	14:14	0:0	2	0
water	14:15	0:0	2	x00
water	14:18	0:0	2	,
water	14:20	0:0	2	0
water	14:21	0:0	2	x00
water	14:24	0:0	2	,
water	14:26	0:0	2	0
water	14:27	0:0	2	x00
water	14:30	0:0	2	,
water	15:8	0:0	2	0
water	15:9	0:0	2	x00
water	15:12	0:0	2	,
water	15:14	0:0	2	0
water	15:15	0:0	2	x00
water	15:18	0:0	2	,
water	15:20	0:0	2	0
water	15:21	0:0	2	x00
water	15:24	0:0	2	,
water	15:26	0:0	2	0
water	15:27	0:0	2	x00
water	15:30	0:0	2	,
water	16:4	0:0	2	}
while	17:4	71:4	2	(p_buffer)
cond	17:12	17:12	3	p_buffer
water	17:12	0:0	4	p_buffer
stmts	18:4	71:4	3	
water	18:4	0:0	4	{
water	19:8	0:0	4	i_len
op	19:14	0:0	4	=
op	19:16	0:0	4	sizeof
water	19:22	0:0	4	(
water	19:24	0:0	4	header
water	19:31	0:0	4	)
op	19:33	0:0	4	+
water	19:35	0:0	4	p_buffer
op	19:43	0:0	4	->
water	19:45	0:0	4	i_buffer
water	19:53	0:0	4	;
if	21:8	29:8	4	(i_len > p_sys -> i_sendbuf_len || p_sys -> p_sendbuf == NULL)
cond	21:13	21:65	5	i_len > p_sys -> i_sendbuf_len || p_sys -> p_sendbuf == NULL
water	21:13	0:0	6	i_len
op	21:19	0:0	6	>
water	21:21	0:0	6	p_sys
op	21:26	0:0	6	->
water	21:28	0:0	6	i_sendbuf_len
op	21:42	0:0	6	||
water	21:45	0:0	6	p_sys
op	21:50	0:0	6	->
water	21:52	0:0	6	p_sendbuf
op	21:62	0:0	6	==
water	21:65	0:0	6	NULL
stmts	22:8	29:8	5	
water	22:8	0:0	6	{
water	24:12	0:0	6	i_realloc_len
op	24:26	0:0	6	=
water	24:28	0:0	6	(
water	24:29	0:0	6	1
op	24:31	0:0	6	+
water	24:33	0:0	6	(
water	24:34	0:0	6	i_len
op	24:40	0:0	6	/
water	24:42	0:0	6	4096
water	24:46	0:0	6	)
water	24:47	0:0	6	)
op	24:49	0:0	6	*
water	24:51	0:0	6	4096
water	24:55	0:0	6	;
water	25:12	0:0	6	p_sys
op	25:17	0:0	6	->
water	25:19	0:0	6	p_sendbuf
op	25:29	0:0	6	=
call	25:31	25:80	6	realloc_or_free
arg	25:48	25:64	7	p_sys->p_sendbuf
water	25:48	0:0	8	p_sys
op	25:53	0:0	8	->
water	25:55	0:0	8	p_sendbuf
arg	25:66	25:80	7	i_realloc_len
water	25:66	0:0	8	i_realloc_len
water	25:81	0:0	6	;
if	26:12	27:26	6	(p_sys -> p_sendbuf == NULL)
cond	26:17	26:37	7	p_sys -> p_sendbuf == NULL
water	26:17	0:0	8	p_sys
op	26:22	0:0	8	->
water	26:24	0:0	8	p_sendbuf
op	26:34	0:0	8	==
water	26:37	0:0	8	NULL
stmts	27:16	27:26	7	
goto	27:16	27:26	8	error
water	27:21	0:0	9	error
water	28:12	0:0	6	p_sys
op	28:17	0:0	6	->
water	28:19	0:0	6	i_sendbuf_len
op	28:33	0:0	6	=
water	28:35	0:0	6	i_realloc_len
water	28:48	0:0	6	;
water	29:8	0:0	6	}
call	31:8	31:59	4	memcpy
arg	31:16	31:32	5	p_sys->p_sendbuf
water	31:16	0:0	6	p_sys
op	31:21	0:0	6	->
water	31:23	0:0	6	p_sendbuf
arg	31:34	31:40	5	header
water	31:34	0:0	6	header
arg	31:42	31:59	5	sizeof(header)
op	31:42	0:0	6	sizeof
water	31:48	0:0	6	(
water	31:50	0:0	6	header
water	31:57	0:0	6	)
water	31:60	0:0	4	;
call	32:8	33:55	4	memcpy
arg	32:16	32:51	5	p_sys->p_sendbuf+sizeof(header)
water	32:16	0:0	6	p_sys
op	32:21	0:0	6	->
water	32:23	0:0	6	p_sendbuf
op	32:33	0:0	6	+
op	32:35	0:0	6	sizeof
water	32:41	0:0	6	(
water	32:43	0:0	6	header
water	32:50	0:0	6	)
arg	33:16	33:34	5	p_buffer->p_buffer
water	33:16	0:0	6	p_buffer
op	33:24	0:0	6	->
water	33:26	0:0	6	p_buffer
arg	33:36	33:55	5	p_buffer->i_buffer
water	33:36	0:0	6	p_buffer
op	33:44	0:0	6	->
water	33:46	0:0	6	i_buffer
water	33:56	0:0	4	;
water	35:8	0:0	4	i_payload_len
op	35:22	0:0	4	=
water	35:24	0:0	4	i_len
op	35:30	0:0	4	-
water	35:32	0:0	4	4
water	35:33	0:0	4	;
if	36:8	41:8	4	(i_payload_len > 0 xffff)
cond	36:13	36:30	5	i_payload_len > 0 xffff
water	36:13	0:0	6	i_payload_len
op	36:27	0:0	6	>
water	36:29	0:0	6	0
water	36:30	0:0	6	xffff
stmts	37:8	41:8	5	
water	37:8	0:0	6	{
call	38:12	39:49	6	msg_Err
arg	38:21	38:29	7	p_stream
water	38:21	0:0	8	p_stream
arg	38:31	38:62	7	"Buffer is too long (%u bytes)"
water	38:31	0:0	8	"Buffer is too long (%u bytes)"
arg	39:21	39:49	7	(unsignedint)i_payload_len
water	39:21	0:0	8	(
water	39:22	0:0	8	unsigned
water	39:31	0:0	8	int
water	39:34	0:0	8	)
water	39:35	0:0	8	i_payload_len
water	39:50	0:0	6	;
goto	40:12	40:22	6	error
water	40:17	0:0	7	error
water	41:8	0:0	6	}
water	42:8	0:0	4	p_sys
op	42:13	0:0	4	->
water	42:15	0:0	4	p_sendbuf
op	42:24	0:0	4	[
water	42:25	0:0	4	2
op	42:26	0:0	4	]
op	42:28	0:0	4	=
water	42:30	0:0	4	(
water	42:32	0:0	4	i_payload_len
op	42:46	0:0	4	>>
water	42:49	0:0	4	8
water	42:51	0:0	4	)
op	42:53	0:0	4	&
water	42:55	0:0	4	0
water	42:56	0:0	4	xff
water	42:59	0:0	4	;
water	43:8	0:0	4	p_sys
op	43:13	0:0	4	->
water	43:15	0:0	4	p_sendbuf
op	43:24	0:0	4	[
water	43:25	0:0	4	3
op	43:26	0:0	4	]
op	43:28	0:0	4	=
water	43:30	0:0	4	i_payload_len
op	43:44	0:0	4	&
water	43:46	0:0	4	0
water	43:47	0:0	4	xff
water	43:50	0:0	4	;
water	45:8	0:0	4	i_gcrypt_err
op	45:21	0:0	4	=
call	45:23	45:57	4	gcry_cipher_reset
arg	45:42	45:57	5	p_sys->aes_ctx
water	45:42	0:0	6	p_sys
op	45:47	0:0	6	->
water	45:49	0:0	6	aes_ctx
water	45:58	0:0	4	;
if	46:8	47:22	4	(CheckForGcryptError (p_stream ,i_gcrypt_err ))
cond	46:13	46:57	5	CheckForGcryptError (p_stream ,i_gcrypt_err )
call	46:13	46:57	6	CheckForGcryptError
arg	46:34	46:42	7	p_stream
water	46:34	0:0	8	p_stream
arg	46:44	46:57	7	i_gcrypt_err
water	46:44	0:0	8	i_gcrypt_err
stmts	47:12	47:22	5	
goto	47:12	47:22	6	error
water	47:17	0:0	7	error
water	49:8	0:0	4	i_gcrypt_err
op	49:21	0:0	4	=
call	49:23	50:69	4	gcry_cipher_setiv
arg	49:42	49:56	5	p_sys->aes_ctx
water	49:42	0:0	6	p_sys
op	49:47	0:0	6	->
water	49:49	0:0	6	aes_ctx
arg	49:58	49:74	5	p_sys->ps_aes_iv
water	49:58	0:0	6	p_sys
op	49:63	0:0	6	->
water	49:65	0:0	6	ps_aes_iv
arg	50:42	50:69	5	sizeof(p_sys->ps_aes_iv)
op	50:42	0:0	6	sizeof
water	50:48	0:0	6	(
water	50:50	0:0	6	p_sys
op	50:55	0:0	6	->
water	50:57	0:0	6	ps_aes_iv
water	50:67	0:0	6	)
water	50:70	0:0	4	;
if	51:8	52:22	4	(CheckForGcryptError (p_stream ,i_gcrypt_err ))
cond	51:13	51:57	5	CheckForGcryptError (p_stream ,i_gcrypt_err )
call	51:13	51:57	6	CheckForGcryptError
arg	51:34	51:42	7	p_stream
water	51:34	0:0	8	p_stream
arg	51:44	51:57	7	i_gcrypt_err
water	51:44	0:0	8	i_gcrypt_err
stmts	52:12	52:22	5	
goto	52:12	52:22	6	error
water	52:17	0:0	7	error
water	56:8	0:0	4	i_gcrypt_err
op	56:21	0:0	4	=
call	57:12	60:41	4	gcry_cipher_encrypt
arg	57:33	57:47	5	p_sys->aes_ctx
water	57:33	0:0	6	p_sys
op	57:38	0:0	6	->
water	57:40	0:0	6	aes_ctx
arg	58:33	58:68	5	p_sys->p_sendbuf+sizeof(header)
water	58:33	0:0	6	p_sys
op	58:38	0:0	6	->
water	58:40	0:0	6	p_sendbuf
op	58:50	0:0	6	+
op	58:52	0:0	6	sizeof
water	58:58	0:0	6	(
water	58:60	0:0	6	header
water	58:67	0:0	6	)
arg	59:33	59:65	5	(p_buffer->i_buffer/16)*16
water	59:33	0:0	6	(
water	59:35	0:0	6	p_buffer
op	59:43	0:0	6	->
water	59:45	0:0	6	i_buffer
op	59:54	0:0	6	/
water	59:56	0:0	6	16
water	59:59	0:0	6	)
op	59:61	0:0	6	*
water	59:63	0:0	6	16
arg	60:33	60:37	5	NULL
water	60:33	0:0	6	NULL
arg	60:39	60:41	5	0
water	60:39	0:0	6	0
water	60:42	0:0	4	;
if	61:8	62:22	4	(CheckForGcryptError (p_stream ,i_gcrypt_err ))
cond	61:13	61:57	5	CheckForGcryptError (p_stream ,i_gcrypt_err )
call	61:13	61:57	6	CheckForGcryptError
arg	61:34	61:42	7	p_stream
water	61:34	0:0	8	p_stream
arg	61:44	61:57	7	i_gcrypt_err
water	61:44	0:0	8	i_gcrypt_err
stmts	62:12	62:22	5	
goto	62:12	62:22	6	error
water	62:17	0:0	7	error
water	64:8	0:0	4	rc
op	64:11	0:0	4	=
call	64:13	65:48	4	net_Write
arg	64:24	64:32	5	p_stream
water	64:24	0:0	6	p_stream
arg	64:34	64:52	5	p_sys->i_stream_fd
water	64:34	0:0	6	p_sys
op	64:39	0:0	6	->
water	64:41	0:0	6	i_stream_fd
arg	64:54	64:58	5	NULL
water	64:54	0:0	6	NULL
arg	65:24	65:40	5	p_sys->p_sendbuf
water	65:24	0:0	6	p_sys
op	65:29	0:0	6	->
water	65:31	0:0	6	p_sendbuf
arg	65:42	65:48	5	i_len
water	65:42	0:0	6	i_len
water	65:49	0:0	4	;
if	66:8	67:22	4	(rc < 0)
cond	66:13	66:18	5	rc < 0
water	66:13	0:0	6	rc
op	66:16	0:0	6	<
water	66:18	0:0	6	0
stmts	67:12	67:22	5	
goto	67:12	67:22	6	error
water	67:17	0:0	7	error
water	68:8	0:0	4	p_next
op	68:15	0:0	4	=
water	68:17	0:0	4	p_buffer
op	68:25	0:0	4	->
water	68:27	0:0	4	p_next
water	68:33	0:0	4	;
call	69:8	69:32	4	block_Release
arg	69:23	69:32	5	p_buffer
water	69:23	0:0	6	p_buffer
water	69:33	0:0	4	;
water	70:8	0:0	4	p_buffer
op	70:17	0:0	4	=
water	70:19	0:0	4	p_next
water	70:25	0:0	4	;
water	71:4	0:0	4	}
label	72:0	72:5	2	error :
call	73:4	73:33	2	block_ChainRelease
arg	73:24	73:33	3	p_buffer
water	73:24	0:0	4	p_buffer
water	73:34	0:0	2	;
return	74:4	74:10	2	
