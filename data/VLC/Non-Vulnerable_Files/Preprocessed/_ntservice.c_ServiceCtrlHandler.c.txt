func	2:12	20:0	0	WINAPI	ServiceCtrlHandler
params	2:37	0:0	1	
param	2:39	2:53	2	DWORD	control
stmnts	0:0	19:54	1	
decl	4:4	4:58	2	intf_thread_t	*p_intf
op	4:26	0:0	2	=
water	4:28	0:0	2	(
water	4:29	0:0	2	intf_thread_t
op	4:43	0:0	2	*
water	4:44	0:0	2	)
water	4:45	0:0	2	p_global_intf
decl	5:4	5:41	2	intf_sys_t	*p_sys
op	5:26	0:0	2	=
water	5:28	0:0	2	p_intf
op	5:34	0:0	2	->
water	5:36	0:0	2	p_sys
switch	6:4	18:4	2	(control)
cond	6:12	6:12	3	control
water	6:12	0:0	4	control
stmts	7:4	18:4	3	
water	7:4	0:0	4	{
label	8:4	8:33	4	case SERVICE_CONTROL_SHUTDOWN :
label	9:4	9:29	4	case SERVICE_CONTROL_STOP :
water	10:8	0:0	4	p_sys
op	10:13	0:0	4	->
water	10:15	0:0	4	status
op	10:21	0:0	4	.
water	10:22	0:0	4	dwCurrentState
op	10:37	0:0	4	=
water	10:39	0:0	4	SERVICE_STOPPED
water	10:54	0:0	4	;
water	11:8	0:0	4	p_sys
op	11:13	0:0	4	->
water	11:15	0:0	4	status
op	11:21	0:0	4	.
water	11:22	0:0	4	dwWin32ExitCode
op	11:38	0:0	4	=
water	11:40	0:0	4	0
water	11:41	0:0	4	;
water	12:8	0:0	4	p_sys
op	12:13	0:0	4	->
water	12:15	0:0	4	status
op	12:21	0:0	4	.
water	12:22	0:0	4	dwCheckPoint
op	12:35	0:0	4	=
water	12:37	0:0	4	0
water	12:38	0:0	4	;
water	13:8	0:0	4	p_sys
op	13:13	0:0	4	->
water	13:15	0:0	4	status
op	13:21	0:0	4	.
water	13:22	0:0	4	dwWaitHint
op	13:33	0:0	4	=
water	13:35	0:0	4	0
water	13:36	0:0	4	;
break	14:8	14:13	4	
label	15:4	15:36	4	case SERVICE_CONTROL_INTERROGATE :
break	17:8	17:13	4	
water	18:4	0:0	4	}
call	19:4	19:53	2	SetServiceStatus
arg	19:22	19:36	3	p_sys->hStatus
water	19:22	0:0	4	p_sys
op	19:27	0:0	4	->
water	19:29	0:0	4	hStatus
arg	19:38	19:53	3	&p_sys->status
op	19:38	0:0	4	&
water	19:39	0:0	4	p_sys
op	19:44	0:0	4	->
water	19:46	0:0	4	status
water	19:54	0:0	2	;
