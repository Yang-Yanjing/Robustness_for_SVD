func	2:0	38:0	0	static ssize_t	Read
params	2:19	0:0	1	
param	2:21	2:39	2	access_t *	p_access
param	2:41	2:58	2	uint8_t *	p_buffer
param	2:60	2:73	2	size_t	i_len
stmnts	0:0	37:4	1	
decl	4:4	4:41	2	access_sys_t	*p_sys
op	4:24	0:0	2	=
water	4:26	0:0	2	p_access
op	4:34	0:0	2	->
water	4:36	0:0	2	p_sys
call	5:4	5:33	2	assert
arg	5:12	5:33	3	p_sys->data.fd!=-1
water	5:12	0:0	4	p_sys
op	5:17	0:0	4	->
water	5:19	0:0	4	data
op	5:23	0:0	4	.
water	5:24	0:0	4	fd
op	5:27	0:0	4	!=
op	5:30	0:0	4	-
water	5:31	0:0	4	1
water	5:34	0:0	2	;
call	6:4	6:24	2	assert
arg	6:12	6:24	3	!p_sys->out
op	6:12	0:0	4	!
water	6:13	0:0	4	p_sys
op	6:18	0:0	4	->
water	6:20	0:0	4	out
water	6:25	0:0	2	;
if	7:4	8:16	2	(p_access -> info . b_eof)
cond	7:8	7:23	3	p_access -> info . b_eof
water	7:8	0:0	4	p_access
op	7:16	0:0	4	->
water	7:18	0:0	4	info
op	7:22	0:0	4	.
water	7:23	0:0	4	b_eof
stmts	8:8	8:16	3	
return	8:8	8:16	4	0
water	8:15	0:0	5	0
if	9:4	27:4	2	(p_sys -> directory)
cond	9:8	9:15	3	p_sys -> directory
water	9:8	0:0	4	p_sys
op	9:13	0:0	4	->
water	9:15	0:0	4	directory
stmts	10:4	27:4	3	
water	10:4	0:0	4	{
decl	11:8	11:79	4	char	*psz_line
op	11:23	0:0	4	=
call	11:25	11:78	5	net_Gets
arg	11:35	11:43	6	p_access
water	11:35	0:0	7	p_access
arg	11:45	11:59	6	p_sys->data.fd
water	11:45	0:0	7	p_sys
op	11:50	0:0	7	->
water	11:52	0:0	7	data
op	11:56	0:0	7	.
water	11:57	0:0	7	fd
arg	11:61	11:78	6	p_sys->data.p_vs
water	11:61	0:0	7	p_sys
op	11:66	0:0	7	->
water	11:68	0:0	7	data
op	11:72	0:0	7	.
water	11:73	0:0	7	p_vs
if	12:8	16:8	4	(! psz_line)
cond	12:12	12:13	5	! psz_line
op	12:12	0:0	6	!
water	12:13	0:0	6	psz_line
stmts	13:8	16:8	5	
water	13:8	0:0	6	{
water	14:12	0:0	6	p_access
op	14:20	0:0	6	->
water	14:22	0:0	6	info
op	14:26	0:0	6	.
water	14:27	0:0	6	b_eof
op	14:33	0:0	6	=
water	14:35	0:0	6	true
water	14:39	0:0	6	;
return	15:12	15:20	6	0
water	15:19	0:0	7	0
water	16:8	0:0	6	}
else	17:8	26:8	4
stmts	18:8	26:8	5	
water	18:8	0:0	6	{
call	19:12	23:52	6	snprintf
arg	19:22	19:37	7	(char*)p_buffer
water	19:22	0:0	8	(
water	19:23	0:0	8	char
op	19:27	0:0	8	*
water	19:28	0:0	8	)
water	19:29	0:0	8	p_buffer
arg	19:39	19:44	7	i_len
water	19:39	0:0	8	i_len
arg	19:46	19:66	7	"%s://%s:%d/%s/%s\n"
water	19:46	0:0	8	"%s://%s:%d/%s/%s\n"
arg	20:22	21:75	7	(p_sys->tlsmode==NONE)?"ftp":((p_sys->tlsmode==IMPLICIT)?"ftps":"ftpes")
water	20:22	0:0	8	(
water	20:24	0:0	8	p_sys
op	20:29	0:0	8	->
water	20:31	0:0	8	tlsmode
op	20:39	0:0	8	==
water	20:42	0:0	8	NONE
water	20:47	0:0	8	)
water	20:49	0:0	8	?
water	20:51	0:0	8	"ftp"
water	20:57	0:0	8	:
water	21:22	0:0	8	(
water	21:24	0:0	8	(
water	21:26	0:0	8	p_sys
op	21:31	0:0	8	->
water	21:33	0:0	8	tlsmode
op	21:41	0:0	8	==
water	21:44	0:0	8	IMPLICIT
water	21:53	0:0	8	)
water	21:55	0:0	8	?
water	21:57	0:0	8	"ftps"
water	21:64	0:0	8	:
water	21:66	0:0	8	"ftpes"
water	21:74	0:0	8	)
arg	22:22	22:41	7	p_sys->url.psz_host
water	22:22	0:0	8	p_sys
op	22:27	0:0	8	->
water	22:29	0:0	8	url
op	22:32	0:0	8	.
water	22:33	0:0	8	psz_host
arg	22:43	22:60	7	p_sys->url.i_port
water	22:43	0:0	8	p_sys
op	22:48	0:0	8	->
water	22:50	0:0	8	url
op	22:53	0:0	8	.
water	22:54	0:0	8	i_port
arg	23:22	23:41	7	p_sys->url.psz_path
water	23:22	0:0	8	p_sys
op	23:27	0:0	8	->
water	23:29	0:0	8	url
op	23:32	0:0	8	.
water	23:33	0:0	8	psz_path
arg	23:43	23:52	7	psz_line
water	23:43	0:0	8	psz_line
water	23:53	0:0	6	;
call	24:12	24:27	6	free
arg	24:18	24:27	7	psz_line
water	24:18	0:0	8	psz_line
water	24:28	0:0	6	;
return	25:12	25:51	6	strlen((constchar*)p_buffer)
call	25:19	25:50	7	strlen
arg	25:27	25:50	8	(constchar*)p_buffer
water	25:27	0:0	9	(
water	25:28	0:0	9	const
water	25:34	0:0	9	char
op	25:39	0:0	9	*
water	25:40	0:0	9	)
water	25:41	0:0	9	p_buffer
water	26:8	0:0	6	}
water	27:4	0:0	4	}
else	28:4	37:4	2
stmts	29:4	37:4	3	
water	29:4	0:0	4	{
decl	30:8	31:55	4	int	i_read
op	30:19	0:0	4	=
call	30:21	31:54	5	net_Read
arg	30:31	30:39	6	p_access
water	30:31	0:0	7	p_access
arg	30:41	30:55	6	p_sys->data.fd
water	30:41	0:0	7	p_sys
op	30:46	0:0	7	->
water	30:48	0:0	7	data
op	30:52	0:0	7	.
water	30:53	0:0	7	fd
arg	30:57	30:73	6	p_sys->data.p_vs
water	30:57	0:0	7	p_sys
op	30:62	0:0	7	->
water	30:64	0:0	7	data
op	30:68	0:0	7	.
water	30:69	0:0	7	p_vs
arg	31:31	31:39	6	p_buffer
water	31:31	0:0	7	p_buffer
arg	31:41	31:46	6	i_len
water	31:41	0:0	7	i_len
arg	31:48	31:54	6	false
water	31:48	0:0	7	false
if	32:8	33:39	4	(i_read == 0)
cond	32:12	32:22	5	i_read == 0
water	32:12	0:0	6	i_read
op	32:19	0:0	6	==
water	32:22	0:0	6	0
stmts	33:12	33:39	5	
water	33:12	0:0	6	p_access
op	33:20	0:0	6	->
water	33:22	0:0	6	info
op	33:26	0:0	6	.
water	33:27	0:0	6	b_eof
op	33:33	0:0	6	=
water	33:35	0:0	6	true
water	33:39	0:0	6	;
else	34:8	35:42	4
stmts	34:13	35:42	5	
if	34:13	35:42	6	(i_read > 0)
cond	34:17	34:26	7	i_read > 0
water	34:17	0:0	8	i_read
op	34:24	0:0	8	>
water	34:26	0:0	8	0
stmts	35:12	35:42	7	
water	35:12	0:0	8	p_access
op	35:20	0:0	8	->
water	35:22	0:0	8	info
op	35:26	0:0	8	.
water	35:27	0:0	8	i_pos
op	35:33	0:0	8	+=
water	35:36	0:0	8	i_read
water	35:42	0:0	8	;
return	36:8	36:21	4	i_read
water	36:15	0:0	5	i_read
water	37:4	0:0	4	}
