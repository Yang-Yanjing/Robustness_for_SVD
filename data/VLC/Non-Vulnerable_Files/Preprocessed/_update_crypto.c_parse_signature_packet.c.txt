func	2:0	53:0	0	static int	parse_signature_packet
params	2:33	0:0	1	
param	2:35	2:60	2	signature_packet_t *	p_sig
param	3:35	3:55	2	const uint8_t *	p_buf
param	3:57	3:77	2	size_t	i_packet_len
stmnts	5:4	52:23	1	
if	5:4	6:27	2	(! i_packet_len)
cond	5:8	5:9	3	! i_packet_len
op	5:8	0:0	4	!
water	5:9	0:0	4	i_packet_len
stmts	6:8	6:27	3	
return	6:8	6:27	4	VLC_EGENERIC
water	6:15	0:0	5	VLC_EGENERIC
water	7:4	0:0	2	p_sig
op	7:9	0:0	2	->
water	7:11	0:0	2	version
op	7:19	0:0	2	=
op	7:21	0:0	2	*
water	7:22	0:0	2	p_buf
op	7:27	0:0	2	++
water	7:29	0:0	2	;
decl	8:4	8:17	2	size_t	i_read
switch	9:4	21:4	2	(p_sig -> version)
cond	9:12	9:19	3	p_sig -> version
water	9:12	0:0	4	p_sig
op	9:17	0:0	4	->
water	9:19	0:0	4	version
stmts	10:4	21:4	3	
water	10:4	0:0	4	{
label	11:8	11:14	4	case 3 :
water	12:12	0:0	4	i_read
op	12:19	0:0	4	=
call	12:21	12:75	4	parse_signature_v3_packet
arg	12:48	12:53	5	p_sig
water	12:48	0:0	6	p_sig
arg	12:55	12:60	5	p_buf
water	12:55	0:0	6	p_buf
arg	12:62	12:75	5	i_packet_len
water	12:62	0:0	6	i_packet_len
water	12:76	0:0	4	;
break	13:12	13:17	4	
label	14:8	14:14	4	case 4 :
water	15:12	0:0	4	p_sig
op	15:17	0:0	4	->
water	15:19	0:0	4	specific
op	15:27	0:0	4	.
water	15:28	0:0	4	v4
op	15:30	0:0	4	.
water	15:31	0:0	4	hashed_data
op	15:43	0:0	4	=
water	15:45	0:0	4	NULL
water	15:49	0:0	4	;
water	16:12	0:0	4	p_sig
op	16:17	0:0	4	->
water	16:19	0:0	4	specific
op	16:27	0:0	4	.
water	16:28	0:0	4	v4
op	16:30	0:0	4	.
water	16:31	0:0	4	unhashed_data
op	16:45	0:0	4	=
water	16:47	0:0	4	NULL
water	16:51	0:0	4	;
water	17:12	0:0	4	i_read
op	17:19	0:0	4	=
call	17:21	17:75	4	parse_signature_v4_packet
arg	17:48	17:53	5	p_sig
water	17:48	0:0	6	p_sig
arg	17:55	17:60	5	p_buf
water	17:55	0:0	6	p_buf
arg	17:62	17:75	5	i_packet_len
water	17:62	0:0	6	i_packet_len
water	17:76	0:0	4	;
break	18:12	18:17	4	
label	19:8	19:15	4	default :
return	20:12	20:31	4	VLC_EGENERIC
water	20:19	0:0	5	VLC_EGENERIC
water	21:4	0:0	4	}
if	22:4	23:18	2	(i_read == 0)
cond	22:8	22:18	3	i_read == 0
water	22:8	0:0	4	i_read
op	22:15	0:0	4	==
water	22:18	0:0	4	0
stmts	23:8	23:18	3	
goto	23:8	23:18	4	error
water	23:13	0:0	5	error
if	24:4	25:18	2	(p_sig -> public_key_algo != GCRY_PK_DSA)
cond	24:8	24:34	3	p_sig -> public_key_algo != GCRY_PK_DSA
water	24:8	0:0	4	p_sig
op	24:13	0:0	4	->
water	24:15	0:0	4	public_key_algo
op	24:31	0:0	4	!=
water	24:34	0:0	4	GCRY_PK_DSA
stmts	25:8	25:18	3	
goto	25:8	25:18	4	error
water	25:13	0:0	5	error
switch	26:4	37:4	2	(p_sig -> type)
cond	26:12	26:19	3	p_sig -> type
water	26:12	0:0	4	p_sig
op	26:17	0:0	4	->
water	26:19	0:0	4	type
stmts	27:4	37:4	3	
water	27:4	0:0	4	{
label	28:8	28:29	4	case BINARY_SIGNATURE :
label	29:8	29:27	4	case TEXT_SIGNATURE :
label	30:8	30:34	4	case GENERIC_KEY_SIGNATURE :
label	31:8	31:34	4	case PERSONA_KEY_SIGNATURE :
label	32:8	32:33	4	case CASUAL_KEY_SIGNATURE :
label	33:8	33:35	4	case POSITIVE_KEY_SIGNATURE :
break	34:12	34:17	4	
label	35:8	35:15	4	default :
goto	36:12	36:22	4	error
water	36:17	0:0	5	error
water	37:4	0:0	4	}
water	38:4	0:0	2	p_buf
op	38:9	0:0	2	--
water	38:11	0:0	2	;
water	39:4	0:0	2	p_buf
op	39:10	0:0	2	+=
water	39:13	0:0	2	i_read
water	39:19	0:0	2	;
call	40:4	40:26	2	READ_MPI
arg	40:13	40:21	3	p_sig->r
water	40:13	0:0	4	p_sig
op	40:18	0:0	4	->
water	40:20	0:0	4	r
arg	40:23	40:26	3	256
water	40:23	0:0	4	256
water	40:27	0:0	2	;
call	41:4	41:26	2	READ_MPI
arg	41:13	41:21	3	p_sig->s
water	41:13	0:0	4	p_sig
op	41:18	0:0	4	->
water	41:20	0:0	4	s
arg	41:23	41:26	3	256
water	41:23	0:0	4	256
water	41:27	0:0	2	;
call	42:4	42:35	2	assert
arg	42:12	42:35	3	i_read==i_packet_len
water	42:12	0:0	4	i_read
op	42:19	0:0	4	==
water	42:22	0:0	4	i_packet_len
water	42:36	0:0	2	;
if	43:4	44:18	2	(i_read < i_packet_len)
cond	43:8	43:17	3	i_read < i_packet_len
water	43:8	0:0	4	i_read
op	43:15	0:0	4	<
water	43:17	0:0	4	i_packet_len
stmts	44:8	44:18	3	
goto	44:8	44:18	4	error
water	44:13	0:0	5	error
return	45:4	45:22	2	VLC_SUCCESS
water	45:11	0:0	3	VLC_SUCCESS
label	46:0	46:5	2	error :
if	47:4	51:4	2	(p_sig -> version == 4)
cond	47:8	47:26	3	p_sig -> version == 4
water	47:8	0:0	4	p_sig
op	47:13	0:0	4	->
water	47:15	0:0	4	version
op	47:23	0:0	4	==
water	47:26	0:0	4	4
stmts	48:4	51:4	3	
water	48:4	0:0	4	{
call	49:8	49:45	4	free
arg	49:14	49:45	5	p_sig->specific.v4.hashed_data
water	49:14	0:0	6	p_sig
op	49:19	0:0	6	->
water	49:21	0:0	6	specific
op	49:29	0:0	6	.
water	49:30	0:0	6	v4
op	49:32	0:0	6	.
water	49:33	0:0	6	hashed_data
water	49:46	0:0	4	;
call	50:8	50:47	4	free
arg	50:14	50:47	5	p_sig->specific.v4.unhashed_data
water	50:14	0:0	6	p_sig
op	50:19	0:0	6	->
water	50:21	0:0	6	specific
op	50:29	0:0	6	.
water	50:30	0:0	6	v4
op	50:32	0:0	6	.
water	50:33	0:0	6	unhashed_data
water	50:48	0:0	4	;
water	51:4	0:0	4	}
return	52:4	52:23	2	VLC_EGENERIC
water	52:11	0:0	3	VLC_EGENERIC
