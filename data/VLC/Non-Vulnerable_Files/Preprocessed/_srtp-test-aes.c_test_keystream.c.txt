func	2:0	43:0	0	static void	test_keystream
params	2:27	0:0	1	
param	2:28	2:32	2	void
stmnts	4:4	42:14	1	
water	4:4	0:0	2	static
water	4:11	0:0	2	const
water	4:17	0:0	2	uint8_t
water	4:25	0:0	2	key
op	4:28	0:0	2	[
water	4:29	0:0	2	16
op	4:31	0:0	2	]
op	4:33	0:0	2	=
water	5:8	0:0	2	"\x2B\x7E\x15\x16\x28\xAE\xD2\xA6\xAB\xF7\x15\x88\x09\xCF\x4F\x3C"
water	5:74	0:0	2	;
decl	6:4	8:50	2	const uint32_t	salt[4]
op	6:26	0:0	2	=
water	7:8	0:0	2	{
call	7:10	7:27	3	htonl
arg	7:17	7:27	4	0xf0f1f2f3
water	7:17	0:0	5	0
water	7:18	0:0	5	xf0f1f2f3
water	7:28	0:0	2	,
call	7:30	7:47	3	htonl
arg	7:37	7:47	4	0xf4f5f6f7
water	7:37	0:0	5	0
water	7:38	0:0	5	xf4f5f6f7
water	7:48	0:0	2	,
call	8:10	8:27	3	htonl
arg	8:17	8:27	4	0xf8f9fafb
water	8:17	0:0	5	0
water	8:18	0:0	5	xf8f9fafb
water	8:28	0:0	2	,
call	8:30	8:47	3	htonl
arg	8:37	8:47	4	0xfcfd0000
water	8:37	0:0	5	0
water	8:38	0:0	5	xfcfd0000
water	8:49	0:0	2	}
call	9:4	9:37	2	puts
arg	9:10	9:37	3	"AES-CM key stream test..."
water	9:10	0:0	4	"AES-CM key stream test..."
water	9:38	0:0	2	;
decl	10:4	10:38	2	uint8_t	*buf
op	10:17	0:0	2	=
call	10:19	10:37	3	calloc
arg	10:27	10:33	4	0xff02
water	10:27	0:0	5	0
water	10:28	0:0	5	xff02
arg	10:35	10:37	4	16
water	10:35	0:0	5	16
if	11:4	15:4	2	(buf == NULL)
cond	11:8	11:15	3	buf == NULL
water	11:8	0:0	4	buf
op	11:12	0:0	4	==
water	11:15	0:0	4	NULL
stmts	12:4	15:4	3	
water	12:4	0:0	4	{
call	13:8	13:53	4	fputs
arg	13:15	13:45	5	"Not enough memory for test\n"
water	13:15	0:0	6	"Not enough memory for test\n"
arg	13:47	13:53	5	stderr
water	13:47	0:0	6	stderr
water	13:54	0:0	4	;
return	14:8	14:14	4	
water	15:4	0:0	4	}
call	16:4	16:28	2	printf
arg	16:12	16:28	3	" session key: "
water	16:12	0:0	4	" session key: "
water	16:29	0:0	2	;
call	17:4	17:31	2	printhex
arg	17:14	17:17	3	key
water	17:14	0:0	4	key
arg	17:19	17:31	3	sizeof(key)
op	17:19	0:0	4	sizeof
water	17:26	0:0	4	(
water	17:27	0:0	4	key
water	17:30	0:0	4	)
water	17:32	0:0	2	;
decl	18:4	18:23	2	gcry_cipher_hd_t	hd
if	19:4	20:45	2	(gcry_cipher_open (& hd ,GCRY_CIPHER_AES ,GCRY_CIPHER_MODE_CTR ,0 ))
cond	19:8	19:71	3	gcry_cipher_open (& hd ,GCRY_CIPHER_AES ,GCRY_CIPHER_MODE_CTR ,0 )
call	19:8	19:71	4	gcry_cipher_open
arg	19:26	19:29	5	&hd
op	19:26	0:0	6	&
water	19:27	0:0	6	hd
arg	19:31	19:46	5	GCRY_CIPHER_AES
water	19:31	0:0	6	GCRY_CIPHER_AES
arg	19:48	19:68	5	GCRY_CIPHER_MODE_CTR
water	19:48	0:0	6	GCRY_CIPHER_MODE_CTR
arg	19:70	19:71	5	0
water	19:70	0:0	6	0
stmts	20:8	20:45	3	
call	20:8	20:44	4	fatal
arg	20:15	20:44	5	"Cipher initialization error"
water	20:15	0:0	6	"Cipher initialization error"
water	20:45	0:0	4	;
if	21:4	22:34	2	(gcry_cipher_setkey (hd ,key ,sizeof ( key ) ))
cond	21:8	21:49	3	gcry_cipher_setkey (hd ,key ,sizeof ( key ) )
call	21:8	21:49	4	gcry_cipher_setkey
arg	21:28	21:30	5	hd
water	21:28	0:0	6	hd
arg	21:32	21:35	5	key
water	21:32	0:0	6	key
arg	21:37	21:49	5	sizeof(key)
op	21:37	0:0	6	sizeof
water	21:44	0:0	6	(
water	21:45	0:0	6	key
water	21:48	0:0	6	)
stmts	22:8	22:34	3	
call	22:8	22:33	4	fatal
arg	22:15	22:33	5	"Cipher key error"
water	22:15	0:0	6	"Cipher key error"
water	22:34	0:0	4	;
if	23:4	24:36	2	(rtp_crypt (hd ,0 ,0 ,0 ,salt ,buf ,0 xff020 ))
cond	23:8	23:50	3	rtp_crypt (hd ,0 ,0 ,0 ,salt ,buf ,0 xff020 )
call	23:8	23:50	4	rtp_crypt
arg	23:19	23:21	5	hd
water	23:19	0:0	6	hd
arg	23:23	23:24	5	0
water	23:23	0:0	6	0
arg	23:26	23:27	5	0
water	23:26	0:0	6	0
arg	23:29	23:30	5	0
water	23:29	0:0	6	0
arg	23:32	23:36	5	salt
water	23:32	0:0	6	salt
arg	23:38	23:41	5	buf
water	23:38	0:0	6	buf
arg	23:43	23:50	5	0xff020
water	23:43	0:0	6	0
water	23:44	0:0	6	xff020
stmts	24:8	24:36	3	
call	24:8	24:35	4	fatal
arg	24:15	24:35	5	"Encryption failure"
water	24:15	0:0	6	"Encryption failure"
water	24:36	0:0	4	;
call	25:4	25:25	2	gcry_cipher_close
arg	25:23	25:25	3	hd
water	25:23	0:0	4	hd
water	25:26	0:0	2	;
water	26:4	0:0	2	static
water	26:11	0:0	2	const
water	26:17	0:0	2	uint8_t
water	26:25	0:0	2	good_start
op	26:35	0:0	2	[
water	26:36	0:0	2	48
op	26:38	0:0	2	]
op	26:40	0:0	2	=
water	27:8	0:0	2	"\xE0\x3E\xAD\x09\x35\xC9\x5E\x80\xE1\x66\xB1\x6D\xD9\x2B\x4E\xB4"
water	28:8	0:0	2	"\xD2\x35\x13\x16\x2B\x02\xD0\xF7\x2A\x43\xA2\xFE\x4A\x5F\x97\xAB"
water	29:8	0:0	2	"\x41\xE9\x5B\x3B\xB0\xA2\xE8\xDD\x47\x79\x01\xE4\xFC\xA8\x94\xC0"
water	29:74	0:0	2	;
water	30:4	0:0	2	static
water	30:11	0:0	2	const
water	30:17	0:0	2	uint8_t
water	30:25	0:0	2	good_end
op	30:33	0:0	2	[
water	30:34	0:0	2	48
op	30:36	0:0	2	]
op	30:38	0:0	2	=
water	31:8	0:0	2	"\xEC\x8C\xDF\x73\x98\x60\x7C\xB0\xF2\xD2\x16\x75\xEA\x9E\xA1\xE4"
water	32:8	0:0	2	"\x36\x2B\x7C\x3C\x67\x73\x51\x63\x18\xA0\x77\xD7\xFC\x50\x73\xAE"
water	33:8	0:0	2	"\x6A\x2C\xC3\x78\x78\x89\x37\x4F\xBE\xB4\xC8\x1B\x17\xBA\x6C\x44"
water	33:74	0:0	2	;
call	34:4	34:28	2	printf
arg	34:12	34:28	3	" key stream:  "
water	34:12	0:0	4	" key stream:  "
water	34:29	0:0	2	;
call	35:4	35:38	2	printhex
arg	35:14	35:17	3	buf
water	35:14	0:0	4	buf
arg	35:19	35:38	3	sizeof(good_start)
op	35:19	0:0	4	sizeof
water	35:26	0:0	4	(
water	35:27	0:0	4	good_start
water	35:37	0:0	4	)
water	35:39	0:0	2	;
call	36:4	36:28	2	printf
arg	36:12	36:28	3	" ... cont'd : "
water	36:12	0:0	4	" ... cont'd : "
water	36:29	0:0	2	;
call	37:4	37:66	2	printhex
arg	37:14	37:47	3	buf+0xff020-sizeof(good_end)
water	37:14	0:0	4	buf
op	37:18	0:0	4	+
water	37:20	0:0	4	0
water	37:21	0:0	4	xff020
op	37:28	0:0	4	-
op	37:30	0:0	4	sizeof
water	37:37	0:0	4	(
water	37:38	0:0	4	good_end
water	37:46	0:0	4	)
arg	37:49	37:66	3	sizeof(good_end)
op	37:49	0:0	4	sizeof
water	37:56	0:0	4	(
water	37:57	0:0	4	good_end
water	37:65	0:0	4	)
water	37:67	0:0	2	;
if	38:4	41:40	2	(memcmp (buf ,good_start ,sizeof ( good_start ) ) ||memcmp (buf + 0 xff020 - sizeof ( good_end ) ,good_end ,sizeof ( good_end ) ))
cond	38:8	40:33	3	memcmp (buf ,good_start ,sizeof ( good_start ) ) ||memcmp (buf + 0 xff020 - sizeof ( good_end ) ,good_end ,sizeof ( good_end ) )
call	38:8	38:52	4	memcmp
arg	38:16	38:19	5	buf
water	38:16	0:0	6	buf
arg	38:21	38:31	5	good_start
water	38:21	0:0	6	good_start
arg	38:33	38:52	5	sizeof(good_start)
op	38:33	0:0	6	sizeof
water	38:40	0:0	6	(
water	38:41	0:0	6	good_start
water	38:51	0:0	6	)
op	39:5	0:0	4	||
call	39:8	40:33	4	memcmp
arg	39:16	39:49	5	buf+0xff020-sizeof(good_end)
water	39:16	0:0	6	buf
op	39:20	0:0	6	+
water	39:22	0:0	6	0
water	39:23	0:0	6	xff020
op	39:30	0:0	6	-
op	39:32	0:0	6	sizeof
water	39:39	0:0	6	(
water	39:40	0:0	6	good_end
water	39:48	0:0	6	)
arg	39:51	39:59	5	good_end
water	39:51	0:0	6	good_end
arg	40:16	40:33	5	sizeof(good_end)
op	40:16	0:0	6	sizeof
water	40:23	0:0	6	(
water	40:24	0:0	6	good_end
water	40:32	0:0	6	)
stmts	41:8	41:40	3	
call	41:8	41:39	4	fatal
arg	41:15	41:39	5	"Key stream test failed"
water	41:15	0:0	6	"Key stream test failed"
water	41:40	0:0	4	;
call	42:4	42:13	2	free
arg	42:10	42:13	3	buf
water	42:10	0:0	4	buf
water	42:14	0:0	2	;
