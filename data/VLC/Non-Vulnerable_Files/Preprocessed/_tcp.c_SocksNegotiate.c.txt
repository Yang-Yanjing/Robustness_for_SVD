func	2:0	70:0	0	static int	SocksNegotiate
params	2:25	0:0	1	
param	2:27	2:46	2	vlc_object_t *	p_obj
param	3:27	3:33	2	int	fd
param	3:35	3:54	2	int	i_socks_version
param	4:27	4:53	2	const char *	psz_socks_user
param	5:27	5:56	2	const char *	psz_socks_passwd
stmnts	0:0	69:22	1	
decl	7:4	7:29	2	uint8_t	buffer[128+2*256]
decl	8:4	8:13	2	int	i_len
decl	9:4	9:23	2	bool	b_auth
op	9:16	0:0	2	=
water	9:18	0:0	2	false
if	10:4	11:26	2	(i_socks_version != 5)
cond	10:8	10:27	3	i_socks_version != 5
water	10:8	0:0	4	i_socks_version
op	10:24	0:0	4	!=
water	10:27	0:0	4	5
stmts	11:8	11:26	3	
return	11:8	11:26	4	VLC_SUCCESS
water	11:15	0:0	5	VLC_SUCCESS
water	13:4	0:0	2	buffer
op	13:10	0:0	2	[
water	13:11	0:0	2	0
op	13:12	0:0	2	]
op	13:14	0:0	2	=
water	13:16	0:0	2	i_socks_version
water	13:31	0:0	2	;
if	14:4	21:4	2	(psz_socks_user != NULL && psz_socks_passwd != NULL)
cond	14:8	14:54	3	psz_socks_user != NULL && psz_socks_passwd != NULL
water	14:8	0:0	4	psz_socks_user
op	14:23	0:0	4	!=
water	14:26	0:0	4	NULL
op	14:31	0:0	4	&&
water	14:34	0:0	4	psz_socks_passwd
op	14:51	0:0	4	!=
water	14:54	0:0	4	NULL
stmts	15:4	21:4	3	
water	15:4	0:0	4	{
water	16:8	0:0	4	buffer
op	16:14	0:0	4	[
water	16:15	0:0	4	1
op	16:16	0:0	4	]
op	16:18	0:0	4	=
water	16:20	0:0	4	2
water	16:21	0:0	4	;
water	17:8	0:0	4	buffer
op	17:14	0:0	4	[
water	17:15	0:0	4	2
op	17:16	0:0	4	]
op	17:18	0:0	4	=
water	17:20	0:0	4	0
water	17:21	0:0	4	x00
water	17:24	0:0	4	;
water	18:8	0:0	4	buffer
op	18:14	0:0	4	[
water	18:15	0:0	4	3
op	18:16	0:0	4	]
op	18:18	0:0	4	=
water	18:20	0:0	4	0
water	18:21	0:0	4	x02
water	18:24	0:0	4	;
water	19:8	0:0	4	i_len
op	19:14	0:0	4	=
water	19:16	0:0	4	4
water	19:17	0:0	4	;
water	20:8	0:0	4	b_auth
op	20:15	0:0	4	=
water	20:17	0:0	4	true
water	20:21	0:0	4	;
water	21:4	0:0	4	}
else	22:4	27:4	2
stmts	23:4	27:4	3	
water	23:4	0:0	4	{
water	24:8	0:0	4	buffer
op	24:14	0:0	4	[
water	24:15	0:0	4	1
op	24:16	0:0	4	]
op	24:18	0:0	4	=
water	24:20	0:0	4	1
water	24:21	0:0	4	;
water	25:8	0:0	4	buffer
op	25:14	0:0	4	[
water	25:15	0:0	4	2
op	25:16	0:0	4	]
op	25:18	0:0	4	=
water	25:20	0:0	4	0
water	25:21	0:0	4	x00
water	25:24	0:0	4	;
water	26:8	0:0	4	i_len
op	26:14	0:0	4	=
water	26:16	0:0	4	3
water	26:17	0:0	4	;
water	27:4	0:0	4	}
if	28:4	29:27	2	(net_Write (p_obj ,fd ,NULL ,buffer ,i_len ) != i_len)
cond	28:8	28:55	3	net_Write (p_obj ,fd ,NULL ,buffer ,i_len ) != i_len
call	28:8	28:50	4	net_Write
arg	28:19	28:24	5	p_obj
water	28:19	0:0	6	p_obj
arg	28:26	28:28	5	fd
water	28:26	0:0	6	fd
arg	28:30	28:34	5	NULL
water	28:30	0:0	6	NULL
arg	28:36	28:42	5	buffer
water	28:36	0:0	6	buffer
arg	28:44	28:50	5	i_len
water	28:44	0:0	6	i_len
op	28:52	0:0	4	!=
water	28:55	0:0	4	i_len
stmts	29:8	29:27	3	
return	29:8	29:27	4	VLC_EGENERIC
water	29:15	0:0	5	VLC_EGENERIC
if	30:4	31:27	2	(net_Read (p_obj ,fd ,NULL ,buffer ,2 ,true ) != 2)
cond	30:8	30:56	3	net_Read (p_obj ,fd ,NULL ,buffer ,2 ,true ) != 2
call	30:8	30:51	4	net_Read
arg	30:18	30:23	5	p_obj
water	30:18	0:0	6	p_obj
arg	30:25	30:27	5	fd
water	30:25	0:0	6	fd
arg	30:29	30:33	5	NULL
water	30:29	0:0	6	NULL
arg	30:35	30:41	5	buffer
water	30:35	0:0	6	buffer
arg	30:43	30:44	5	2
water	30:43	0:0	6	2
arg	30:46	30:51	5	true
water	30:46	0:0	6	true
op	30:53	0:0	4	!=
water	30:56	0:0	4	2
stmts	31:8	31:27	3	
return	31:8	31:27	4	VLC_EGENERIC
water	31:15	0:0	5	VLC_EGENERIC
call	32:4	32:66	2	msg_Dbg
arg	32:13	32:18	3	p_obj
water	32:13	0:0	4	p_obj
arg	32:20	32:43	3	"socks: v=%d method=%x"
water	32:20	0:0	4	"socks: v=%d method=%x"
arg	32:45	32:54	3	buffer[0]
water	32:45	0:0	4	buffer
op	32:51	0:0	4	[
water	32:52	0:0	4	0
op	32:53	0:0	4	]
arg	32:56	32:66	3	buffer[1]
water	32:56	0:0	4	buffer
op	32:62	0:0	4	[
water	32:63	0:0	4	1
op	32:64	0:0	4	]
water	32:67	0:0	2	;
if	33:4	36:4	2	(buffer [ 1 ] == 0 x00)
cond	33:8	33:22	3	buffer [ 1 ] == 0 x00
water	33:8	0:0	4	buffer
op	33:14	0:0	4	[
water	33:15	0:0	4	1
op	33:16	0:0	4	]
op	33:18	0:0	4	==
water	33:21	0:0	4	0
water	33:22	0:0	4	x00
stmts	34:4	36:4	3	
water	34:4	0:0	4	{
call	35:8	35:60	4	msg_Dbg
arg	35:17	35:22	5	p_obj
water	35:17	0:0	6	p_obj
arg	35:24	35:60	5	"socks: no authentication required"
water	35:24	0:0	6	"socks: no authentication required"
water	35:61	0:0	4	;
water	36:4	0:0	4	}
else	37:4	59:4	2
stmts	37:9	59:4	3	
if	37:9	59:4	4	(buffer [ 1 ] == 0 x02)
cond	37:13	37:27	5	buffer [ 1 ] == 0 x02
water	37:13	0:0	6	buffer
op	37:19	0:0	6	[
water	37:20	0:0	6	1
op	37:21	0:0	6	]
op	37:23	0:0	6	==
water	37:26	0:0	6	0
water	37:27	0:0	6	x02
stmts	38:4	59:4	5	
water	38:4	0:0	6	{
decl	39:8	39:57	6	int	i_len1
op	39:19	0:0	6	=
call	39:21	39:56	7	__MIN
arg	39:28	39:50	8	strlen(psz_socks_user)
call	39:28	39:49	9	strlen
arg	39:35	39:49	10	psz_socks_user
water	39:35	0:0	11	psz_socks_user
arg	39:52	39:56	8	255
water	39:52	0:0	9	255
decl	40:8	40:59	6	int	i_len2
op	40:19	0:0	6	=
call	40:21	40:58	7	__MIN
arg	40:28	40:52	8	strlen(psz_socks_passwd)
call	40:28	40:51	9	strlen
arg	40:35	40:51	10	psz_socks_passwd
water	40:35	0:0	11	psz_socks_passwd
arg	40:54	40:58	8	255
water	40:54	0:0	9	255
call	41:8	41:66	6	msg_Dbg
arg	41:17	41:22	7	p_obj
water	41:17	0:0	8	p_obj
arg	41:24	41:66	7	"socks: username/password authentication"
water	41:24	0:0	8	"socks: username/password authentication"
water	41:67	0:0	6	;
water	43:8	0:0	6	buffer
op	43:14	0:0	6	[
water	43:15	0:0	6	0
op	43:16	0:0	6	]
op	43:18	0:0	6	=
water	43:20	0:0	6	i_socks_version
water	43:35	0:0	6	;
water	44:8	0:0	6	buffer
op	44:14	0:0	6	[
water	44:15	0:0	6	1
op	44:16	0:0	6	]
op	44:18	0:0	6	=
water	44:20	0:0	6	i_len1
water	44:26	0:0	6	;
call	45:8	45:51	6	memcpy
arg	45:16	45:26	7	&buffer[2]
op	45:16	0:0	8	&
water	45:17	0:0	8	buffer
op	45:23	0:0	8	[
water	45:24	0:0	8	2
op	45:25	0:0	8	]
arg	45:28	45:42	7	psz_socks_user
water	45:28	0:0	8	psz_socks_user
arg	45:44	45:51	7	i_len1
water	45:44	0:0	8	i_len1
water	45:52	0:0	6	;
water	46:8	0:0	6	buffer
op	46:14	0:0	6	[
water	46:15	0:0	6	2
op	46:16	0:0	6	+
water	46:17	0:0	6	i_len1
op	46:23	0:0	6	]
op	46:25	0:0	6	=
water	46:27	0:0	6	i_len2
water	46:33	0:0	6	;
call	47:8	47:62	6	memcpy
arg	47:16	47:35	7	&buffer[2+i_len1+1]
op	47:16	0:0	8	&
water	47:17	0:0	8	buffer
op	47:23	0:0	8	[
water	47:24	0:0	8	2
op	47:25	0:0	8	+
water	47:26	0:0	8	i_len1
op	47:32	0:0	8	+
water	47:33	0:0	8	1
op	47:34	0:0	8	]
arg	47:37	47:53	7	psz_socks_passwd
water	47:37	0:0	8	psz_socks_passwd
arg	47:55	47:62	7	i_len2
water	47:55	0:0	8	i_len2
water	47:63	0:0	6	;
water	48:8	0:0	6	i_len
op	48:14	0:0	6	=
water	48:16	0:0	6	3
op	48:18	0:0	6	+
water	48:20	0:0	6	i_len1
op	48:27	0:0	6	+
water	48:29	0:0	6	i_len2
water	48:35	0:0	6	;
if	49:8	50:31	6	(net_Write (p_obj ,fd ,NULL ,buffer ,i_len ) != i_len)
cond	49:12	49:59	7	net_Write (p_obj ,fd ,NULL ,buffer ,i_len ) != i_len
call	49:12	49:54	8	net_Write
arg	49:23	49:28	9	p_obj
water	49:23	0:0	10	p_obj
arg	49:30	49:32	9	fd
water	49:30	0:0	10	fd
arg	49:34	49:38	9	NULL
water	49:34	0:0	10	NULL
arg	49:40	49:46	9	buffer
water	49:40	0:0	10	buffer
arg	49:48	49:54	9	i_len
water	49:48	0:0	10	i_len
op	49:56	0:0	8	!=
water	49:59	0:0	8	i_len
stmts	50:12	50:31	7	
return	50:12	50:31	8	VLC_EGENERIC
water	50:19	0:0	9	VLC_EGENERIC
if	51:8	52:31	6	(net_Read (p_obj ,fd ,NULL ,buffer ,2 ,true ) != 2)
cond	51:12	51:60	7	net_Read (p_obj ,fd ,NULL ,buffer ,2 ,true ) != 2
call	51:12	51:55	8	net_Read
arg	51:22	51:27	9	p_obj
water	51:22	0:0	10	p_obj
arg	51:29	51:31	9	fd
water	51:29	0:0	10	fd
arg	51:33	51:37	9	NULL
water	51:33	0:0	10	NULL
arg	51:39	51:45	9	buffer
water	51:39	0:0	10	buffer
arg	51:47	51:48	9	2
water	51:47	0:0	10	2
arg	51:50	51:55	9	true
water	51:50	0:0	10	true
op	51:57	0:0	8	!=
water	51:60	0:0	8	2
stmts	52:12	52:31	7	
return	52:12	52:31	8	VLC_EGENERIC
water	52:19	0:0	9	VLC_EGENERIC
call	53:8	53:70	6	msg_Dbg
arg	53:17	53:22	7	p_obj
water	53:17	0:0	8	p_obj
arg	53:24	53:47	7	"socks: v=%d status=%x"
water	53:24	0:0	8	"socks: v=%d status=%x"
arg	53:49	53:58	7	buffer[0]
water	53:49	0:0	8	buffer
op	53:55	0:0	8	[
water	53:56	0:0	8	0
op	53:57	0:0	8	]
arg	53:60	53:70	7	buffer[1]
water	53:60	0:0	8	buffer
op	53:66	0:0	8	[
water	53:67	0:0	8	1
op	53:68	0:0	8	]
water	53:71	0:0	6	;
if	54:8	58:8	6	(buffer [ 1 ] != 0 x00)
cond	54:12	54:26	7	buffer [ 1 ] != 0 x00
water	54:12	0:0	8	buffer
op	54:18	0:0	8	[
water	54:19	0:0	8	1
op	54:20	0:0	8	]
op	54:22	0:0	8	!=
water	54:25	0:0	8	0
water	54:26	0:0	8	x00
stmts	55:8	58:8	7	
water	55:8	0:0	8	{
call	56:12	56:61	8	msg_Err
arg	56:21	56:26	9	p_obj
water	56:21	0:0	10	p_obj
arg	56:28	56:61	9	"socks: authentication rejected"
water	56:28	0:0	10	"socks: authentication rejected"
water	56:62	0:0	8	;
return	57:12	57:31	8	VLC_EGENERIC
water	57:19	0:0	9	VLC_EGENERIC
water	58:8	0:0	8	}
water	59:4	0:0	6	}
else	60:4	68:4	2
stmts	61:4	68:4	3	
water	61:4	0:0	4	{
if	62:8	64:32	4	(b_auth)
cond	62:12	62:12	5	b_auth
water	62:12	0:0	6	b_auth
stmts	63:12	64:32	5	
call	63:12	64:31	6	msg_Err
arg	63:21	63:26	7	p_obj
water	63:21	0:0	8	p_obj
arg	63:28	63:73	7	"socks: unsupported authentication method %x"
water	63:28	0:0	8	"socks: unsupported authentication method %x"
arg	64:21	64:31	7	buffer[0]
water	64:21	0:0	8	buffer
op	64:27	0:0	8	[
water	64:28	0:0	8	0
op	64:29	0:0	8	]
water	64:32	0:0	6	;
else	65:8	66:60	4
stmts	66:12	66:60	5	
call	66:12	66:59	6	msg_Err
arg	66:21	66:26	7	p_obj
water	66:21	0:0	8	p_obj
arg	66:28	66:59	7	"socks: authentication needed"
water	66:28	0:0	8	"socks: authentication needed"
water	66:60	0:0	6	;
return	67:8	67:27	4	VLC_EGENERIC
water	67:15	0:0	5	VLC_EGENERIC
water	68:4	0:0	4	}
return	69:4	69:22	2	VLC_SUCCESS
water	69:11	0:0	3	VLC_SUCCESS
