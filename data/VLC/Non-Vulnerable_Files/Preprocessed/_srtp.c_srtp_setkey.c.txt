func	1:0	44:0	0	int	srtp_setkey
params	2:12	0:0	1	
param	2:13	2:30	2	srtp_session_t *	s
param	2:32	2:47	2	const void *	key
param	2:49	2:62	2	size_t	keylen
param	3:13	3:29	2	const void *	salt
param	3:31	3:45	2	size_t	saltlen
stmnts	0:0	43:12	1	
decl	6:4	6:24	2	gcry_cipher_hd_t	prf
decl	7:4	7:28	2	uint8_t	r[6]
water	7:16	0:0	2	,
decl	7:4	7:28	2	uint8_t	keybuf[20]
if	8:4	9:21	2	(saltlen != 14)
cond	8:8	8:19	3	saltlen != 14
water	8:8	0:0	4	saltlen
op	8:16	0:0	4	!=
water	8:19	0:0	4	14
stmts	9:8	9:21	3	
return	9:8	9:21	4	EINVAL
water	9:15	0:0	5	EINVAL
if	10:4	12:21	2	(gcry_cipher_open (& prf ,GCRY_CIPHER_AES ,GCRY_CIPHER_MODE_CTR ,0 ) ||gcry_cipher_setkey (prf ,key ,keylen ))
cond	10:8	11:44	3	gcry_cipher_open (& prf ,GCRY_CIPHER_AES ,GCRY_CIPHER_MODE_CTR ,0 ) ||gcry_cipher_setkey (prf ,key ,keylen )
call	10:8	10:72	4	gcry_cipher_open
arg	10:26	10:30	5	&prf
op	10:26	0:0	6	&
water	10:27	0:0	6	prf
arg	10:32	10:47	5	GCRY_CIPHER_AES
water	10:32	0:0	6	GCRY_CIPHER_AES
arg	10:49	10:69	5	GCRY_CIPHER_MODE_CTR
water	10:49	0:0	6	GCRY_CIPHER_MODE_CTR
arg	10:71	10:72	5	0
water	10:71	0:0	6	0
op	11:5	0:0	4	||
call	11:8	11:44	4	gcry_cipher_setkey
arg	11:28	11:31	5	prf
water	11:28	0:0	6	prf
arg	11:33	11:36	5	key
water	11:33	0:0	6	key
arg	11:38	11:44	5	keylen
water	11:38	0:0	6	keylen
stmts	12:8	12:21	3	
return	12:8	12:21	4	EINVAL
water	12:15	0:0	5	EINVAL
if	15:4	24:4	2	(s -> kdr != 0)
cond	15:8	15:18	3	s -> kdr != 0
water	15:8	0:0	4	s
op	15:9	0:0	4	->
water	15:11	0:0	4	kdr
op	15:15	0:0	4	!=
water	15:18	0:0	4	0
stmts	16:4	24:4	3	
water	16:4	0:0	4	{
decl	17:8	17:68	4	uint64_t	index
op	17:23	0:0	4	=
water	17:25	0:0	4	(
water	17:26	0:0	4	(
water	17:27	0:0	4	(
water	17:28	0:0	4	uint64_t
water	17:36	0:0	4	)
water	17:37	0:0	4	s
op	17:38	0:0	4	->
water	17:40	0:0	4	rtp_roc
water	17:47	0:0	4	)
op	17:49	0:0	4	<<
water	17:52	0:0	4	16
water	17:54	0:0	4	)
op	17:56	0:0	4	|
water	17:58	0:0	4	s
op	17:59	0:0	4	->
water	17:61	0:0	4	rtp_seq
water	18:8	0:0	4	index
op	18:14	0:0	4	/=
water	18:17	0:0	4	s
op	18:18	0:0	4	->
water	18:20	0:0	4	kdr
water	18:23	0:0	4	;
for	19:8	23:8	4	( int i = sizeof ( r ) - 1 ;i >= 0;i --)
forinit	0:0	19:35	5	 int i = sizeof ( r ) - 1 ;
decl	19:13	19:35	6	int	i
op	19:19	0:0	6	=
op	19:21	0:0	6	sizeof
water	19:28	0:0	6	(
water	19:29	0:0	6	r
water	19:30	0:0	6	)
op	19:32	0:0	6	-
water	19:34	0:0	6	1
cond	19:37	19:42	5	i >= 0
water	19:37	0:0	6	i
op	19:39	0:0	6	>=
water	19:42	0:0	6	0
forexpr	19:45	19:46	5	i --
water	19:45	0:0	6	i
op	19:46	0:0	6	--
stmts	20:8	23:8	5	
water	20:8	0:0	6	{
water	21:12	0:0	6	r
op	21:13	0:0	6	[
water	21:14	0:0	6	i
op	21:15	0:0	6	]
op	21:17	0:0	6	=
water	21:19	0:0	6	index
op	21:25	0:0	6	&
water	21:27	0:0	6	0
water	21:28	0:0	6	xff
water	21:31	0:0	6	;
water	22:12	0:0	6	index
op	22:18	0:0	6	=
water	22:20	0:0	6	index
op	22:26	0:0	6	>>
water	22:29	0:0	6	8
water	22:30	0:0	6	;
water	23:8	0:0	6	}
water	24:4	0:0	4	}
else	25:4	27:33	2
stmts	27:8	27:33	3	
call	27:8	27:32	4	memset
arg	27:16	27:17	5	r
water	27:16	0:0	6	r
arg	27:19	27:20	5	0
water	27:19	0:0	6	0
arg	27:22	27:32	5	sizeof(r)
op	27:22	0:0	6	sizeof
water	27:29	0:0	6	(
water	27:30	0:0	6	r
water	27:31	0:0	6	)
water	27:33	0:0	4	;
if	28:4	33:17	2	(do_derive (prf ,salt ,r ,6 ,SRTP_CRYPT ,keybuf ,16 ) ||gcry_cipher_setkey (s -> rtp . cipher ,keybuf ,16 ) ||do_derive (prf ,salt ,r ,6 ,SRTP_AUTH ,keybuf ,20 ) ||gcry_md_setkey (s -> rtp . mac ,keybuf ,20 ) ||do_derive (prf ,salt ,r ,6 ,SRTP_SALT ,s -> rtp . salt ,14 ))
cond	28:8	32:62	3	do_derive (prf ,salt ,r ,6 ,SRTP_CRYPT ,keybuf ,16 ) ||gcry_cipher_setkey (s -> rtp . cipher ,keybuf ,16 ) ||do_derive (prf ,salt ,r ,6 ,SRTP_AUTH ,keybuf ,20 ) ||gcry_md_setkey (s -> rtp . mac ,keybuf ,20 ) ||do_derive (prf ,salt ,r ,6 ,SRTP_SALT ,s -> rtp . salt ,14 )
call	28:8	28:58	4	do_derive
arg	28:19	28:22	5	prf
water	28:19	0:0	6	prf
arg	28:24	28:28	5	salt
water	28:24	0:0	6	salt
arg	28:30	28:31	5	r
water	28:30	0:0	6	r
arg	28:33	28:34	5	6
water	28:33	0:0	6	6
arg	28:36	28:46	5	SRTP_CRYPT
water	28:36	0:0	6	SRTP_CRYPT
arg	28:48	28:54	5	keybuf
water	28:48	0:0	6	keybuf
arg	28:56	28:58	5	16
water	28:56	0:0	6	16
op	29:5	0:0	4	||
call	29:8	29:53	4	gcry_cipher_setkey
arg	29:28	29:41	5	s->rtp.cipher
water	29:28	0:0	6	s
op	29:29	0:0	6	->
water	29:31	0:0	6	rtp
op	29:34	0:0	6	.
water	29:35	0:0	6	cipher
arg	29:43	29:49	5	keybuf
water	29:43	0:0	6	keybuf
arg	29:51	29:53	5	16
water	29:51	0:0	6	16
op	30:5	0:0	4	||
call	30:8	30:57	4	do_derive
arg	30:19	30:22	5	prf
water	30:19	0:0	6	prf
arg	30:24	30:28	5	salt
water	30:24	0:0	6	salt
arg	30:30	30:31	5	r
water	30:30	0:0	6	r
arg	30:33	30:34	5	6
water	30:33	0:0	6	6
arg	30:36	30:45	5	SRTP_AUTH
water	30:36	0:0	6	SRTP_AUTH
arg	30:47	30:53	5	keybuf
water	30:47	0:0	6	keybuf
arg	30:55	30:57	5	20
water	30:55	0:0	6	20
op	31:5	0:0	4	||
call	31:8	31:46	4	gcry_md_setkey
arg	31:24	31:34	5	s->rtp.mac
water	31:24	0:0	6	s
op	31:25	0:0	6	->
water	31:27	0:0	6	rtp
op	31:30	0:0	6	.
water	31:31	0:0	6	mac
arg	31:36	31:42	5	keybuf
water	31:36	0:0	6	keybuf
arg	31:44	31:46	5	20
water	31:44	0:0	6	20
op	32:5	0:0	4	||
call	32:8	32:62	4	do_derive
arg	32:19	32:22	5	prf
water	32:19	0:0	6	prf
arg	32:24	32:28	5	salt
water	32:24	0:0	6	salt
arg	32:30	32:31	5	r
water	32:30	0:0	6	r
arg	32:33	32:34	5	6
water	32:33	0:0	6	6
arg	32:36	32:45	5	SRTP_SALT
water	32:36	0:0	6	SRTP_SALT
arg	32:47	32:58	5	s->rtp.salt
water	32:47	0:0	6	s
op	32:48	0:0	6	->
water	32:50	0:0	6	rtp
op	32:53	0:0	6	.
water	32:54	0:0	6	salt
arg	32:60	32:62	5	14
water	32:60	0:0	6	14
stmts	33:8	33:17	3	
return	33:8	33:17	4	-1
op	33:15	0:0	5	-
water	33:16	0:0	5	1
call	35:4	35:54	2	memcpy
arg	35:12	35:13	3	r
water	35:12	0:0	4	r
arg	35:15	35:51	3	&(uint32_t){htonl(s->rtcp_index)}
op	35:15	0:0	4	&
water	35:16	0:0	4	(
water	35:17	0:0	4	uint32_t
water	35:25	0:0	4	)
water	35:26	0:0	4	{
call	35:28	35:48	4	htonl
arg	35:35	35:48	5	s->rtcp_index
water	35:35	0:0	6	s
op	35:36	0:0	6	->
water	35:38	0:0	6	rtcp_index
water	35:50	0:0	4	}
arg	35:53	35:54	3	4
water	35:53	0:0	4	4
water	35:55	0:0	2	;
if	36:4	41:17	2	(do_derive (prf ,salt ,r ,4 ,SRTCP_CRYPT ,keybuf ,16 ) ||gcry_cipher_setkey (s -> rtcp . cipher ,keybuf ,16 ) ||do_derive (prf ,salt ,r ,4 ,SRTCP_AUTH ,keybuf ,20 ) ||gcry_md_setkey (s -> rtcp . mac ,keybuf ,20 ) ||do_derive (prf ,salt ,r ,4 ,SRTCP_SALT ,s -> rtcp . salt ,14 ))
cond	36:8	40:64	3	do_derive (prf ,salt ,r ,4 ,SRTCP_CRYPT ,keybuf ,16 ) ||gcry_cipher_setkey (s -> rtcp . cipher ,keybuf ,16 ) ||do_derive (prf ,salt ,r ,4 ,SRTCP_AUTH ,keybuf ,20 ) ||gcry_md_setkey (s -> rtcp . mac ,keybuf ,20 ) ||do_derive (prf ,salt ,r ,4 ,SRTCP_SALT ,s -> rtcp . salt ,14 )
call	36:8	36:59	4	do_derive
arg	36:19	36:22	5	prf
water	36:19	0:0	6	prf
arg	36:24	36:28	5	salt
water	36:24	0:0	6	salt
arg	36:30	36:31	5	r
water	36:30	0:0	6	r
arg	36:33	36:34	5	4
water	36:33	0:0	6	4
arg	36:36	36:47	5	SRTCP_CRYPT
water	36:36	0:0	6	SRTCP_CRYPT
arg	36:49	36:55	5	keybuf
water	36:49	0:0	6	keybuf
arg	36:57	36:59	5	16
water	36:57	0:0	6	16
op	37:5	0:0	4	||
call	37:8	37:54	4	gcry_cipher_setkey
arg	37:28	37:42	5	s->rtcp.cipher
water	37:28	0:0	6	s
op	37:29	0:0	6	->
water	37:31	0:0	6	rtcp
op	37:35	0:0	6	.
water	37:36	0:0	6	cipher
arg	37:44	37:50	5	keybuf
water	37:44	0:0	6	keybuf
arg	37:52	37:54	5	16
water	37:52	0:0	6	16
op	38:5	0:0	4	||
call	38:8	38:58	4	do_derive
arg	38:19	38:22	5	prf
water	38:19	0:0	6	prf
arg	38:24	38:28	5	salt
water	38:24	0:0	6	salt
arg	38:30	38:31	5	r
water	38:30	0:0	6	r
arg	38:33	38:34	5	4
water	38:33	0:0	6	4
arg	38:36	38:46	5	SRTCP_AUTH
water	38:36	0:0	6	SRTCP_AUTH
arg	38:48	38:54	5	keybuf
water	38:48	0:0	6	keybuf
arg	38:56	38:58	5	20
water	38:56	0:0	6	20
op	39:5	0:0	4	||
call	39:8	39:47	4	gcry_md_setkey
arg	39:24	39:35	5	s->rtcp.mac
water	39:24	0:0	6	s
op	39:25	0:0	6	->
water	39:27	0:0	6	rtcp
op	39:31	0:0	6	.
water	39:32	0:0	6	mac
arg	39:37	39:43	5	keybuf
water	39:37	0:0	6	keybuf
arg	39:45	39:47	5	20
water	39:45	0:0	6	20
op	40:5	0:0	4	||
call	40:8	40:64	4	do_derive
arg	40:19	40:22	5	prf
water	40:19	0:0	6	prf
arg	40:24	40:28	5	salt
water	40:24	0:0	6	salt
arg	40:30	40:31	5	r
water	40:30	0:0	6	r
arg	40:33	40:34	5	4
water	40:33	0:0	6	4
arg	40:36	40:46	5	SRTCP_SALT
water	40:36	0:0	6	SRTCP_SALT
arg	40:48	40:60	5	s->rtcp.salt
water	40:48	0:0	6	s
op	40:49	0:0	6	->
water	40:51	0:0	6	rtcp
op	40:55	0:0	6	.
water	40:56	0:0	6	salt
arg	40:62	40:64	5	14
water	40:62	0:0	6	14
stmts	41:8	41:17	3	
return	41:8	41:17	4	-1
op	41:15	0:0	5	-
water	41:16	0:0	5	1
water	42:4	0:0	2	(
water	42:5	0:0	2	void
water	42:9	0:0	2	)
call	42:10	42:32	2	gcry_cipher_close
arg	42:29	42:32	3	prf
water	42:29	0:0	4	prf
water	42:33	0:0	2	;
return	43:4	43:12	2	0
water	43:11	0:0	3	0
