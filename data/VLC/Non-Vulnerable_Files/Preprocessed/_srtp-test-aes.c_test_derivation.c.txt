func	2:0	49:0	0	static void	test_derivation
params	2:28	0:0	1	
param	2:29	2:33	2	void
stmnts	4:4	48:27	1	
water	4:4	0:0	2	static
water	4:11	0:0	2	const
water	4:17	0:0	2	uint8_t
water	4:25	0:0	2	key
op	4:28	0:0	2	[
water	4:29	0:0	2	16
op	4:31	0:0	2	]
op	4:33	0:0	2	=
water	5:8	0:0	2	"\xE1\xF9\x7A\x0D\x3E\x01\x8B\xE0\xD6\x4F\xA3\x2C\x06\xDE\x41\x39"
water	5:74	0:0	2	;
water	6:4	0:0	2	static
water	6:11	0:0	2	const
water	6:17	0:0	2	uint8_t
water	6:25	0:0	2	salt
op	6:29	0:0	2	[
water	6:30	0:0	2	14
op	6:32	0:0	2	]
op	6:34	0:0	2	=
water	7:8	0:0	2	"\x0E\xC6\x75\xAD\x49\x8A\xFE\xEB\xB6\x96\x0B\x3A\xAB\xE6"
water	7:66	0:0	2	;
water	8:4	0:0	2	static
water	8:11	0:0	2	const
water	8:17	0:0	2	uint8_t
water	8:25	0:0	2	good_cipher
op	8:36	0:0	2	[
water	8:37	0:0	2	16
op	8:39	0:0	2	]
op	8:41	0:0	2	=
water	9:8	0:0	2	"\xC6\x1E\x7A\x93\x74\x4F\x39\xEE\x10\x73\x4A\xFE\x3F\xF7\xA0\x87"
water	9:74	0:0	2	;
water	10:4	0:0	2	static
water	10:11	0:0	2	const
water	10:17	0:0	2	uint8_t
water	10:25	0:0	2	good_salt
op	10:34	0:0	2	[
water	10:35	0:0	2	14
op	10:37	0:0	2	]
op	10:39	0:0	2	=
water	11:8	0:0	2	"\x30\xCB\xBC\x08\x86\x3D\x8C\x85\xD4\x9D\xB3\x4A\x9A\xE1"
water	11:66	0:0	2	;
water	12:4	0:0	2	static
water	12:11	0:0	2	const
water	12:17	0:0	2	uint8_t
water	12:25	0:0	2	good_auth
op	12:34	0:0	2	[
water	12:35	0:0	2	94
op	12:37	0:0	2	]
op	12:39	0:0	2	=
water	13:8	0:0	2	"\xCE\xBE\x32\x1F\x6F\xF7\x71\x6B\x6F\xD4\xAB\x49\xAF\x25\x6A\x15"
water	14:8	0:0	2	"\x6D\x38\xBA\xA4\x8F\x0A\x0A\xCF\x3C\x34\xE2\x35\x9E\x6C\xDB\xCE"
water	15:8	0:0	2	"\xE0\x49\x64\x6C\x43\xD9\x32\x7A\xD1\x75\x57\x8E\xF7\x22\x70\x98"
water	16:8	0:0	2	"\x63\x71\xC1\x0C\x9A\x36\x9A\xC2\xF9\x4A\x8C\x5F\xBC\xDD\xDC\x25"
water	17:8	0:0	2	"\x6D\x6E\x91\x9A\x48\xB6\x10\xEF\x17\xC2\x04\x1E\x47\x40\x35\x76"
water	18:8	0:0	2	"\x6B\x68\x64\x2C\x59\xBB\xFC\x2F\x34\xDB\x60\xDB\xDF\xB2"
water	18:66	0:0	2	;
water	19:4	0:0	2	static
water	19:11	0:0	2	const
water	19:17	0:0	2	uint8_t
water	19:25	0:0	2	r
op	19:26	0:0	2	[
water	19:27	0:0	2	6
op	19:28	0:0	2	]
op	19:30	0:0	2	=
water	19:32	0:0	2	{
water	19:34	0:0	2	0
water	19:35	0:0	2	,
water	19:37	0:0	2	0
water	19:38	0:0	2	,
water	19:40	0:0	2	0
water	19:41	0:0	2	,
water	19:43	0:0	2	0
water	19:44	0:0	2	,
water	19:46	0:0	2	0
water	19:47	0:0	2	,
water	19:49	0:0	2	0
water	19:51	0:0	2	}
water	19:52	0:0	2	;
decl	20:4	20:24	2	gcry_cipher_hd_t	prf
decl	21:4	21:19	2	uint8_t	out[94]
call	22:4	22:41	2	puts
arg	22:10	22:41	3	"AES-CM key derivation test..."
water	22:10	0:0	4	"AES-CM key derivation test..."
water	22:42	0:0	2	;
call	23:4	23:28	2	printf
arg	23:12	23:28	3	" master key:  "
water	23:12	0:0	4	" master key:  "
water	23:29	0:0	2	;
call	24:4	24:31	2	printhex
arg	24:14	24:17	3	key
water	24:14	0:0	4	key
arg	24:19	24:31	3	sizeof(key)
op	24:19	0:0	4	sizeof
water	24:26	0:0	4	(
water	24:27	0:0	4	key
water	24:30	0:0	4	)
water	24:32	0:0	2	;
call	25:4	25:28	2	printf
arg	25:12	25:28	3	" master salt: "
water	25:12	0:0	4	" master salt: "
water	25:29	0:0	2	;
call	26:4	26:33	2	printhex
arg	26:14	26:18	3	salt
water	26:14	0:0	4	salt
arg	26:20	26:33	3	sizeof(salt)
op	26:20	0:0	4	sizeof
water	26:27	0:0	4	(
water	26:28	0:0	4	salt
water	26:32	0:0	4	)
water	26:34	0:0	2	;
if	27:4	29:36	2	(gcry_cipher_open (& prf ,GCRY_CIPHER_AES ,GCRY_CIPHER_MODE_CTR ,0 ) ||gcry_cipher_setkey (prf ,key ,sizeof ( key ) ))
cond	27:8	28:50	3	gcry_cipher_open (& prf ,GCRY_CIPHER_AES ,GCRY_CIPHER_MODE_CTR ,0 ) ||gcry_cipher_setkey (prf ,key ,sizeof ( key ) )
call	27:8	27:72	4	gcry_cipher_open
arg	27:26	27:30	5	&prf
op	27:26	0:0	6	&
water	27:27	0:0	6	prf
arg	27:32	27:47	5	GCRY_CIPHER_AES
water	27:32	0:0	6	GCRY_CIPHER_AES
arg	27:49	27:69	5	GCRY_CIPHER_MODE_CTR
water	27:49	0:0	6	GCRY_CIPHER_MODE_CTR
arg	27:71	27:72	5	0
water	27:71	0:0	6	0
op	28:5	0:0	4	||
call	28:8	28:50	4	gcry_cipher_setkey
arg	28:28	28:31	5	prf
water	28:28	0:0	6	prf
arg	28:33	28:36	5	key
water	28:33	0:0	6	key
arg	28:38	28:50	5	sizeof(key)
op	28:38	0:0	6	sizeof
water	28:45	0:0	6	(
water	28:46	0:0	6	key
water	28:49	0:0	6	)
stmts	29:8	29:36	3	
call	29:8	29:35	4	fatal
arg	29:15	29:35	5	"Internal PRF error"
water	29:15	0:0	6	"Internal PRF error"
water	29:36	0:0	4	;
if	30:4	31:50	2	(do_derive (prf ,salt ,r ,sizeof ( r ) ,SRTP_CRYPT ,out ,16 ))
cond	30:8	30:64	3	do_derive (prf ,salt ,r ,sizeof ( r ) ,SRTP_CRYPT ,out ,16 )
call	30:8	30:64	4	do_derive
arg	30:19	30:22	5	prf
water	30:19	0:0	6	prf
arg	30:24	30:28	5	salt
water	30:24	0:0	6	salt
arg	30:30	30:31	5	r
water	30:30	0:0	6	r
arg	30:33	30:43	5	sizeof(r)
op	30:33	0:0	6	sizeof
water	30:40	0:0	6	(
water	30:41	0:0	6	r
water	30:42	0:0	6	)
arg	30:45	30:55	5	SRTP_CRYPT
water	30:45	0:0	6	SRTP_CRYPT
arg	30:57	30:60	5	out
water	30:57	0:0	6	out
arg	30:62	30:64	5	16
water	30:62	0:0	6	16
stmts	31:8	31:50	3	
call	31:8	31:49	4	fatal
arg	31:15	31:49	5	"Internal cipher derivation error"
water	31:15	0:0	6	"Internal cipher derivation error"
water	31:50	0:0	4	;
call	32:4	32:28	2	printf
arg	32:12	32:28	3	" cipher key:  "
water	32:12	0:0	4	" cipher key:  "
water	32:29	0:0	2	;
call	33:4	33:21	2	printhex
arg	33:14	33:17	3	out
water	33:14	0:0	4	out
arg	33:19	33:21	3	16
water	33:19	0:0	4	16
water	33:22	0:0	2	;
if	34:4	35:29	2	(memcmp (out ,good_cipher ,16 ))
cond	34:8	34:36	3	memcmp (out ,good_cipher ,16 )
call	34:8	34:36	4	memcmp
arg	34:16	34:19	5	out
water	34:16	0:0	6	out
arg	34:21	34:32	5	good_cipher
water	34:21	0:0	6	good_cipher
arg	34:34	34:36	5	16
water	34:34	0:0	6	16
stmts	35:8	35:29	3	
call	35:8	35:28	4	fatal
arg	35:15	35:28	5	"Test failed"
water	35:15	0:0	6	"Test failed"
water	35:29	0:0	4	;
if	36:4	37:48	2	(do_derive (prf ,salt ,r ,sizeof ( r ) ,SRTP_SALT ,out ,14 ))
cond	36:8	36:63	3	do_derive (prf ,salt ,r ,sizeof ( r ) ,SRTP_SALT ,out ,14 )
call	36:8	36:63	4	do_derive
arg	36:19	36:22	5	prf
water	36:19	0:0	6	prf
arg	36:24	36:28	5	salt
water	36:24	0:0	6	salt
arg	36:30	36:31	5	r
water	36:30	0:0	6	r
arg	36:33	36:43	5	sizeof(r)
op	36:33	0:0	6	sizeof
water	36:40	0:0	6	(
water	36:41	0:0	6	r
water	36:42	0:0	6	)
arg	36:45	36:54	5	SRTP_SALT
water	36:45	0:0	6	SRTP_SALT
arg	36:56	36:59	5	out
water	36:56	0:0	6	out
arg	36:61	36:63	5	14
water	36:61	0:0	6	14
stmts	37:8	37:48	3	
call	37:8	37:47	4	fatal
arg	37:15	37:47	5	"Internal salt derivation error"
water	37:15	0:0	6	"Internal salt derivation error"
water	37:48	0:0	4	;
call	38:4	38:28	2	printf
arg	38:12	38:28	3	" cipher salt: "
water	38:12	0:0	4	" cipher salt: "
water	38:29	0:0	2	;
call	39:4	39:21	2	printhex
arg	39:14	39:17	3	out
water	39:14	0:0	4	out
arg	39:19	39:21	3	14
water	39:19	0:0	4	14
water	39:22	0:0	2	;
if	40:4	41:29	2	(memcmp (out ,good_salt ,14 ))
cond	40:8	40:34	3	memcmp (out ,good_salt ,14 )
call	40:8	40:34	4	memcmp
arg	40:16	40:19	5	out
water	40:16	0:0	6	out
arg	40:21	40:30	5	good_salt
water	40:21	0:0	6	good_salt
arg	40:32	40:34	5	14
water	40:32	0:0	6	14
stmts	41:8	41:29	3	
call	41:8	41:28	4	fatal
arg	41:15	41:28	5	"Test failed"
water	41:15	0:0	6	"Test failed"
water	41:29	0:0	4	;
if	42:4	43:52	2	(do_derive (prf ,salt ,r ,sizeof ( r ) ,SRTP_AUTH ,out ,94 ))
cond	42:8	42:63	3	do_derive (prf ,salt ,r ,sizeof ( r ) ,SRTP_AUTH ,out ,94 )
call	42:8	42:63	4	do_derive
arg	42:19	42:22	5	prf
water	42:19	0:0	6	prf
arg	42:24	42:28	5	salt
water	42:24	0:0	6	salt
arg	42:30	42:31	5	r
water	42:30	0:0	6	r
arg	42:33	42:43	5	sizeof(r)
op	42:33	0:0	6	sizeof
water	42:40	0:0	6	(
water	42:41	0:0	6	r
water	42:42	0:0	6	)
arg	42:45	42:54	5	SRTP_AUTH
water	42:45	0:0	6	SRTP_AUTH
arg	42:56	42:59	5	out
water	42:56	0:0	6	out
arg	42:61	42:63	5	94
water	42:61	0:0	6	94
stmts	43:8	43:52	3	
call	43:8	43:51	4	fatal
arg	43:15	43:51	5	"Internal auth key derivation error"
water	43:15	0:0	6	"Internal auth key derivation error"
water	43:52	0:0	4	;
call	44:4	44:28	2	printf
arg	44:12	44:28	3	" auth key:    "
water	44:12	0:0	4	" auth key:    "
water	44:29	0:0	2	;
call	45:4	45:21	2	printhex
arg	45:14	45:17	3	out
water	45:14	0:0	4	out
arg	45:19	45:21	3	94
water	45:19	0:0	4	94
water	45:22	0:0	2	;
if	46:4	47:29	2	(memcmp (out ,good_auth ,94 ))
cond	46:8	46:34	3	memcmp (out ,good_auth ,94 )
call	46:8	46:34	4	memcmp
arg	46:16	46:19	5	out
water	46:16	0:0	6	out
arg	46:21	46:30	5	good_auth
water	46:21	0:0	6	good_auth
arg	46:32	46:34	5	94
water	46:32	0:0	6	94
stmts	47:8	47:29	3	
call	47:8	47:28	4	fatal
arg	47:15	47:28	5	"Test failed"
water	47:15	0:0	6	"Test failed"
water	47:29	0:0	4	;
call	48:4	48:26	2	gcry_cipher_close
arg	48:23	48:26	3	prf
water	48:23	0:0	4	prf
water	48:27	0:0	2	;
