func	2:0	38:0	0	static int	gnutls_SessionOpen
params	2:30	0:0	1	
param	2:31	2:51	2	vlc_tls_creds_t *	crd
param	2:53	2:71	2	vlc_tls_t *	session
param	3:31	3:39	2	int	type
param	3:41	3:47	2	int	fd
stmnts	0:0	37:23	1	
decl	5:4	5:56	2	vlc_tls_sys_t	*sys
op	5:23	0:0	2	=
call	5:25	5:55	3	malloc
arg	5:33	5:55	4	sizeof(*session->sys)
op	5:33	0:0	5	sizeof
water	5:40	0:0	5	(
op	5:41	0:0	5	*
water	5:42	0:0	5	session
op	5:49	0:0	5	->
water	5:51	0:0	5	sys
water	5:54	0:0	5	)
if	6:4	7:25	2	(unlikely (sys == NULL ))
cond	6:8	6:28	3	unlikely (sys == NULL )
call	6:8	6:28	4	unlikely
arg	6:17	6:28	5	sys==NULL
water	6:17	0:0	6	sys
op	6:21	0:0	6	==
water	6:24	0:0	6	NULL
stmts	7:8	7:25	3	
return	7:8	7:25	4	VLC_ENOMEM
water	7:15	0:0	5	VLC_ENOMEM
water	8:4	0:0	2	session
op	8:11	0:0	2	->
water	8:13	0:0	2	sys
op	8:17	0:0	2	=
water	8:19	0:0	2	sys
water	8:22	0:0	2	;
water	9:4	0:0	2	session
op	9:11	0:0	2	->
water	9:13	0:0	2	sock
op	9:17	0:0	2	.
water	9:18	0:0	2	p_sys
op	9:24	0:0	2	=
water	9:26	0:0	2	session
water	9:33	0:0	2	;
water	10:4	0:0	2	session
op	10:11	0:0	2	->
water	10:13	0:0	2	sock
op	10:17	0:0	2	.
water	10:18	0:0	2	pf_send
op	10:26	0:0	2	=
water	10:28	0:0	2	gnutls_Send
water	10:39	0:0	2	;
water	11:4	0:0	2	session
op	11:11	0:0	2	->
water	11:13	0:0	2	sock
op	11:17	0:0	2	.
water	11:18	0:0	2	pf_recv
op	11:26	0:0	2	=
water	11:28	0:0	2	gnutls_Recv
water	11:39	0:0	2	;
water	12:4	0:0	2	session
op	12:11	0:0	2	->
water	12:13	0:0	2	handshake
op	12:23	0:0	2	=
water	12:25	0:0	2	crd
op	12:28	0:0	2	->
water	12:30	0:0	2	sys
op	12:33	0:0	2	->
water	12:35	0:0	2	handshake
water	12:44	0:0	2	;
water	13:4	0:0	2	sys
op	13:7	0:0	2	->
water	13:9	0:0	2	handshaked
op	13:20	0:0	2	=
water	13:22	0:0	2	false
water	13:27	0:0	2	;
decl	14:4	14:47	2	int	val
op	14:12	0:0	2	=
call	14:14	14:46	3	gnutls_init
arg	14:27	14:40	4	&sys->session
op	14:27	0:0	5	&
water	14:28	0:0	5	sys
op	14:31	0:0	5	->
water	14:33	0:0	5	session
arg	14:42	14:46	4	type
water	14:42	0:0	5	type
if	15:4	21:4	2	(val != 0)
cond	15:8	15:15	3	val != 0
water	15:8	0:0	4	val
op	15:12	0:0	4	!=
water	15:15	0:0	4	0
stmts	16:4	21:4	3	
water	16:4	0:0	4	{
call	17:8	18:38	4	msg_Err
arg	17:17	17:24	5	session
water	17:17	0:0	6	session
arg	17:26	17:61	5	"cannot initialize TLS session: %s"
water	17:26	0:0	6	"cannot initialize TLS session: %s"
arg	18:17	18:38	5	gnutls_strerror(val)
call	18:17	18:37	6	gnutls_strerror
arg	18:34	18:37	7	val
water	18:34	0:0	8	val
water	18:39	0:0	4	;
call	19:8	19:17	4	free
arg	19:14	19:17	5	sys
water	19:14	0:0	6	sys
water	19:18	0:0	4	;
return	20:8	20:27	4	VLC_EGENERIC
water	20:15	0:0	5	VLC_EGENERIC
water	21:4	0:0	4	}
if	22:4	23:18	2	(gnutls_SessionPrioritize (VLC_OBJECT (crd ) ,sys -> session ))
cond	22:8	22:64	3	gnutls_SessionPrioritize (VLC_OBJECT (crd ) ,sys -> session )
call	22:8	22:64	4	gnutls_SessionPrioritize
arg	22:34	22:50	5	VLC_OBJECT(crd)
call	22:34	22:49	6	VLC_OBJECT
arg	22:46	22:49	7	crd
water	22:46	0:0	8	crd
arg	22:52	22:64	5	sys->session
water	22:52	0:0	6	sys
op	22:55	0:0	6	->
water	22:57	0:0	6	session
stmts	23:8	23:18	3	
goto	23:8	23:18	4	error
water	23:13	0:0	5	error
water	24:4	0:0	2	val
op	24:8	0:0	2	=
call	24:10	25:53	2	gnutls_credentials_set
arg	24:34	24:46	3	sys->session
water	24:34	0:0	4	sys
op	24:37	0:0	4	->
water	24:39	0:0	4	session
arg	24:48	24:70	3	GNUTLS_CRD_CERTIFICATE
water	24:48	0:0	4	GNUTLS_CRD_CERTIFICATE
arg	25:34	25:53	3	crd->sys->x509_cred
water	25:34	0:0	4	crd
op	25:37	0:0	4	->
water	25:39	0:0	4	sys
op	25:42	0:0	4	->
water	25:44	0:0	4	x509_cred
water	25:54	0:0	2	;
if	26:4	31:4	2	(val < 0)
cond	26:8	26:14	3	val < 0
water	26:8	0:0	4	val
op	26:12	0:0	4	<
water	26:14	0:0	4	0
stmts	27:4	31:4	3	
water	27:4	0:0	4	{
call	28:8	29:38	4	msg_Err
arg	28:17	28:24	5	session
water	28:17	0:0	6	session
arg	28:26	28:66	5	"cannot set TLS session credentials: %s"
water	28:26	0:0	6	"cannot set TLS session credentials: %s"
arg	29:17	29:38	5	gnutls_strerror(val)
call	29:17	29:37	6	gnutls_strerror
arg	29:34	29:37	7	val
water	29:34	0:0	8	val
water	29:39	0:0	4	;
goto	30:8	30:18	4	error
water	30:13	0:0	5	error
water	31:4	0:0	4	}
call	32:4	33:66	2	gnutls_transport_set_ptr
arg	32:30	32:42	3	sys->session
water	32:30	0:0	4	sys
op	32:33	0:0	4	->
water	32:35	0:0	4	session
arg	33:30	33:66	3	(gnutls_transport_ptr_t)(intptr_t)fd
call	33:30	33:63	4	(gnutls_transport_ptr_t)
arg	33:55	33:63	5	intptr_t
water	33:55	0:0	6	intptr_t
water	33:64	0:0	4	fd
water	33:67	0:0	2	;
return	34:4	34:22	2	VLC_SUCCESS
water	34:11	0:0	3	VLC_SUCCESS
label	35:0	35:5	2	error :
call	36:4	36:37	2	gnutls_SessionClose
arg	36:25	36:28	3	crd
water	36:25	0:0	4	crd
arg	36:30	36:37	3	session
water	36:30	0:0	4	session
water	36:38	0:0	2	;
return	37:4	37:23	2	VLC_EGENERIC
water	37:11	0:0	3	VLC_EGENERIC
