func	2:0	38:0	0	static void	ConditionalAccessHandle
params	2:35	0:0	1	
param	2:37	2:50	2	cam_t *	p_cam
param	2:52	2:68	2	int	i_session_id
param	3:37	3:52	2	uint8_t *	p_apdu
param	3:54	3:65	2	int	i_size
stmnts	0:0	37:4	1	
decl	5:4	6:65	2	system_ids_t	*p_ids
op	5:24	0:0	2	=
water	6:8	0:0	2	(
water	6:9	0:0	2	system_ids_t
op	6:22	0:0	2	*
water	6:23	0:0	2	)
water	6:24	0:0	2	p_cam
op	6:29	0:0	2	->
water	6:31	0:0	2	p_sessions
op	6:41	0:0	2	[
water	6:42	0:0	2	i_session_id
op	6:55	0:0	2	-
water	6:57	0:0	2	1
op	6:58	0:0	2	]
op	6:59	0:0	2	.
water	6:60	0:0	2	p_sys
decl	7:4	7:44	2	int	i_tag
op	7:14	0:0	2	=
call	7:16	7:43	3	APDUGetTag
arg	7:28	7:34	4	p_apdu
water	7:28	0:0	5	p_apdu
arg	7:36	7:43	4	i_size
water	7:36	0:0	5	i_size
switch	8:4	37:4	2	(i_tag)
cond	8:13	8:13	3	i_tag
water	8:13	0:0	4	i_tag
stmts	9:4	37:4	3	
water	9:4	0:0	4	{
label	10:4	10:20	4	case AOT_CA_INFO :
water	11:4	0:0	4	{
decl	12:8	12:13	4	int	i
decl	13:8	13:17	4	int	l
op	13:14	0:0	4	=
water	13:16	0:0	4	0
decl	14:8	14:48	4	uint8_t	*d
op	14:19	0:0	4	=
call	14:21	14:47	5	APDUGetLength
arg	14:36	14:42	6	p_apdu
water	14:36	0:0	7	p_apdu
arg	14:44	14:47	6	&l
op	14:44	0:0	7	&
water	14:45	0:0	7	l
call	15:8	15:76	4	msg_Dbg
arg	15:17	15:27	5	p_cam->obj
water	15:17	0:0	6	p_cam
op	15:22	0:0	6	->
water	15:24	0:0	6	obj
arg	15:29	15:76	5	"CA system IDs supported by the application :"
water	15:29	0:0	6	"CA system IDs supported by the application :"
water	15:77	0:0	4	;
for	16:8	21:8	4	(i = 0 ;i < l / 2;i ++)
forinit	16:14	16:19	5	i = 0 ;
water	16:14	0:0	6	i
op	16:16	0:0	6	=
water	16:18	0:0	6	0
water	16:19	0:0	6	;
cond	16:21	16:29	5	i < l / 2
water	16:21	0:0	6	i
op	16:23	0:0	6	<
water	16:25	0:0	6	l
op	16:27	0:0	6	/
water	16:29	0:0	6	2
forexpr	16:32	16:33	5	i ++
water	16:32	0:0	6	i
op	16:33	0:0	6	++
stmts	17:8	21:8	5	
water	17:8	0:0	6	{
water	18:12	0:0	6	p_ids
op	18:17	0:0	6	->
water	18:19	0:0	6	pi_system_ids
op	18:32	0:0	6	[
water	18:33	0:0	6	i
op	18:34	0:0	6	]
op	18:36	0:0	6	=
water	18:38	0:0	6	(
water	18:39	0:0	6	(
water	18:40	0:0	6	uint16_t
water	18:48	0:0	6	)
water	18:49	0:0	6	d
op	18:50	0:0	6	[
water	18:51	0:0	6	0
op	18:52	0:0	6	]
op	18:54	0:0	6	<<
water	18:57	0:0	6	8
water	18:58	0:0	6	)
op	18:60	0:0	6	|
water	18:62	0:0	6	d
op	18:63	0:0	6	[
water	18:64	0:0	6	1
op	18:65	0:0	6	]
water	18:66	0:0	6	;
water	19:12	0:0	6	d
op	19:14	0:0	6	+=
water	19:17	0:0	6	2
water	19:18	0:0	6	;
call	20:12	20:67	6	msg_Dbg
arg	20:21	20:31	7	p_cam->obj
water	20:21	0:0	8	p_cam
op	20:26	0:0	8	->
water	20:28	0:0	8	obj
arg	20:33	20:41	7	"- 0x%x"
water	20:33	0:0	8	"- 0x%x"
arg	20:43	20:67	7	p_ids->pi_system_ids[i]
water	20:43	0:0	8	p_ids
op	20:48	0:0	8	->
water	20:50	0:0	8	pi_system_ids
op	20:63	0:0	8	[
water	20:64	0:0	8	i
op	20:65	0:0	8	]
water	20:68	0:0	6	;
water	21:8	0:0	6	}
water	22:8	0:0	4	p_ids
op	22:13	0:0	4	->
water	22:15	0:0	4	pi_system_ids
op	22:28	0:0	4	[
water	22:29	0:0	4	i
op	22:30	0:0	4	]
op	22:32	0:0	4	=
water	22:34	0:0	4	0
water	22:35	0:0	4	;
for	23:8	30:8	4	(i = 0 ;i < MAX_PROGRAMS;i ++)
forinit	23:14	23:19	5	i = 0 ;
water	23:14	0:0	6	i
op	23:16	0:0	6	=
water	23:18	0:0	6	0
water	23:19	0:0	6	;
cond	23:21	23:25	5	i < MAX_PROGRAMS
water	23:21	0:0	6	i
op	23:23	0:0	6	<
water	23:25	0:0	6	MAX_PROGRAMS
forexpr	23:39	23:40	5	i ++
water	23:39	0:0	6	i
op	23:40	0:0	6	++
stmts	24:8	30:8	5	
water	24:8	0:0	6	{
if	25:12	29:12	6	(p_cam -> pp_selected_programs [ i ] != NULL)
cond	25:17	25:51	7	p_cam -> pp_selected_programs [ i ] != NULL
water	25:17	0:0	8	p_cam
op	25:22	0:0	8	->
water	25:24	0:0	8	pp_selected_programs
op	25:44	0:0	8	[
water	25:45	0:0	8	i
op	25:46	0:0	8	]
op	25:48	0:0	8	!=
water	25:51	0:0	8	NULL
stmts	26:12	29:12	7	
water	26:12	0:0	8	{
call	27:16	28:57	8	CAPMTAdd
arg	27:26	27:31	9	p_cam
water	27:26	0:0	10	p_cam
arg	27:33	27:45	9	i_session_id
water	27:33	0:0	10	i_session_id
arg	28:26	28:57	9	p_cam->pp_selected_programs[i]
water	28:26	0:0	10	p_cam
op	28:31	0:0	10	->
water	28:33	0:0	10	pp_selected_programs
op	28:53	0:0	10	[
water	28:54	0:0	10	i
op	28:55	0:0	10	]
water	28:58	0:0	8	;
water	29:12	0:0	8	}
water	30:8	0:0	6	}
break	31:8	31:13	4	
water	32:4	0:0	4	}
label	33:4	33:11	4	default :
call	34:8	36:23	4	msg_Err
arg	34:17	34:27	5	p_cam->obj
water	34:17	0:0	6	p_cam
op	34:22	0:0	6	->
water	34:24	0:0	6	obj
arg	35:17	35:67	5	"unexpected tag in ConditionalAccessHandle (0x%x)"
water	35:17	0:0	6	"unexpected tag in ConditionalAccessHandle (0x%x)"
arg	36:17	36:23	5	i_tag
water	36:17	0:0	6	i_tag
water	36:24	0:0	4	;
water	37:4	0:0	4	}
