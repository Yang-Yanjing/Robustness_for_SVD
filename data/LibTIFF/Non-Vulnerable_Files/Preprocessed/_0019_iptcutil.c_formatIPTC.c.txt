func	1:0	120:0	0	int	formatIPTC
params	1:14	0:0	1	
param	1:15	1:26	2	FILE *	ifile
param	1:28	1:39	2	FILE *	ofile
stmnts	0:0	119:18	1	
decl	3:2	5:13	2	unsigned int	foundiptc
water	4:13	0:0	2	,
decl	3:2	5:13	2	unsigned int	tagsfound
decl	6:2	8:8	2	char	*readable
water	7:13	0:0	2	,
decl	6:2	8:8	2	char	*str
decl	9:2	11:10	2	long	tagindx
water	10:11	0:0	2	,
decl	9:2	11:10	2	long	taglen
decl	12:2	14:46	2	int	i
water	13:5	0:0	2	,
decl	12:2	14:46	2	int	tagcount
op	14:13	0:0	2	=
op	14:15	0:0	2	sizeof
water	14:21	0:0	2	(
water	14:22	0:0	2	tags
water	14:26	0:0	2	)
op	14:28	0:0	2	/
op	14:30	0:0	2	sizeof
water	14:36	0:0	2	(
water	14:37	0:0	2	tag_spec
water	14:45	0:0	2	)
decl	15:2	18:10	2	int	c
water	16:5	0:0	2	,
decl	15:2	18:10	2	int	dataset
water	17:11	0:0	2	,
decl	15:2	18:10	2	int	recnum
water	19:2	0:0	2	foundiptc
op	19:12	0:0	2	=
water	19:14	0:0	2	0
water	19:15	0:0	2	;
water	20:2	0:0	2	tagsfound
op	20:12	0:0	2	=
water	20:14	0:0	2	0
water	20:15	0:0	2	;
water	21:2	0:0	2	c
op	21:4	0:0	2	=
call	21:6	21:16	2	getc
arg	21:11	21:16	3	ifile
water	21:11	0:0	4	ifile
water	21:17	0:0	2	;
while	22:2	118:4	2	(c != EOF)
cond	22:9	22:14	3	c != EOF
water	22:9	0:0	4	c
op	22:11	0:0	4	!=
water	22:14	0:0	4	EOF
stmts	23:4	118:4	3	
water	23:4	0:0	4	{
if	24:6	25:21	4	(c == 0 x1c)
cond	24:10	24:16	5	c == 0 x1c
water	24:10	0:0	6	c
op	24:12	0:0	6	==
water	24:15	0:0	6	0
water	24:16	0:0	6	x1c
stmts	25:8	25:21	5	
water	25:8	0:0	6	foundiptc
op	25:18	0:0	6	=
water	25:20	0:0	6	1
water	25:21	0:0	6	;
else	26:6	37:8	4
stmts	27:8	37:8	5	
water	27:8	0:0	6	{
if	28:10	31:12	6	(foundiptc)
cond	28:14	28:14	7	foundiptc
water	28:14	0:0	8	foundiptc
stmts	29:12	31:12	7	
water	29:12	0:0	8	{
return	30:14	30:23	8	-1
op	30:21	0:0	9	-
water	30:22	0:0	9	1
water	31:12	0:0	8	}
else	32:10	36:12	6
stmts	33:12	36:12	7	
water	33:12	0:0	8	{
water	34:14	0:0	8	c
op	34:16	0:0	8	=
call	34:18	34:28	8	getc
arg	34:23	34:28	9	ifile
water	34:23	0:0	10	ifile
water	34:29	0:0	8	;
continue	35:14	35:22	8	
water	36:12	0:0	8	}
water	37:8	0:0	6	}
water	39:6	0:0	4	dataset
op	39:14	0:0	4	=
call	39:16	39:26	4	getc
arg	39:21	39:26	5	ifile
water	39:21	0:0	6	ifile
water	39:27	0:0	4	;
if	40:6	41:17	4	(( char ) dataset == EOF)
cond	40:10	40:28	5	( char ) dataset == EOF
water	40:10	0:0	6	(
water	40:11	0:0	6	char
water	40:15	0:0	6	)
water	40:17	0:0	6	dataset
op	40:25	0:0	6	==
water	40:28	0:0	6	EOF
stmts	41:8	41:17	5	
return	41:8	41:17	6	-1
op	41:15	0:0	7	-
water	41:16	0:0	7	1
water	42:6	0:0	4	recnum
op	42:13	0:0	4	=
call	42:15	42:25	4	getc
arg	42:20	42:25	5	ifile
water	42:20	0:0	6	ifile
water	42:26	0:0	4	;
if	43:6	44:17	4	(( char ) recnum == EOF)
cond	43:10	43:27	5	( char ) recnum == EOF
water	43:10	0:0	6	(
water	43:11	0:0	6	char
water	43:15	0:0	6	)
water	43:17	0:0	6	recnum
op	43:24	0:0	6	==
water	43:27	0:0	6	EOF
stmts	44:8	44:17	5	
return	44:8	44:17	6	-1
op	44:15	0:0	7	-
water	44:16	0:0	7	1
for	46:6	50:8	4	(i = 0 ;i < tagcount;i ++)
forinit	46:11	46:14	5	i = 0 ;
water	46:11	0:0	6	i
op	46:12	0:0	6	=
water	46:13	0:0	6	0
water	46:14	0:0	6	;
cond	46:16	46:19	5	i < tagcount
water	46:16	0:0	6	i
op	46:17	0:0	6	<
water	46:19	0:0	6	tagcount
forexpr	46:29	46:30	5	i ++
water	46:29	0:0	6	i
op	46:30	0:0	6	++
stmts	47:8	50:8	5	
water	47:8	0:0	6	{
if	48:10	49:17	6	(tags [ i ] . id == recnum)
cond	48:14	48:28	7	tags [ i ] . id == recnum
water	48:14	0:0	8	tags
op	48:18	0:0	8	[
water	48:19	0:0	8	i
op	48:20	0:0	8	]
op	48:21	0:0	8	.
water	48:22	0:0	8	id
op	48:25	0:0	8	==
water	48:28	0:0	8	recnum
stmts	49:12	49:17	7	
break	49:12	49:17	8	
water	50:8	0:0	6	}
if	51:6	52:31	4	(i < tagcount)
cond	51:10	51:14	5	i < tagcount
water	51:10	0:0	6	i
op	51:12	0:0	6	<
water	51:14	0:0	6	tagcount
stmts	52:8	52:31	5	
water	52:8	0:0	6	readable
op	52:17	0:0	6	=
water	52:19	0:0	6	tags
op	52:23	0:0	6	[
water	52:24	0:0	6	i
op	52:25	0:0	6	]
op	52:26	0:0	6	.
water	52:27	0:0	6	name
water	52:31	0:0	6	;
else	53:6	54:21	4
stmts	54:8	54:21	5	
water	54:8	0:0	6	readable
op	54:17	0:0	6	=
water	54:19	0:0	6	""
water	54:21	0:0	6	;
water	56:6	0:0	4	c
op	56:8	0:0	4	=
call	56:10	56:20	4	getc
arg	56:15	56:20	5	ifile
water	56:15	0:0	6	ifile
water	56:21	0:0	4	;
if	57:6	58:16	4	(c == EOF)
cond	57:10	57:15	5	c == EOF
water	57:10	0:0	6	c
op	57:12	0:0	6	==
water	57:15	0:0	6	EOF
stmts	58:8	58:16	5	
return	58:8	58:16	6	0
water	58:15	0:0	7	0
if	59:6	74:8	4	(c & ( unsigned char ) 0 x80)
cond	59:10	59:31	5	c & ( unsigned char ) 0 x80
water	59:10	0:0	6	c
op	59:12	0:0	6	&
water	59:14	0:0	6	(
water	59:15	0:0	6	unsigned
water	59:24	0:0	6	char
water	59:28	0:0	6	)
water	59:30	0:0	6	0
water	59:31	0:0	6	x80
stmts	60:8	74:8	5	
water	60:8	0:0	6	{
decl	61:10	62:21	6	unsigned char	buffer[4]
for	63:10	69:12	6	(i = 0 ;i < 4;i ++)
forinit	63:15	63:18	7	i = 0 ;
water	63:15	0:0	8	i
op	63:16	0:0	8	=
water	63:17	0:0	8	0
water	63:18	0:0	8	;
cond	63:20	63:22	7	i < 4
water	63:20	0:0	8	i
op	63:21	0:0	8	<
water	63:22	0:0	8	4
forexpr	63:25	63:26	7	i ++
water	63:25	0:0	8	i
op	63:26	0:0	8	++
stmts	64:12	69:12	7	
water	64:12	0:0	8	{
water	65:14	0:0	8	c
op	65:16	0:0	8	=
call	65:18	65:28	8	getc
arg	65:23	65:28	9	ifile
water	65:23	0:0	10	ifile
water	65:29	0:0	8	;
if	66:14	67:25	8	(c == EOF)
cond	66:18	66:23	9	c == EOF
water	66:18	0:0	10	c
op	66:20	0:0	10	==
water	66:23	0:0	10	EOF
stmts	67:16	67:25	9	
return	67:16	67:25	10	-1
op	67:23	0:0	11	-
water	67:24	0:0	11	1
water	68:14	0:0	8	buffer
op	68:20	0:0	8	[
water	68:21	0:0	8	i
op	68:22	0:0	8	]
op	68:24	0:0	8	=
water	68:26	0:0	8	c
water	68:27	0:0	8	;
water	69:12	0:0	8	}
water	70:10	0:0	6	taglen
op	70:17	0:0	6	=
water	70:19	0:0	6	(
water	70:20	0:0	6	(
water	70:21	0:0	6	(
water	70:22	0:0	6	long
water	70:26	0:0	6	)
water	70:28	0:0	6	buffer
op	70:34	0:0	6	[
water	70:36	0:0	6	0
op	70:38	0:0	6	]
water	70:39	0:0	6	)
op	70:41	0:0	6	<<
water	70:44	0:0	6	24
water	70:46	0:0	6	)
op	70:48	0:0	6	|
water	71:12	0:0	6	(
water	71:13	0:0	6	(
water	71:14	0:0	6	(
water	71:15	0:0	6	long
water	71:19	0:0	6	)
water	71:21	0:0	6	buffer
op	71:27	0:0	6	[
water	71:29	0:0	6	1
op	71:31	0:0	6	]
water	71:32	0:0	6	)
op	71:34	0:0	6	<<
water	71:37	0:0	6	16
water	71:39	0:0	6	)
op	71:41	0:0	6	|
water	72:12	0:0	6	(
water	72:13	0:0	6	(
water	72:14	0:0	6	(
water	72:15	0:0	6	long
water	72:19	0:0	6	)
water	72:21	0:0	6	buffer
op	72:27	0:0	6	[
water	72:29	0:0	6	2
op	72:31	0:0	6	]
water	72:32	0:0	6	)
op	72:34	0:0	6	<<
water	72:38	0:0	6	8
water	72:39	0:0	6	)
op	72:41	0:0	6	|
water	73:12	0:0	6	(
water	73:13	0:0	6	(
water	73:14	0:0	6	(
water	73:15	0:0	6	long
water	73:19	0:0	6	)
water	73:21	0:0	6	buffer
op	73:27	0:0	6	[
water	73:29	0:0	6	3
op	73:31	0:0	6	]
water	73:32	0:0	6	)
water	73:33	0:0	6	)
water	73:34	0:0	6	;
water	74:8	0:0	6	}
else	75:6	84:8	4
stmts	76:8	84:8	5	
water	76:8	0:0	6	{
decl	77:10	78:17	6	int	x
op	78:14	0:0	6	=
water	78:16	0:0	6	c
water	79:10	0:0	6	taglen
op	79:17	0:0	6	=
water	79:19	0:0	6	x
op	79:21	0:0	6	<<
water	79:24	0:0	6	8
water	79:25	0:0	6	;
water	80:10	0:0	6	x
op	80:12	0:0	6	=
call	80:14	80:24	6	getc
arg	80:19	80:24	7	ifile
water	80:19	0:0	8	ifile
water	80:25	0:0	6	;
if	81:10	82:21	6	(x == EOF)
cond	81:14	81:19	7	x == EOF
water	81:14	0:0	8	x
op	81:16	0:0	8	==
water	81:19	0:0	8	EOF
stmts	82:12	82:21	7	
return	82:12	82:21	8	-1
op	82:19	0:0	9	-
water	82:20	0:0	9	1
water	83:10	0:0	6	taglen
op	83:17	0:0	6	|=
water	83:20	0:0	6	(
water	83:21	0:0	6	long
water	83:25	0:0	6	)
water	83:27	0:0	6	x
water	83:28	0:0	6	;
water	84:8	0:0	6	}
if	86:6	90:8	4	(( taglen <= 0 ) || ( taglen > 1048576 ))
cond	86:10	86:44	5	( taglen <= 0 ) || ( taglen > 1048576 )
water	86:10	0:0	6	(
water	86:11	0:0	6	taglen
op	86:18	0:0	6	<=
water	86:21	0:0	6	0
water	86:22	0:0	6	)
op	86:24	0:0	6	||
water	86:27	0:0	6	(
water	86:28	0:0	6	taglen
op	86:35	0:0	6	>
water	86:37	0:0	6	1048576
water	86:44	0:0	6	)
stmts	87:8	90:8	5	
water	87:8	0:0	6	{
call	88:10	88:61	6	printf
arg	88:17	88:54	7	"Inappropriate IPTC tag length %ld\n"
water	88:17	0:0	8	"Inappropriate IPTC tag length %ld\n"
arg	88:55	88:61	7	taglen
water	88:55	0:0	8	taglen
water	88:62	0:0	6	;
return	89:10	89:19	6	-1
op	89:17	0:0	7	-
water	89:18	0:0	7	1
water	90:8	0:0	6	}
water	92:6	0:0	4	str
op	92:10	0:0	4	=
water	92:12	0:0	4	(
water	92:13	0:0	4	char
op	92:18	0:0	4	*
water	92:19	0:0	4	)
call	92:21	92:53	4	malloc
arg	92:28	92:53	5	(unsignedint)(taglen+1)
call	92:28	92:52	6	(unsignedint)
arg	92:44	92:52	7	taglen+1
water	92:44	0:0	8	taglen
op	92:50	0:0	8	+
water	92:51	0:0	8	1
water	92:54	0:0	4	;
if	93:6	97:8	4	(str == ( char * ) NULL)
cond	93:10	93:26	5	str == ( char * ) NULL
water	93:10	0:0	6	str
op	93:14	0:0	6	==
water	93:17	0:0	6	(
water	93:18	0:0	6	char
op	93:23	0:0	6	*
water	93:24	0:0	6	)
water	93:26	0:0	6	NULL
stmts	94:8	97:8	5	
water	94:8	0:0	6	{
call	95:10	95:43	6	printf
arg	95:17	95:43	7	"Memory allocation failed"
water	95:17	0:0	8	"Memory allocation failed"
water	95:44	0:0	6	;
return	96:10	96:18	6	0
water	96:17	0:0	7	0
water	97:8	0:0	6	}
for	98:6	107:8	4	(tagindx = 0 ;tagindx < taglen;tagindx ++)
forinit	98:11	98:20	5	tagindx = 0 ;
water	98:11	0:0	6	tagindx
op	98:18	0:0	6	=
water	98:19	0:0	6	0
water	98:20	0:0	6	;
cond	98:22	98:30	5	tagindx < taglen
water	98:22	0:0	6	tagindx
op	98:29	0:0	6	<
water	98:30	0:0	6	taglen
forexpr	98:38	98:45	5	tagindx ++
water	98:38	0:0	6	tagindx
op	98:45	0:0	6	++
stmts	99:8	107:8	5	
water	99:8	0:0	6	{
water	100:10	0:0	6	c
op	100:12	0:0	6	=
call	100:14	100:24	6	getc
arg	100:19	100:24	7	ifile
water	100:19	0:0	8	ifile
water	100:25	0:0	6	;
if	101:10	105:12	6	(c == EOF)
cond	101:14	101:19	7	c == EOF
water	101:14	0:0	8	c
op	101:16	0:0	8	==
water	101:19	0:0	8	EOF
stmts	102:12	105:12	7	
water	102:12	0:0	8	{
call	103:14	103:22	8	free
arg	103:19	103:22	9	str
water	103:19	0:0	10	str
water	103:23	0:0	8	;
return	104:14	104:23	8	-1
op	104:21	0:0	9	-
water	104:22	0:0	9	1
water	105:12	0:0	8	}
water	106:10	0:0	6	str
op	106:13	0:0	6	[
water	106:14	0:0	6	tagindx
op	106:21	0:0	6	]
op	106:23	0:0	6	=
water	106:25	0:0	6	c
water	106:26	0:0	6	;
water	107:8	0:0	6	}
water	108:6	0:0	4	str
op	108:9	0:0	4	[
water	108:11	0:0	4	taglen
op	108:18	0:0	4	]
op	108:20	0:0	4	=
water	108:22	0:0	4	0
water	108:23	0:0	4	;
if	110:6	111:90	4	(strlen (readable ) > 0)
cond	110:10	110:29	5	strlen (readable ) > 0
call	110:10	110:25	6	strlen
arg	110:17	110:25	7	readable
water	110:17	0:0	8	readable
op	110:27	0:0	6	>
water	110:29	0:0	6	0
stmts	111:8	111:90	5	
call	111:8	111:89	6	fprintf
arg	111:16	111:21	7	ofile
water	111:16	0:0	8	ofile
arg	111:23	111:34	7	"%d#%d#%s="
water	111:23	0:0	8	"%d#%d#%s="
arg	111:35	111:56	7	(unsignedint)dataset
water	111:35	0:0	8	(
water	111:36	0:0	8	unsigned
water	111:45	0:0	8	int
water	111:48	0:0	8	)
water	111:49	0:0	8	dataset
arg	111:58	111:79	7	(unsignedint)recnum
water	111:58	0:0	8	(
water	111:59	0:0	8	unsigned
water	111:68	0:0	8	int
water	111:71	0:0	8	)
water	111:73	0:0	8	recnum
arg	111:81	111:89	7	readable
water	111:81	0:0	8	readable
water	111:90	0:0	6	;
else	112:6	113:77	4
stmts	113:8	113:77	5	
call	113:8	113:76	6	fprintf
arg	113:16	113:21	7	ofile
water	113:16	0:0	8	ofile
arg	113:23	113:31	7	"%d#%d="
water	113:23	0:0	8	"%d#%d="
arg	113:32	113:53	7	(unsignedint)dataset
water	113:32	0:0	8	(
water	113:33	0:0	8	unsigned
water	113:42	0:0	8	int
water	113:45	0:0	8	)
water	113:46	0:0	8	dataset
arg	113:55	113:76	7	(unsignedint)recnum
water	113:55	0:0	8	(
water	113:56	0:0	8	unsigned
water	113:65	0:0	8	int
water	113:68	0:0	8	)
water	113:70	0:0	8	recnum
water	113:77	0:0	6	;
call	114:6	114:39	4	formatString
arg	114:20	114:25	5	ofile
water	114:20	0:0	6	ofile
arg	114:27	114:30	5	str
water	114:27	0:0	6	str
arg	114:32	114:39	5	taglen
water	114:32	0:0	6	taglen
water	114:40	0:0	4	;
call	115:6	115:14	4	free
arg	115:11	115:14	5	str
water	115:11	0:0	6	str
water	115:15	0:0	4	;
water	116:6	0:0	4	tagsfound
op	116:15	0:0	4	++
water	116:17	0:0	4	;
water	117:6	0:0	4	c
op	117:8	0:0	4	=
call	117:10	117:20	4	getc
arg	117:15	117:20	5	ifile
water	117:15	0:0	6	ifile
water	117:21	0:0	4	;
water	118:4	0:0	4	}
return	119:2	119:18	2	tagsfound
water	119:9	0:0	3	tagsfound
