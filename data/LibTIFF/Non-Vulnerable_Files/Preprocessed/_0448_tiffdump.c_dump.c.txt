func	1:0	99:0	0	static void	dump
params	2:4	0:0	1	
param	2:5	2:11	2	int	fd
param	2:13	2:26	2	uint64	diroff
stmnts	4:1	98:25	1	
water	4:1	0:0	2	unsigned
water	4:10	0:0	2	i
water	4:11	0:0	2	,
water	4:13	0:0	2	j
water	4:14	0:0	2	;
decl	5:1	5:30	2	uint64	*visited_diroff
op	5:24	0:0	2	=
water	5:26	0:0	2	NULL
decl	6:1	6:35	2	unsigned int	count_visited_dir
op	6:32	0:0	2	=
water	6:34	0:0	2	0
call	7:1	7:37	2	_TIFF_lseek_f
arg	7:15	7:17	3	fd
water	7:15	0:0	4	fd
arg	7:19	7:34	3	(_TIFF_off_t)0
water	7:19	0:0	4	(
water	7:20	0:0	4	_TIFF_off_t
water	7:31	0:0	4	)
water	7:33	0:0	4	0
arg	7:36	7:37	3	0
water	7:36	0:0	4	0
water	7:38	0:0	2	;
if	8:1	9:26	2	(read (fd ,( char * ) & hdr ,sizeof ( TIFFHeaderCommon ) ) != sizeof ( TIFFHeaderCommon ))
cond	8:5	8:82	3	read (fd ,( char * ) & hdr ,sizeof ( TIFFHeaderCommon ) ) != sizeof ( TIFFHeaderCommon )
call	8:5	8:53	4	read
arg	8:10	8:12	5	fd
water	8:10	0:0	6	fd
arg	8:14	8:26	5	(char*)&hdr
water	8:14	0:0	6	(
water	8:15	0:0	6	char
op	8:19	0:0	6	*
water	8:20	0:0	6	)
op	8:22	0:0	6	&
water	8:23	0:0	6	hdr
arg	8:28	8:53	5	sizeof(TIFFHeaderCommon)
op	8:28	0:0	6	sizeof
water	8:35	0:0	6	(
water	8:36	0:0	6	TIFFHeaderCommon
water	8:52	0:0	6	)
op	8:55	0:0	4	!=
op	8:58	0:0	4	sizeof
water	8:65	0:0	4	(
water	8:66	0:0	4	TIFFHeaderCommon
water	8:82	0:0	4	)
stmts	9:2	9:26	3	
call	9:2	9:25	4	ReadError
arg	9:12	9:25	5	"TIFF header"
water	9:12	0:0	6	"TIFF header"
water	9:26	0:0	4	;
if	10:1	21:1	2	(hdr . common . tiff_magic != TIFF_BIGENDIAN && hdr . common . tiff_magic != TIFF_LITTLEENDIAN && MDI_BIGENDIAN != hdr . common . tiff_magic MDI_LITTLEENDIAN != hdr . common . tiff_magic)
cond	10:5	16:36	3	hdr . common . tiff_magic != TIFF_BIGENDIAN && hdr . common . tiff_magic != TIFF_LITTLEENDIAN && MDI_BIGENDIAN != hdr . common . tiff_magic MDI_LITTLEENDIAN != hdr . common . tiff_magic
water	10:5	0:0	4	hdr
op	10:8	0:0	4	.
water	10:9	0:0	4	common
op	10:15	0:0	4	.
water	10:16	0:0	4	tiff_magic
op	10:27	0:0	4	!=
water	10:30	0:0	4	TIFF_BIGENDIAN
op	11:5	0:0	4	&&
water	11:8	0:0	4	hdr
op	11:11	0:0	4	.
water	11:12	0:0	4	common
op	11:18	0:0	4	.
water	11:19	0:0	4	tiff_magic
op	11:30	0:0	4	!=
water	11:33	0:0	4	TIFF_LITTLEENDIAN
op	11:51	0:0	4	&&
water	14:5	0:0	4	MDI_BIGENDIAN
op	14:19	0:0	4	!=
water	14:22	0:0	4	hdr
op	14:25	0:0	4	.
water	14:26	0:0	4	common
op	14:32	0:0	4	.
water	14:33	0:0	4	tiff_magic
water	16:5	0:0	4	MDI_LITTLEENDIAN
op	16:22	0:0	4	!=
water	16:25	0:0	4	hdr
op	16:28	0:0	4	.
water	16:29	0:0	4	common
op	16:35	0:0	4	.
water	16:36	0:0	4	tiff_magic
stmts	18:6	21:1	3	
water	18:6	0:0	4	{
call	19:2	20:50	4	Fatal
arg	19:8	19:59	5	"Not a TIFF or MDI file, bad magic number %u (%#x)"
water	19:8	0:0	6	"Not a TIFF or MDI file, bad magic number %u (%#x)"
arg	20:6	20:27	5	hdr.common.tiff_magic
water	20:6	0:0	6	hdr
op	20:9	0:0	6	.
water	20:10	0:0	6	common
op	20:16	0:0	6	.
water	20:17	0:0	6	tiff_magic
arg	20:29	20:50	5	hdr.common.tiff_magic
water	20:29	0:0	6	hdr
op	20:32	0:0	6	.
water	20:33	0:0	6	common
op	20:39	0:0	6	.
water	20:40	0:0	6	tiff_magic
water	20:51	0:0	4	;
water	21:1	0:0	4	}
if	22:1	24:23	2	(hdr . common . tiff_magic == TIFF_BIGENDIAN || hdr . common . tiff_magic == MDI_BIGENDIAN)
cond	22:5	23:33	3	hdr . common . tiff_magic == TIFF_BIGENDIAN || hdr . common . tiff_magic == MDI_BIGENDIAN
water	22:5	0:0	4	hdr
op	22:8	0:0	4	.
water	22:9	0:0	4	common
op	22:15	0:0	4	.
water	22:16	0:0	4	tiff_magic
op	22:27	0:0	4	==
water	22:30	0:0	4	TIFF_BIGENDIAN
op	23:5	0:0	4	||
water	23:8	0:0	4	hdr
op	23:11	0:0	4	.
water	23:12	0:0	4	common
op	23:18	0:0	4	.
water	23:19	0:0	4	tiff_magic
op	23:30	0:0	4	==
water	23:33	0:0	4	MDI_BIGENDIAN
stmts	24:2	24:23	3	
water	24:2	0:0	4	swabflag
op	24:11	0:0	4	=
op	24:13	0:0	4	!
water	24:14	0:0	4	bigendian
water	24:23	0:0	4	;
else	25:1	26:22	2
stmts	26:2	26:22	3	
water	26:2	0:0	4	swabflag
op	26:11	0:0	4	=
water	26:13	0:0	4	bigendian
water	26:22	0:0	4	;
if	27:1	28:41	2	(swabflag)
cond	27:5	27:5	3	swabflag
water	27:5	0:0	4	swabflag
stmts	28:2	28:41	3	
call	28:2	28:40	4	TIFFSwabShort
arg	28:16	28:40	5	&hdr.common.tiff_version
op	28:16	0:0	6	&
water	28:17	0:0	6	hdr
op	28:20	0:0	6	.
water	28:21	0:0	6	common
op	28:27	0:0	6	.
water	28:28	0:0	6	tiff_version
water	28:41	0:0	4	;
if	29:1	41:1	2	(hdr . common . tiff_version == 42)
cond	29:5	29:30	3	hdr . common . tiff_version == 42
water	29:5	0:0	4	hdr
op	29:8	0:0	4	.
water	29:9	0:0	4	common
op	29:15	0:0	4	.
water	29:16	0:0	4	tiff_version
op	29:28	0:0	4	==
water	29:30	0:0	4	42
stmts	30:1	41:1	3	
water	30:1	0:0	4	{
if	31:2	32:27	4	(read (fd ,( char * ) & hdr . classic . tiff_diroff ,4 ) != 4)
cond	31:6	31:55	5	read (fd ,( char * ) & hdr . classic . tiff_diroff ,4 ) != 4
call	31:6	31:50	6	read
arg	31:11	31:13	7	fd
water	31:11	0:0	8	fd
arg	31:15	31:47	7	(char*)&hdr.classic.tiff_diroff
water	31:15	0:0	8	(
water	31:16	0:0	8	char
op	31:20	0:0	8	*
water	31:21	0:0	8	)
op	31:23	0:0	8	&
water	31:24	0:0	8	hdr
op	31:27	0:0	8	.
water	31:28	0:0	8	classic
op	31:35	0:0	8	.
water	31:36	0:0	8	tiff_diroff
arg	31:49	31:50	7	4
water	31:49	0:0	8	4
op	31:52	0:0	6	!=
water	31:55	0:0	6	4
stmts	32:3	32:27	5	
call	32:3	32:26	6	ReadError
arg	32:13	32:26	7	"TIFF header"
water	32:13	0:0	8	"TIFF header"
water	32:27	0:0	6	;
if	33:2	34:41	4	(swabflag)
cond	33:6	33:6	5	swabflag
water	33:6	0:0	6	swabflag
stmts	34:3	34:41	5	
call	34:3	34:40	6	TIFFSwabLong
arg	34:16	34:40	7	&hdr.classic.tiff_diroff
op	34:16	0:0	8	&
water	34:17	0:0	8	hdr
op	34:20	0:0	8	.
water	34:21	0:0	8	classic
op	34:28	0:0	8	.
water	34:29	0:0	8	tiff_diroff
water	34:41	0:0	6	;
call	35:2	38:22	4	printf
arg	35:9	35:53	5	"Magic: %#x <%s-endian> Version: %#x <%s>\n"
water	35:9	0:0	6	"Magic: %#x <%s-endian> Version: %#x <%s>\n"
arg	36:6	36:28	5	hdr.classic.tiff_magic
water	36:6	0:0	6	hdr
op	36:9	0:0	6	.
water	36:10	0:0	6	classic
op	36:17	0:0	6	.
water	36:18	0:0	6	tiff_magic
arg	37:6	37:65	5	hdr.classic.tiff_magic==TIFF_BIGENDIAN?"big":"little"
water	37:6	0:0	6	hdr
op	37:9	0:0	6	.
water	37:10	0:0	6	classic
op	37:17	0:0	6	.
water	37:18	0:0	6	tiff_magic
op	37:29	0:0	6	==
water	37:32	0:0	6	TIFF_BIGENDIAN
water	37:47	0:0	6	?
water	37:49	0:0	6	"big"
water	37:55	0:0	6	:
water	37:57	0:0	6	"little"
arg	38:6	38:8	5	42
water	38:6	0:0	6	42
arg	38:9	38:22	5	"ClassicTIFF"
water	38:9	0:0	6	"ClassicTIFF"
water	38:23	0:0	4	;
if	39:2	40:35	4	(diroff == 0)
cond	39:6	39:16	5	diroff == 0
water	39:6	0:0	6	diroff
op	39:13	0:0	6	==
water	39:16	0:0	6	0
stmts	40:3	40:35	5	
water	40:3	0:0	6	diroff
op	40:10	0:0	6	=
water	40:12	0:0	6	hdr
op	40:15	0:0	6	.
water	40:16	0:0	6	classic
op	40:23	0:0	6	.
water	40:24	0:0	6	tiff_diroff
water	40:35	0:0	6	;
water	41:1	0:0	4	}
else	42:1	61:1	2
stmts	42:6	61:1	3	
if	42:6	61:1	4	(hdr . common . tiff_version == 43)
cond	42:10	42:35	5	hdr . common . tiff_version == 43
water	42:10	0:0	6	hdr
op	42:13	0:0	6	.
water	42:14	0:0	6	common
op	42:20	0:0	6	.
water	42:21	0:0	6	tiff_version
op	42:33	0:0	6	==
water	42:35	0:0	6	43
stmts	43:1	61:1	5	
water	43:1	0:0	6	{
if	44:2	45:27	6	(read (fd ,( char * ) & hdr . big . tiff_offsetsize ,12 ) != 12)
cond	44:6	44:56	7	read (fd ,( char * ) & hdr . big . tiff_offsetsize ,12 ) != 12
call	44:6	44:51	8	read
arg	44:11	44:13	9	fd
water	44:11	0:0	10	fd
arg	44:15	44:47	9	(char*)&hdr.big.tiff_offsetsize
water	44:15	0:0	10	(
water	44:16	0:0	10	char
op	44:20	0:0	10	*
water	44:21	0:0	10	)
op	44:23	0:0	10	&
water	44:24	0:0	10	hdr
op	44:27	0:0	10	.
water	44:28	0:0	10	big
op	44:31	0:0	10	.
water	44:32	0:0	10	tiff_offsetsize
arg	44:49	44:51	9	12
water	44:49	0:0	10	12
op	44:53	0:0	8	!=
water	44:56	0:0	8	12
stmts	45:3	45:27	7	
call	45:3	45:26	8	ReadError
arg	45:13	45:26	9	"TIFF header"
water	45:13	0:0	10	"TIFF header"
water	45:27	0:0	8	;
if	46:2	51:2	6	(swabflag)
cond	46:6	46:6	7	swabflag
water	46:6	0:0	8	swabflag
stmts	47:2	51:2	7	
water	47:2	0:0	8	{
call	48:3	48:41	8	TIFFSwabShort
arg	48:17	48:41	9	&hdr.big.tiff_offsetsize
op	48:17	0:0	10	&
water	48:18	0:0	10	hdr
op	48:21	0:0	10	.
water	48:22	0:0	10	big
op	48:25	0:0	10	.
water	48:26	0:0	10	tiff_offsetsize
water	48:42	0:0	8	;
call	49:3	49:37	8	TIFFSwabShort
arg	49:17	49:37	9	&hdr.big.tiff_unused
op	49:17	0:0	10	&
water	49:18	0:0	10	hdr
op	49:21	0:0	10	.
water	49:22	0:0	10	big
op	49:25	0:0	10	.
water	49:26	0:0	10	tiff_unused
water	49:38	0:0	8	;
call	50:3	50:37	8	TIFFSwabLong8
arg	50:17	50:37	9	&hdr.big.tiff_diroff
op	50:17	0:0	10	&
water	50:18	0:0	10	hdr
op	50:21	0:0	10	.
water	50:22	0:0	10	big
op	50:25	0:0	10	.
water	50:26	0:0	10	tiff_diroff
water	50:38	0:0	8	;
water	51:2	0:0	8	}
call	52:2	55:18	6	printf
arg	52:9	52:53	7	"Magic: %#x <%s-endian> Version: %#x <%s>\n"
water	52:9	0:0	8	"Magic: %#x <%s-endian> Version: %#x <%s>\n"
arg	53:6	53:24	7	hdr.big.tiff_magic
water	53:6	0:0	8	hdr
op	53:9	0:0	8	.
water	53:10	0:0	8	big
op	53:13	0:0	8	.
water	53:14	0:0	8	tiff_magic
arg	54:6	54:61	7	hdr.big.tiff_magic==TIFF_BIGENDIAN?"big":"little"
water	54:6	0:0	8	hdr
op	54:9	0:0	8	.
water	54:10	0:0	8	big
op	54:13	0:0	8	.
water	54:14	0:0	8	tiff_magic
op	54:25	0:0	8	==
water	54:28	0:0	8	TIFF_BIGENDIAN
water	54:43	0:0	8	?
water	54:45	0:0	8	"big"
water	54:51	0:0	8	:
water	54:53	0:0	8	"little"
arg	55:6	55:8	7	43
water	55:6	0:0	8	43
arg	55:9	55:18	7	"BigTIFF"
water	55:9	0:0	8	"BigTIFF"
water	55:19	0:0	6	;
call	56:2	57:49	6	printf
arg	56:9	56:40	7	"OffsetSize: %#x Unused: %#x\n"
water	56:9	0:0	8	"OffsetSize: %#x Unused: %#x\n"
arg	57:6	57:29	7	hdr.big.tiff_offsetsize
water	57:6	0:0	8	hdr
op	57:9	0:0	8	.
water	57:10	0:0	8	big
op	57:13	0:0	8	.
water	57:14	0:0	8	tiff_offsetsize
arg	57:30	57:49	7	hdr.big.tiff_unused
water	57:30	0:0	8	hdr
op	57:33	0:0	8	.
water	57:34	0:0	8	big
op	57:37	0:0	8	.
water	57:38	0:0	8	tiff_unused
water	57:50	0:0	6	;
if	58:2	59:31	6	(diroff == 0)
cond	58:6	58:16	7	diroff == 0
water	58:6	0:0	8	diroff
op	58:13	0:0	8	==
water	58:16	0:0	8	0
stmts	59:3	59:31	7	
water	59:3	0:0	8	diroff
op	59:10	0:0	8	=
water	59:12	0:0	8	hdr
op	59:15	0:0	8	.
water	59:16	0:0	8	big
op	59:19	0:0	8	.
water	59:20	0:0	8	tiff_diroff
water	59:31	0:0	8	;
water	60:2	0:0	6	bigtiff
op	60:10	0:0	6	=
water	60:12	0:0	6	1
water	60:13	0:0	6	;
water	61:1	0:0	6	}
else	62:1	64:55	2
stmts	63:2	64:55	3	
call	63:2	64:54	4	Fatal
arg	63:8	63:54	5	"Not a TIFF file, bad version number %u (%#x)"
water	63:8	0:0	6	"Not a TIFF file, bad version number %u (%#x)"
arg	64:6	64:29	5	hdr.common.tiff_version
water	64:6	0:0	6	hdr
op	64:9	0:0	6	.
water	64:10	0:0	6	common
op	64:16	0:0	6	.
water	64:17	0:0	6	tiff_version
arg	64:31	64:54	5	hdr.common.tiff_version
water	64:31	0:0	6	hdr
op	64:34	0:0	6	.
water	64:35	0:0	6	common
op	64:41	0:0	6	.
water	64:42	0:0	6	tiff_version
water	64:55	0:0	4	;
for	65:1	96:1	2	(i = 0 ;diroff != 0;i ++)
forinit	65:6	65:11	3	i = 0 ;
water	65:6	0:0	4	i
op	65:8	0:0	4	=
water	65:10	0:0	4	0
water	65:11	0:0	4	;
cond	65:13	65:23	3	diroff != 0
water	65:13	0:0	4	diroff
op	65:20	0:0	4	!=
water	65:23	0:0	4	0
forexpr	65:26	65:27	3	i ++
water	65:26	0:0	4	i
op	65:27	0:0	4	++
stmts	65:31	96:1	3	
water	65:31	0:0	4	{
for	66:2	73:2	4	(j = 0 ;j < count_visited_dir;j ++)
forinit	66:6	66:9	5	j = 0 ;
water	66:6	0:0	6	j
op	66:7	0:0	6	=
water	66:8	0:0	6	0
water	66:9	0:0	6	;
cond	66:11	66:13	5	j < count_visited_dir
water	66:11	0:0	6	j
op	66:12	0:0	6	<
water	66:13	0:0	6	count_visited_dir
forexpr	66:32	66:33	5	j ++
water	66:32	0:0	6	j
op	66:33	0:0	6	++
stmts	67:2	73:2	5	
water	67:2	0:0	6	{
if	68:6	72:6	6	(visited_diroff [ j ] == diroff)
cond	68:10	68:31	7	visited_diroff [ j ] == diroff
water	68:10	0:0	8	visited_diroff
op	68:24	0:0	8	[
water	68:25	0:0	8	j
op	68:26	0:0	8	]
op	68:28	0:0	8	==
water	68:31	0:0	8	diroff
stmts	69:6	72:6	7	
water	69:6	0:0	8	{
call	70:3	70:22	8	free
arg	70:8	70:22	9	visited_diroff
water	70:8	0:0	10	visited_diroff
water	70:23	0:0	8	;
call	71:3	71:58	8	Fatal
arg	71:9	71:58	9	"Cycle detected in chaining of TIFF directories!"
water	71:9	0:0	10	"Cycle detected in chaining of TIFF directories!"
water	71:59	0:0	8	;
water	72:6	0:0	8	}
water	73:2	0:0	6	}
water	74:16	0:0	4	{
decl	75:20	75:37	4	size_t	alloc_size
water	76:20	0:0	4	alloc_size
op	76:30	0:0	4	=
call	76:31	77:62	4	TIFFSafeMultiply
arg	76:48	76:56	5	tmsize_t
water	76:48	0:0	6	tmsize_t
arg	76:57	76:80	5	(count_visited_dir+1)
water	76:57	0:0	6	(
water	76:58	0:0	6	count_visited_dir
op	76:76	0:0	6	+
water	76:78	0:0	6	1
water	76:79	0:0	6	)
arg	77:48	77:62	5	sizeof(uint64)
op	77:48	0:0	6	sizeof
water	77:54	0:0	6	(
water	77:55	0:0	6	uint64
water	77:61	0:0	6	)
water	77:63	0:0	4	;
if	78:20	83:20	4	(alloc_size == 0)
cond	78:24	78:38	5	alloc_size == 0
water	78:24	0:0	6	alloc_size
op	78:35	0:0	6	==
water	78:38	0:0	6	0
stmts	79:20	83:20	5	
water	79:20	0:0	6	{
if	80:24	81:48	6	(visited_diroff)
cond	80:28	80:28	7	visited_diroff
water	80:28	0:0	8	visited_diroff
stmts	81:28	81:48	7	
call	81:28	81:47	8	free
arg	81:33	81:47	9	visited_diroff
water	81:33	0:0	10	visited_diroff
water	81:48	0:0	8	;
water	82:24	0:0	6	visited_diroff
op	82:39	0:0	6	=
water	82:41	0:0	6	0
water	82:42	0:0	6	;
water	83:20	0:0	6	}
else	84:20	87:20	4
stmts	85:20	87:20	5	
water	85:20	0:0	6	{
water	86:24	0:0	6	visited_diroff
op	86:39	0:0	6	=
water	86:41	0:0	6	(
water	86:42	0:0	6	uint64
op	86:48	0:0	6	*
water	86:49	0:0	6	)
call	86:51	86:84	6	realloc
arg	86:59	86:73	7	visited_diroff
water	86:59	0:0	8	visited_diroff
arg	86:74	86:84	7	alloc_size
water	86:74	0:0	8	alloc_size
water	86:85	0:0	6	;
water	87:20	0:0	6	}
water	88:16	0:0	4	}
if	89:2	90:28	4	(! visited_diroff)
cond	89:6	89:7	5	! visited_diroff
op	89:6	0:0	6	!
water	89:7	0:0	6	visited_diroff
stmts	90:6	90:28	5	
call	90:6	90:27	6	Fatal
arg	90:12	90:27	7	"Out of memory"
water	90:12	0:0	8	"Out of memory"
water	90:28	0:0	6	;
water	91:2	0:0	4	visited_diroff
op	91:16	0:0	4	[
water	91:17	0:0	4	count_visited_dir
op	91:34	0:0	4	]
op	91:36	0:0	4	=
water	91:38	0:0	4	diroff
water	91:44	0:0	4	;
water	92:2	0:0	4	count_visited_dir
op	92:20	0:0	4	++
water	92:22	0:0	4	;
if	93:2	94:16	4	(i > 0)
cond	93:6	93:10	5	i > 0
water	93:6	0:0	6	i
op	93:8	0:0	6	>
water	93:10	0:0	6	0
stmts	94:3	94:16	5	
call	94:3	94:15	6	putchar
arg	94:11	94:15	7	'\n'
water	94:11	0:0	8	'\n'
water	94:16	0:0	6	;
water	95:2	0:0	4	diroff
op	95:9	0:0	4	=
call	95:11	95:38	4	ReadDirectory
arg	95:25	95:27	5	fd
water	95:25	0:0	6	fd
arg	95:29	95:30	5	i
water	95:29	0:0	6	i
arg	95:32	95:38	5	diroff
water	95:32	0:0	6	diroff
water	95:39	0:0	4	;
water	96:1	0:0	4	}
if	97:1	98:25	2	(visited_diroff)
cond	97:5	97:5	3	visited_diroff
water	97:5	0:0	4	visited_diroff
stmts	98:5	98:25	3	
call	98:5	98:24	4	free
arg	98:10	98:24	5	visited_diroff
water	98:10	0:0	6	visited_diroff
water	98:25	0:0	4	;
