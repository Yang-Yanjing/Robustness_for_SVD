func	1:0	26:0	0	static void	new_pes_packet
params	1:26	0:0	1	
param	1:27	1:42	2	PESContext *	pes
param	1:44	1:57	2	AVPacket *	pkt
stmnts	3:4	25:31	1	
call	3:4	3:22	2	av_init_packet
arg	3:19	3:22	3	pkt
water	3:19	0:0	4	pkt
water	3:23	0:0	2	;
water	4:4	0:0	2	pkt
op	4:7	0:0	2	->
water	4:9	0:0	2	buf
op	4:14	0:0	2	=
water	4:16	0:0	2	pes
op	4:19	0:0	2	->
water	4:21	0:0	2	buffer
water	4:27	0:0	2	;
water	5:4	0:0	2	pkt
op	5:7	0:0	2	->
water	5:9	0:0	2	data
op	5:14	0:0	2	=
water	5:16	0:0	2	pes
op	5:19	0:0	2	->
water	5:21	0:0	2	buffer
op	5:27	0:0	2	->
water	5:29	0:0	2	data
water	5:33	0:0	2	;
water	6:4	0:0	2	pkt
op	6:7	0:0	2	->
water	6:9	0:0	2	size
op	6:14	0:0	2	=
water	6:16	0:0	2	pes
op	6:19	0:0	2	->
water	6:21	0:0	2	data_index
water	6:31	0:0	2	;
if	7:4	12:4	2	(pes -> total_size != MAX_PES_PAYLOAD && pes -> pes_header_size + pes -> data_index != pes -> total_size + PES_START_SIZE)
cond	7:8	9:8	3	pes -> total_size != MAX_PES_PAYLOAD && pes -> pes_header_size + pes -> data_index != pes -> total_size + PES_START_SIZE
water	7:8	0:0	4	pes
op	7:11	0:0	4	->
water	7:13	0:0	4	total_size
op	7:24	0:0	4	!=
water	7:27	0:0	4	MAX_PES_PAYLOAD
op	7:43	0:0	4	&&
water	8:8	0:0	4	pes
op	8:11	0:0	4	->
water	8:13	0:0	4	pes_header_size
op	8:29	0:0	4	+
water	8:31	0:0	4	pes
op	8:34	0:0	4	->
water	8:36	0:0	4	data_index
op	8:47	0:0	4	!=
water	8:50	0:0	4	pes
op	8:53	0:0	4	->
water	8:55	0:0	4	total_size
op	8:66	0:0	4	+
water	9:8	0:0	4	PES_START_SIZE
stmts	9:24	12:4	3	
water	9:24	0:0	4	{
call	10:8	10:72	4	av_log
arg	10:15	10:26	5	pes->stream
water	10:15	0:0	6	pes
op	10:18	0:0	6	->
water	10:20	0:0	6	stream
arg	10:28	10:42	5	AV_LOG_WARNING
water	10:28	0:0	6	AV_LOG_WARNING
arg	10:44	10:72	5	"PES packet size mismatch\n"
water	10:44	0:0	6	"PES packet size mismatch\n"
water	10:73	0:0	4	;
water	11:8	0:0	4	pes
op	11:11	0:0	4	->
water	11:13	0:0	4	flags
op	11:19	0:0	4	|=
water	11:22	0:0	4	AV_PKT_FLAG_CORRUPT
water	11:41	0:0	4	;
water	12:4	0:0	4	}
call	13:4	13:65	2	memset
arg	13:11	13:32	3	pkt->data+pkt->size
water	13:11	0:0	4	pkt
op	13:14	0:0	4	->
water	13:16	0:0	4	data
op	13:21	0:0	4	+
water	13:23	0:0	4	pkt
op	13:26	0:0	4	->
water	13:28	0:0	4	size
arg	13:34	13:35	3	0
water	13:34	0:0	4	0
arg	13:37	13:65	3	AV_INPUT_BUFFER_PADDING_SIZE
water	13:37	0:0	4	AV_INPUT_BUFFER_PADDING_SIZE
water	13:66	0:0	2	;
if	15:4	16:46	2	(pes -> sub_st && pes -> stream_type == 0 x83 && pes -> extended_stream_id == 0 x76)
cond	15:8	15:79	3	pes -> sub_st && pes -> stream_type == 0 x83 && pes -> extended_stream_id == 0 x76
water	15:8	0:0	4	pes
op	15:11	0:0	4	->
water	15:13	0:0	4	sub_st
op	15:20	0:0	4	&&
water	15:23	0:0	4	pes
op	15:26	0:0	4	->
water	15:28	0:0	4	stream_type
op	15:40	0:0	4	==
water	15:43	0:0	4	0
water	15:44	0:0	4	x83
op	15:48	0:0	4	&&
water	15:51	0:0	4	pes
op	15:54	0:0	4	->
water	15:56	0:0	4	extended_stream_id
op	15:75	0:0	4	==
water	15:78	0:0	4	0
water	15:79	0:0	4	x76
stmts	16:8	16:46	3	
water	16:8	0:0	4	pkt
op	16:11	0:0	4	->
water	16:13	0:0	4	stream_index
op	16:26	0:0	4	=
water	16:28	0:0	4	pes
op	16:31	0:0	4	->
water	16:33	0:0	4	sub_st
op	16:39	0:0	4	->
water	16:41	0:0	4	index
water	16:46	0:0	4	;
else	17:4	18:42	2
stmts	18:8	18:42	3	
water	18:8	0:0	4	pkt
op	18:11	0:0	4	->
water	18:13	0:0	4	stream_index
op	18:26	0:0	4	=
water	18:28	0:0	4	pes
op	18:31	0:0	4	->
water	18:33	0:0	4	st
op	18:35	0:0	4	->
water	18:37	0:0	4	index
water	18:42	0:0	4	;
water	19:4	0:0	2	pkt
op	19:7	0:0	2	->
water	19:9	0:0	2	pts
op	19:13	0:0	2	=
water	19:15	0:0	2	pes
op	19:18	0:0	2	->
water	19:20	0:0	2	pts
water	19:23	0:0	2	;
water	20:4	0:0	2	pkt
op	20:7	0:0	2	->
water	20:9	0:0	2	dts
op	20:13	0:0	2	=
water	20:15	0:0	2	pes
op	20:18	0:0	2	->
water	20:20	0:0	2	dts
water	20:23	0:0	2	;
water	22:4	0:0	2	pkt
op	22:7	0:0	2	->
water	22:9	0:0	2	pos
op	22:15	0:0	2	=
water	22:17	0:0	2	pes
op	22:20	0:0	2	->
water	22:22	0:0	2	ts_packet_pos
water	22:35	0:0	2	;
water	23:4	0:0	2	pkt
op	23:7	0:0	2	->
water	23:9	0:0	2	flags
op	23:15	0:0	2	=
water	23:17	0:0	2	pes
op	23:20	0:0	2	->
water	23:22	0:0	2	flags
water	23:27	0:0	2	;
water	24:4	0:0	2	pes
op	24:7	0:0	2	->
water	24:9	0:0	2	buffer
op	24:16	0:0	2	=
water	24:18	0:0	2	NULL
water	24:22	0:0	2	;
call	25:4	25:30	2	reset_pes_packet_state
arg	25:27	25:30	3	pes
water	25:27	0:0	4	pes
water	25:31	0:0	2	;
