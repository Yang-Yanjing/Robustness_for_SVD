D:\postGraduate\code\function_representation_learning\Data\LibPNG\vulnerable_Files\vulnerable_functions\cve-2004-0597-3.c line 54:6 mismatched character '<EOF>' expecting '\n'
func	2:0	53:0	0	void	png_handle_hIST
params	3:15	0:0	1	
param	3:16	3:35	2	png_structp	png_ptr
param	3:37	3:55	2	png_infop	info_ptr
param	3:57	3:75	2	png_uint_32	length
stmnts	0:0	52:49	1	
decl	5:3	5:13	2	int	num
water	5:10	0:0	2	,
decl	5:3	5:13	2	int	i
call	7:3	7:38	2	png_debug
arg	7:13	7:14	3	1
water	7:13	0:0	4	1
arg	7:16	7:38	3	"in png_handle_hIST\n"
water	7:16	0:0	4	"in png_handle_hIST\n"
water	7:39	0:0	2	;
if	9:3	10:52	2	(! ( png_ptr -> mode & PNG_HAVE_IHDR ))
cond	9:7	9:38	3	! ( png_ptr -> mode & PNG_HAVE_IHDR )
op	9:7	0:0	4	!
water	9:8	0:0	4	(
water	9:9	0:0	4	png_ptr
op	9:16	0:0	4	->
water	9:18	0:0	4	mode
op	9:23	0:0	4	&
water	9:25	0:0	4	PNG_HAVE_IHDR
water	9:38	0:0	4	)
stmts	10:6	10:52	3	
call	10:6	10:51	4	png_error
arg	10:16	10:23	5	png_ptr
water	10:16	0:0	6	png_ptr
arg	10:25	10:51	5	"Missing IHDR before hIST"
water	10:25	0:0	6	"Missing IHDR before hIST"
water	10:52	0:0	4	;
else	11:3	16:3	2
stmts	11:8	16:3	3	
if	11:8	16:3	4	(png_ptr -> mode & PNG_HAVE_IDAT)
cond	11:12	11:28	5	png_ptr -> mode & PNG_HAVE_IDAT
water	11:12	0:0	6	png_ptr
op	11:19	0:0	6	->
water	11:21	0:0	6	mode
op	11:26	0:0	6	&
water	11:28	0:0	6	PNG_HAVE_IDAT
stmts	12:3	16:3	5	
water	12:3	0:0	6	{
call	13:6	13:52	6	png_warning
arg	13:18	13:25	7	png_ptr
water	13:18	0:0	8	png_ptr
arg	13:27	13:52	7	"Invalid hIST after IDAT"
water	13:27	0:0	8	"Invalid hIST after IDAT"
water	13:53	0:0	6	;
call	14:6	14:36	6	png_crc_finish
arg	14:21	14:28	7	png_ptr
water	14:21	0:0	8	png_ptr
arg	14:30	14:36	7	length
water	14:30	0:0	8	length
water	14:37	0:0	6	;
return	15:6	15:12	6	
water	16:3	0:0	6	}
else	17:3	22:3	2
stmts	17:8	22:3	3	
if	17:8	22:3	4	(! ( png_ptr -> mode & PNG_HAVE_PLTE ))
cond	17:12	17:43	5	! ( png_ptr -> mode & PNG_HAVE_PLTE )
op	17:12	0:0	6	!
water	17:13	0:0	6	(
water	17:14	0:0	6	png_ptr
op	17:21	0:0	6	->
water	17:23	0:0	6	mode
op	17:28	0:0	6	&
water	17:30	0:0	6	PNG_HAVE_PLTE
water	17:43	0:0	6	)
stmts	18:3	22:3	5	
water	18:3	0:0	6	{
call	19:6	19:53	6	png_warning
arg	19:18	19:25	7	png_ptr
water	19:18	0:0	8	png_ptr
arg	19:27	19:53	7	"Missing PLTE before hIST"
water	19:27	0:0	8	"Missing PLTE before hIST"
water	19:54	0:0	6	;
call	20:6	20:36	6	png_crc_finish
arg	20:21	20:28	7	png_ptr
water	20:21	0:0	8	png_ptr
arg	20:30	20:36	7	length
water	20:30	0:0	8	length
water	20:37	0:0	6	;
return	21:6	21:12	6	
water	22:3	0:0	6	}
else	23:3	28:3	2
stmts	23:8	28:3	3	
if	23:8	28:3	4	(info_ptr != NULL && info_ptr -> valid & PNG_INFO_hIST)
cond	23:12	23:50	5	info_ptr != NULL && info_ptr -> valid & PNG_INFO_hIST
water	23:12	0:0	6	info_ptr
op	23:21	0:0	6	!=
water	23:24	0:0	6	NULL
op	23:29	0:0	6	&&
water	23:32	0:0	6	info_ptr
op	23:40	0:0	6	->
water	23:42	0:0	6	valid
op	23:48	0:0	6	&
water	23:50	0:0	6	PNG_INFO_hIST
stmts	24:3	28:3	5	
water	24:3	0:0	6	{
call	25:6	25:49	6	png_warning
arg	25:18	25:25	7	png_ptr
water	25:18	0:0	8	png_ptr
arg	25:27	25:49	7	"Duplicate hIST chunk"
water	25:27	0:0	8	"Duplicate hIST chunk"
water	25:50	0:0	6	;
call	26:6	26:36	6	png_crc_finish
arg	26:21	26:28	7	png_ptr
water	26:21	0:0	8	png_ptr
arg	26:30	26:36	7	length
water	26:30	0:0	8	length
water	26:37	0:0	6	;
return	27:6	27:12	6	
water	28:3	0:0	6	}
if	30:3	35:3	2	(length !=( png_uint_32 ) (2 * png_ptr -> num_palette ))
cond	30:7	30:55	3	length !=( png_uint_32 ) (2 * png_ptr -> num_palette )
water	30:7	0:0	4	length
op	30:14	0:0	4	!=
call	30:17	30:55	4	(png_uint_32)
arg	30:31	30:55	5	2*png_ptr->num_palette
water	30:31	0:0	6	2
op	30:33	0:0	6	*
water	30:35	0:0	6	png_ptr
op	30:42	0:0	6	->
water	30:44	0:0	6	num_palette
stmts	31:3	35:3	3	
water	31:3	0:0	4	{
call	32:6	32:56	4	png_warning
arg	32:18	32:25	5	png_ptr
water	32:18	0:0	6	png_ptr
arg	32:27	32:56	5	"Incorrect hIST chunk length"
water	32:27	0:0	6	"Incorrect hIST chunk length"
water	32:57	0:0	4	;
call	33:6	33:36	4	png_crc_finish
arg	33:21	33:28	5	png_ptr
water	33:21	0:0	6	png_ptr
arg	33:30	33:36	5	length
water	33:30	0:0	6	length
water	33:37	0:0	4	;
return	34:6	34:12	4	
water	35:3	0:0	4	}
water	37:3	0:0	2	num
op	37:7	0:0	2	=
water	37:9	0:0	2	(
water	37:10	0:0	2	int
water	37:13	0:0	2	)
water	37:14	0:0	2	length
op	37:21	0:0	2	/
water	37:23	0:0	2	2
water	37:24	0:0	2	;
water	38:3	0:0	2	png_ptr
op	38:10	0:0	2	->
water	38:12	0:0	2	hist
op	38:17	0:0	2	=
water	38:19	0:0	2	(
water	38:20	0:0	2	png_uint_16p
water	38:32	0:0	2	)
call	38:33	39:47	2	png_malloc
arg	38:44	38:51	3	png_ptr
water	38:44	0:0	4	png_ptr
arg	39:6	39:47	3	(png_uint_32)(num*sizeof(png_uint_16))
call	39:6	39:46	4	(png_uint_32)
arg	39:20	39:46	5	num*sizeof(png_uint_16)
water	39:20	0:0	6	num
op	39:24	0:0	6	*
op	39:26	0:0	6	sizeof
water	39:33	0:0	6	(
water	39:34	0:0	6	png_uint_16
water	39:45	0:0	6	)
water	39:48	0:0	2	;
water	40:3	0:0	2	png_ptr
op	40:10	0:0	2	->
water	40:12	0:0	2	flags
op	40:18	0:0	2	|=
water	40:21	0:0	2	PNG_FLAG_FREE_HIST
water	40:39	0:0	2	;
for	41:3	47:3	2	(i = 0 ;i < num;i ++)
forinit	41:8	41:13	3	i = 0 ;
water	41:8	0:0	4	i
op	41:10	0:0	4	=
water	41:12	0:0	4	0
water	41:13	0:0	4	;
cond	41:15	41:19	3	i < num
water	41:15	0:0	4	i
op	41:17	0:0	4	<
water	41:19	0:0	4	num
forexpr	41:24	41:25	3	i ++
water	41:24	0:0	4	i
op	41:25	0:0	4	++
stmts	42:3	47:3	3	
water	42:3	0:0	4	{
decl	43:6	43:21	4	png_byte	buf[2]
call	45:6	45:34	4	png_crc_read
arg	45:19	45:26	5	png_ptr
water	45:19	0:0	6	png_ptr
arg	45:28	45:31	5	buf
water	45:28	0:0	6	buf
arg	45:33	45:34	5	2
water	45:33	0:0	6	2
water	45:35	0:0	4	;
water	46:6	0:0	4	png_ptr
op	46:13	0:0	4	->
water	46:15	0:0	4	hist
op	46:19	0:0	4	[
water	46:20	0:0	4	i
op	46:21	0:0	4	]
op	46:23	0:0	4	=
call	46:25	46:44	4	png_get_uint_16
arg	46:41	46:44	5	buf
water	46:41	0:0	6	buf
water	46:45	0:0	4	;
water	47:3	0:0	4	}
if	49:3	50:12	2	(png_crc_finish (png_ptr ,0 ))
cond	49:7	49:32	3	png_crc_finish (png_ptr ,0 )
call	49:7	49:32	4	png_crc_finish
arg	49:22	49:29	5	png_ptr
water	49:22	0:0	6	png_ptr
arg	49:31	49:32	5	0
water	49:31	0:0	6	0
stmts	50:6	50:12	3	
return	50:6	50:12	4	
call	52:3	52:48	2	png_set_hIST
arg	52:16	52:23	3	png_ptr
water	52:16	0:0	4	png_ptr
arg	52:25	52:33	3	info_ptr
water	52:25	0:0	4	info_ptr
arg	52:35	52:48	3	png_ptr->hist
water	52:35	0:0	4	png_ptr
op	52:42	0:0	4	->
water	52:44	0:0	4	hist
water	52:49	0:0	2	;
