func	1:0	60:0	0	static int	extract_one_file
params	2:16	0:0	1	
param	2:17	2:37	2	const char *	filename
stmnts	0:0	59:16	1	
decl	4:3	4:17	2	int	result
op	4:14	0:0	2	=
water	4:16	0:0	2	0
decl	5:3	5:35	2	FILE	*fp
op	5:12	0:0	2	=
call	5:14	5:34	3	fopen
arg	5:20	5:28	4	filename
water	5:20	0:0	5	filename
arg	5:30	5:34	4	"rb"
water	5:30	0:0	5	"rb"
if	6:3	56:3	2	(fp != NULL)
cond	6:7	6:13	3	fp != NULL
water	6:7	0:0	4	fp
op	6:10	0:0	4	!=
water	6:13	0:0	4	NULL
stmts	7:3	56:3	3	
water	7:3	0:0	4	{
decl	8:6	8:29	4	png_uint_32	proflen
op	8:26	0:0	4	=
water	8:28	0:0	4	0
decl	9:6	9:47	4	png_bytep	profile
op	9:24	0:0	4	=
call	9:26	9:46	5	extract
arg	9:34	9:36	6	fp
water	9:34	0:0	7	fp
arg	9:38	9:46	6	&proflen
op	9:38	0:0	7	&
water	9:39	0:0	7	proflen
if	10:6	53:6	4	(profile != NULL && profile != no_profile)
cond	10:10	10:40	5	profile != NULL && profile != no_profile
water	10:10	0:0	6	profile
op	10:18	0:0	6	!=
water	10:21	0:0	6	NULL
op	10:26	0:0	6	&&
water	10:29	0:0	6	profile
op	10:37	0:0	6	!=
water	10:40	0:0	6	no_profile
stmts	11:6	53:6	5	
water	11:6	0:0	6	{
decl	12:9	12:19	6	size_t	len
decl	13:9	13:21	6	char	*output
water	14:9	0:0	6	{
decl	15:12	15:51	6	const char	*ep
op	15:27	0:0	6	=
call	15:29	15:50	7	strrchr
arg	15:37	15:45	8	filename
water	15:37	0:0	9	filename
arg	15:47	15:50	8	'.'
water	15:47	0:0	9	'.'
if	16:12	17:32	6	(ep != NULL)
cond	16:16	16:22	7	ep != NULL
water	16:16	0:0	8	ep
op	16:19	0:0	8	!=
water	16:22	0:0	8	NULL
stmts	17:15	17:32	7	
water	17:15	0:0	8	len
op	17:19	0:0	8	=
water	17:21	0:0	8	ep
op	17:23	0:0	8	-
water	17:24	0:0	8	filename
water	17:32	0:0	8	;
else	18:12	19:37	6
stmts	19:15	19:37	7	
water	19:15	0:0	8	len
op	19:19	0:0	8	=
call	19:21	19:36	8	strlen
arg	19:28	19:36	9	filename
water	19:28	0:0	10	filename
water	19:37	0:0	8	;
water	20:9	0:0	6	}
water	21:9	0:0	6	output
op	21:16	0:0	6	=
call	21:18	21:32	6	malloc
arg	21:25	21:32	7	len+5
water	21:25	0:0	8	len
op	21:29	0:0	8	+
water	21:31	0:0	8	5
water	21:33	0:0	6	;
if	22:9	49:9	6	(output != NULL)
cond	22:13	22:23	7	output != NULL
water	22:13	0:0	8	output
op	22:20	0:0	8	!=
water	22:23	0:0	8	NULL
stmts	23:9	49:9	7	
water	23:9	0:0	8	{
decl	24:12	24:20	8	FILE	*of
call	25:12	25:40	8	memcpy
arg	25:19	25:25	9	output
water	25:19	0:0	10	output
arg	25:27	25:35	9	filename
water	25:27	0:0	10	filename
arg	25:37	25:40	9	len
water	25:37	0:0	10	len
water	25:41	0:0	8	;
call	26:12	26:37	8	strcpy
arg	26:19	26:29	9	output+len
water	26:19	0:0	10	output
op	26:25	0:0	10	+
water	26:26	0:0	10	len
arg	26:31	26:37	9	".icc"
water	26:31	0:0	10	".icc"
water	26:38	0:0	8	;
water	27:12	0:0	8	of
op	27:15	0:0	8	=
call	27:17	27:35	8	fopen
arg	27:23	27:29	9	output
water	27:23	0:0	10	output
arg	27:31	27:35	9	"wb"
water	27:31	0:0	10	"wb"
water	27:36	0:0	8	;
if	28:12	45:12	8	(of != NULL)
cond	28:16	28:22	9	of != NULL
water	28:16	0:0	10	of
op	28:19	0:0	10	!=
water	28:22	0:0	10	NULL
stmts	29:12	45:12	9	
water	29:12	0:0	10	{
if	30:15	38:15	10	(fwrite (profile ,proflen ,1 ,of ) == 1 &&fflush (of ) == 0 &&fclose (of ) == 0)
cond	30:19	32:32	11	fwrite (profile ,proflen ,1 ,of ) == 1 &&fflush (of ) == 0 &&fclose (of ) == 0
call	30:19	30:49	12	fwrite
arg	30:26	30:33	13	profile
water	30:26	0:0	14	profile
arg	30:35	30:42	13	proflen
water	30:35	0:0	14	proflen
arg	30:44	30:45	13	1
water	30:44	0:0	14	1
arg	30:47	30:49	13	of
water	30:47	0:0	14	of
op	30:51	0:0	12	==
water	30:54	0:0	12	1
op	30:56	0:0	12	&&
call	31:18	31:27	12	fflush
arg	31:25	31:27	13	of
water	31:25	0:0	14	of
op	31:29	0:0	12	==
water	31:32	0:0	12	0
op	31:34	0:0	12	&&
call	32:18	32:27	12	fclose
arg	32:25	32:27	13	of
water	32:25	0:0	14	of
op	32:29	0:0	12	==
water	32:32	0:0	12	0
stmts	33:15	38:15	11	
water	33:15	0:0	12	{
if	34:18	35:59	12	(verbose)
cond	34:22	34:22	13	verbose
water	34:22	0:0	14	verbose
stmts	35:21	35:59	13	
call	35:21	35:58	14	printf
arg	35:28	35:40	15	"%s -> %s\n"
water	35:28	0:0	16	"%s -> %s\n"
arg	35:42	35:50	15	filename
water	35:42	0:0	16	filename
arg	35:52	35:58	15	output
water	35:52	0:0	16	output
water	35:59	0:0	14	;
water	37:18	0:0	12	result
op	37:25	0:0	12	=
water	37:27	0:0	12	1
water	37:28	0:0	12	;
water	38:15	0:0	12	}
else	39:15	44:15	10
stmts	40:15	44:15	11	
water	40:15	0:0	12	{
call	41:18	41:71	12	fprintf
arg	41:26	41:32	13	stderr
water	41:26	0:0	14	stderr
arg	41:34	41:63	13	"%s: error writing profile\n"
water	41:34	0:0	14	"%s: error writing profile\n"
arg	41:65	41:71	13	output
water	41:65	0:0	14	output
water	41:72	0:0	12	;
if	42:18	43:75	12	(remove (output ))
cond	42:22	42:35	13	remove (output )
call	42:22	42:35	14	remove
arg	42:29	42:35	15	output
water	42:29	0:0	16	output
stmts	43:21	43:75	13	
call	43:21	43:74	14	fprintf
arg	43:29	43:35	15	stderr
water	43:29	0:0	16	stderr
arg	43:37	43:66	15	"%s: could not remove file\n"
water	43:37	0:0	16	"%s: could not remove file\n"
arg	43:68	43:74	15	output
water	43:68	0:0	16	output
water	43:75	0:0	14	;
water	44:15	0:0	12	}
water	45:12	0:0	10	}
else	46:12	47:74	8
stmts	47:15	47:74	9	
call	47:15	47:73	10	fprintf
arg	47:23	47:29	11	stderr
water	47:23	0:0	12	stderr
arg	47:31	47:65	11	"%s: failed to open output file\n"
water	47:31	0:0	12	"%s: failed to open output file\n"
arg	47:67	47:73	11	output
water	47:67	0:0	12	output
water	47:74	0:0	10	;
call	48:12	48:23	8	free
arg	48:17	48:23	9	output
water	48:17	0:0	10	output
water	48:24	0:0	8	;
water	49:9	0:0	8	}
else	50:9	51:69	6
stmts	51:12	51:69	7	
call	51:12	51:68	8	fprintf
arg	51:20	51:26	9	stderr
water	51:20	0:0	10	stderr
arg	51:28	51:58	9	"%s: OOM allocating string!\n"
water	51:28	0:0	10	"%s: OOM allocating string!\n"
arg	51:60	51:68	9	filename
water	51:60	0:0	10	filename
water	51:69	0:0	8	;
call	52:9	52:21	6	free
arg	52:14	52:21	7	profile
water	52:14	0:0	8	profile
water	52:22	0:0	6	;
water	53:6	0:0	6	}
else	54:6	55:40	4
stmts	54:11	55:40	5	
if	54:11	55:40	6	(verbose && profile == no_profile)
cond	54:15	54:37	7	verbose && profile == no_profile
water	54:15	0:0	8	verbose
op	54:23	0:0	8	&&
water	54:26	0:0	8	profile
op	54:34	0:0	8	==
water	54:37	0:0	8	no_profile
stmts	55:1	55:40	7	
call	55:1	55:39	8	printf
arg	55:8	55:29	9	"%s has no profile\n"
water	55:8	0:0	10	"%s has no profile\n"
arg	55:31	55:39	9	filename
water	55:31	0:0	10	filename
water	55:40	0:0	8	;
water	56:3	0:0	4	}
else	57:3	58:60	2
stmts	58:6	58:60	3	
call	58:6	58:59	4	fprintf
arg	58:14	58:20	5	stderr
water	58:14	0:0	6	stderr
arg	58:22	58:49	5	"%s: could not open file\n"
water	58:22	0:0	6	"%s: could not open file\n"
arg	58:51	58:59	5	filename
water	58:51	0:0	6	filename
water	58:60	0:0	4	;
return	59:3	59:16	2	result
water	59:10	0:0	3	result
